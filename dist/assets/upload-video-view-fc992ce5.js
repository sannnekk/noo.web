import{a3 as sr,a4 as We,d as be,a5 as fr,r as M,w as xe,q as Rt,s as jt,a as k,i as B,t as cr,a6 as we,g as j,v as Te,u as ke,f as V,j as z,b as ee,e as X,y as J,a7 as pr,E as je,D as dr,p as $t,l as Tt,_ as At,C as ae,a2 as Lt,a8 as hr,c as It,a9 as vr,aa as yr,ab as mr,ac as _r,ad as gr,ae as br,af as wr}from"./index-aecf8712.js";function ue(e){"@babel/helpers - typeof";return ue=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ue(e)}function Je(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Sr(n.key),n)}}function Ur(e,t,r){return t&&Je(e.prototype,t),r&&Je(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Sr(e){var t=xr(e,"string");return ue(t)=="symbol"?t:t+""}function xr(e,t){if(ue(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ue(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Pr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Er(e,t,r){return t=he(t),kr(e,Ve()?Reflect.construct(t,r||[],he(e).constructor):t.apply(e,r))}function kr(e,t){if(t&&(ue(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Or(e)}function Or(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Rr(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&de(e,t)}function Le(e){var t=typeof Map=="function"?new Map:void 0;return Le=function(n){if(n===null||!$r(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t<"u"){if(t.has(n))return t.get(n);t.set(n,o)}function o(){return jr(n,arguments,he(this).constructor)}return o.prototype=Object.create(n.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),de(o,n)},Le(e)}function jr(e,t,r){if(Ve())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,t);var o=new(e.bind.apply(e,n));return r&&de(o,r.prototype),o}function Ve(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ve=function(){return!!e})()}function $r(e){try{return Function.toString.call(e).indexOf("[native code]")!==-1}catch{return typeof e=="function"}}function de(e,t){return de=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},de(e,t)}function he(e){return he=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},he(e)}var Ue=function(e){function t(r){var n,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(Pr(this,t),n=Er(this,t,[r]),n.originalRequest=i,n.originalResponse=s,n.causingError=o,o!=null&&(r+=", caused by ".concat(o.toString())),i!=null){var f=i.getHeader("X-Request-ID")||"n/a",c=i.getMethod(),y=i.getURL(),m=s?s.getStatus():"n/a",d=s?s.getBody()||"":"n/a";r+=", originated from request (method: ".concat(c,", url: ").concat(y,", response code: ").concat(m,", response text: ").concat(d,", request id: ").concat(f,")")}return n.message=r,n}return Rr(t,e),Ur(t)}(Le(Error));function ve(e){"@babel/helpers - typeof";return ve=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ve(e)}function Tr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Qe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Lr(n.key),n)}}function Ar(e,t,r){return t&&Qe(e.prototype,t),r&&Qe(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Lr(e){var t=Ir(e,"string");return ve(t)=="symbol"?t:t+""}function Ir(e,t){if(ve(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ve(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Cr=function(){function e(){Tr(this,e)}return Ar(e,[{key:"listAllUploads",value:function(){return Promise.resolve([])}},{key:"findUploadsByFingerprint",value:function(r){return Promise.resolve([])}},{key:"removeUpload",value:function(r){return Promise.resolve()}},{key:"addUpload",value:function(r,n){return Promise.resolve(null)}}])}();const Ct="3.7.7",Dr=Ct,fe=typeof Buffer=="function",et=typeof TextDecoder=="function"?new TextDecoder:void 0,tt=typeof TextEncoder=="function"?new TextEncoder:void 0,Fr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",pe=Array.prototype.slice.call(Fr),Se=(e=>{let t={};return e.forEach((r,n)=>t[r]=n),t})(pe),Nr=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,I=String.fromCharCode.bind(String),rt=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):e=>new Uint8Array(Array.prototype.slice.call(e,0)),Dt=e=>e.replace(/=/g,"").replace(/[+\/]/g,t=>t=="+"?"-":"_"),Ft=e=>e.replace(/[^A-Za-z0-9\+\/]/g,""),Nt=e=>{let t,r,n,o,i="";const s=e.length%3;for(let f=0;f<e.length;){if((r=e.charCodeAt(f++))>255||(n=e.charCodeAt(f++))>255||(o=e.charCodeAt(f++))>255)throw new TypeError("invalid character found");t=r<<16|n<<8|o,i+=pe[t>>18&63]+pe[t>>12&63]+pe[t>>6&63]+pe[t&63]}return s?i.slice(0,s-3)+"===".substring(s):i},Me=typeof btoa=="function"?e=>btoa(e):fe?e=>Buffer.from(e,"binary").toString("base64"):Nt,Ie=fe?e=>Buffer.from(e).toString("base64"):e=>{let r=[];for(let n=0,o=e.length;n<o;n+=4096)r.push(I.apply(null,e.subarray(n,n+4096)));return Me(r.join(""))},Pe=(e,t=!1)=>t?Dt(Ie(e)):Ie(e),Br=e=>{if(e.length<2){var t=e.charCodeAt(0);return t<128?e:t<2048?I(192|t>>>6)+I(128|t&63):I(224|t>>>12&15)+I(128|t>>>6&63)+I(128|t&63)}else{var t=65536+(e.charCodeAt(0)-55296)*1024+(e.charCodeAt(1)-56320);return I(240|t>>>18&7)+I(128|t>>>12&63)+I(128|t>>>6&63)+I(128|t&63)}},zr=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,Bt=e=>e.replace(zr,Br),nt=fe?e=>Buffer.from(e,"utf8").toString("base64"):tt?e=>Ie(tt.encode(e)):e=>Me(Bt(e)),le=(e,t=!1)=>t?Dt(nt(e)):nt(e),ot=e=>le(e,!0),qr=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,Hr=e=>{switch(e.length){case 4:var t=(7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3),r=t-65536;return I((r>>>10)+55296)+I((r&1023)+56320);case 3:return I((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return I((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},zt=e=>e.replace(qr,Hr),qt=e=>{if(e=e.replace(/\s+/g,""),!Nr.test(e))throw new TypeError("malformed base64.");e+="==".slice(2-(e.length&3));let t,r="",n,o;for(let i=0;i<e.length;)t=Se[e.charAt(i++)]<<18|Se[e.charAt(i++)]<<12|(n=Se[e.charAt(i++)])<<6|(o=Se[e.charAt(i++)]),r+=n===64?I(t>>16&255):o===64?I(t>>16&255,t>>8&255):I(t>>16&255,t>>8&255,t&255);return r},Ge=typeof atob=="function"?e=>atob(Ft(e)):fe?e=>Buffer.from(e,"base64").toString("binary"):qt,Ht=fe?e=>rt(Buffer.from(e,"base64")):e=>rt(Ge(e).split("").map(t=>t.charCodeAt(0))),Vt=e=>Ht(Mt(e)),Vr=fe?e=>Buffer.from(e,"base64").toString("utf8"):et?e=>et.decode(Ht(e)):e=>zt(Ge(e)),Mt=e=>Ft(e.replace(/[-_]/g,t=>t=="-"?"+":"/")),Ce=e=>Vr(Mt(e)),Mr=e=>{if(typeof e!="string")return!1;const t=e.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(t)||!/[^\s0-9a-zA-Z\-_]/.test(t)},Gt=e=>({value:e,enumerable:!1,writable:!0,configurable:!0}),Kt=function(){const e=(t,r)=>Object.defineProperty(String.prototype,t,Gt(r));e("fromBase64",function(){return Ce(this)}),e("toBase64",function(t){return le(this,t)}),e("toBase64URI",function(){return le(this,!0)}),e("toBase64URL",function(){return le(this,!0)}),e("toUint8Array",function(){return Vt(this)})},Xt=function(){const e=(t,r)=>Object.defineProperty(Uint8Array.prototype,t,Gt(r));e("toBase64",function(t){return Pe(this,t)}),e("toBase64URI",function(){return Pe(this,!0)}),e("toBase64URL",function(){return Pe(this,!0)})},Gr=()=>{Kt(),Xt()},Kr={version:Ct,VERSION:Dr,atob:Ge,atobPolyfill:qt,btoa:Me,btoaPolyfill:Nt,fromBase64:Ce,toBase64:le,encode:le,encodeURI:ot,encodeURL:ot,utob:Bt,btou:zt,decode:Ce,isValid:Mr,fromUint8Array:Pe,toUint8Array:Vt,extendString:Kt,extendUint8Array:Xt,extendBuiltins:Gr};var Xr=function(t,r){if(r=r.split(":")[0],t=+t,!t)return!1;switch(r){case"http":case"ws":return t!==80;case"https":case"wss":return t!==443;case"ftp":return t!==21;case"gopher":return t!==70;case"file":return!1}return t!==0},Ke={},Yr=Object.prototype.hasOwnProperty,Zr;function it(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch{return null}}function at(e){try{return encodeURIComponent(e)}catch{return null}}function Wr(e){for(var t=/([^=?#&]+)=?([^&]*)/g,r={},n;n=t.exec(e);){var o=it(n[1]),i=it(n[2]);o===null||i===null||o in r||(r[o]=i)}return r}function Jr(e,t){t=t||"";var r=[],n,o;typeof t!="string"&&(t="?");for(o in e)if(Yr.call(e,o)){if(n=e[o],!n&&(n===null||n===Zr||isNaN(n))&&(n=""),o=at(o),n=at(n),o===null||n===null)continue;r.push(o+"="+n)}return r.length?t+r.join("&"):""}Ke.stringify=Jr;Ke.parse=Wr;var Yt=Xr,$e=Ke,Qr=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,Zt=/[\n\r\t]/g,en=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,Wt=/:\d+$/,tn=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,rn=/^[a-zA-Z]:/;function Xe(e){return(e||"").toString().replace(Qr,"")}var De=[["#","hash"],["?","query"],function(t,r){return Y(r.protocol)?t.replace(/\\/g,"/"):t},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],lt={hash:1,query:1};function Jt(e){var t;typeof window<"u"?t=window:typeof We<"u"?t=We:typeof self<"u"?t=self:t={};var r=t.location||{};e=e||r;var n={},o=typeof e,i;if(e.protocol==="blob:")n=new Z(unescape(e.pathname),{});else if(o==="string"){n=new Z(e,{});for(i in lt)delete n[i]}else if(o==="object"){for(i in e)i in lt||(n[i]=e[i]);n.slashes===void 0&&(n.slashes=en.test(e.href))}return n}function Y(e){return e==="file:"||e==="ftp:"||e==="http:"||e==="https:"||e==="ws:"||e==="wss:"}function Qt(e,t){e=Xe(e),e=e.replace(Zt,""),t=t||{};var r=tn.exec(e),n=r[1]?r[1].toLowerCase():"",o=!!r[2],i=!!r[3],s=0,f;return o?i?(f=r[2]+r[3]+r[4],s=r[2].length+r[3].length):(f=r[2]+r[4],s=r[2].length):i?(f=r[3]+r[4],s=r[3].length):f=r[4],n==="file:"?s>=2&&(f=f.slice(2)):Y(n)?f=r[4]:n?o&&(f=f.slice(2)):s>=2&&Y(t.protocol)&&(f=r[4]),{protocol:n,slashes:o||Y(n),slashesCount:s,rest:f}}function nn(e,t){if(e==="")return t;for(var r=(t||"/").split("/").slice(0,-1).concat(e.split("/")),n=r.length,o=r[n-1],i=!1,s=0;n--;)r[n]==="."?r.splice(n,1):r[n]===".."?(r.splice(n,1),s++):s&&(n===0&&(i=!0),r.splice(n,1),s--);return i&&r.unshift(""),(o==="."||o==="..")&&r.push(""),r.join("/")}function Z(e,t,r){if(e=Xe(e),e=e.replace(Zt,""),!(this instanceof Z))return new Z(e,t,r);var n,o,i,s,f,c,y=De.slice(),m=typeof t,d=this,g=0;for(m!=="object"&&m!=="string"&&(r=t,t=null),r&&typeof r!="function"&&(r=$e.parse),t=Jt(t),o=Qt(e||"",t),n=!o.protocol&&!o.slashes,d.slashes=o.slashes||n&&t.slashes,d.protocol=o.protocol||t.protocol||"",e=o.rest,(o.protocol==="file:"&&(o.slashesCount!==2||rn.test(e))||!o.slashes&&(o.protocol||o.slashesCount<2||!Y(d.protocol)))&&(y[3]=[/(.*)/,"pathname"]);g<y.length;g++){if(s=y[g],typeof s=="function"){e=s(e,d);continue}i=s[0],c=s[1],i!==i?d[c]=e:typeof i=="string"?(f=i==="@"?e.lastIndexOf(i):e.indexOf(i),~f&&(typeof s[2]=="number"?(d[c]=e.slice(0,f),e=e.slice(f+s[2])):(d[c]=e.slice(f),e=e.slice(0,f)))):(f=i.exec(e))&&(d[c]=f[1],e=e.slice(0,f.index)),d[c]=d[c]||n&&s[3]&&t[c]||"",s[4]&&(d[c]=d[c].toLowerCase())}r&&(d.query=r(d.query)),n&&t.slashes&&d.pathname.charAt(0)!=="/"&&(d.pathname!==""||t.pathname!=="")&&(d.pathname=nn(d.pathname,t.pathname)),d.pathname.charAt(0)!=="/"&&Y(d.protocol)&&(d.pathname="/"+d.pathname),Yt(d.port,d.protocol)||(d.host=d.hostname,d.port=""),d.username=d.password="",d.auth&&(f=d.auth.indexOf(":"),~f?(d.username=d.auth.slice(0,f),d.username=encodeURIComponent(decodeURIComponent(d.username)),d.password=d.auth.slice(f+1),d.password=encodeURIComponent(decodeURIComponent(d.password))):d.username=encodeURIComponent(decodeURIComponent(d.auth)),d.auth=d.password?d.username+":"+d.password:d.username),d.origin=d.protocol!=="file:"&&Y(d.protocol)&&d.host?d.protocol+"//"+d.host:"null",d.href=d.toString()}function on(e,t,r){var n=this;switch(e){case"query":typeof t=="string"&&t.length&&(t=(r||$e.parse)(t)),n[e]=t;break;case"port":n[e]=t,Yt(t,n.protocol)?t&&(n.host=n.hostname+":"+t):(n.host=n.hostname,n[e]="");break;case"hostname":n[e]=t,n.port&&(t+=":"+n.port),n.host=t;break;case"host":n[e]=t,Wt.test(t)?(t=t.split(":"),n.port=t.pop(),n.hostname=t.join(":")):(n.hostname=t,n.port="");break;case"protocol":n.protocol=t.toLowerCase(),n.slashes=!r;break;case"pathname":case"hash":if(t){var o=e==="pathname"?"/":"#";n[e]=t.charAt(0)!==o?o+t:t}else n[e]=t;break;case"username":case"password":n[e]=encodeURIComponent(t);break;case"auth":var i=t.indexOf(":");~i?(n.username=t.slice(0,i),n.username=encodeURIComponent(decodeURIComponent(n.username)),n.password=t.slice(i+1),n.password=encodeURIComponent(decodeURIComponent(n.password))):n.username=encodeURIComponent(decodeURIComponent(t))}for(var s=0;s<De.length;s++){var f=De[s];f[4]&&(n[f[1]]=n[f[1]].toLowerCase())}return n.auth=n.password?n.username+":"+n.password:n.username,n.origin=n.protocol!=="file:"&&Y(n.protocol)&&n.host?n.protocol+"//"+n.host:"null",n.href=n.toString(),n}function an(e){(!e||typeof e!="function")&&(e=$e.stringify);var t,r=this,n=r.host,o=r.protocol;o&&o.charAt(o.length-1)!==":"&&(o+=":");var i=o+(r.protocol&&r.slashes||Y(r.protocol)?"//":"");return r.username?(i+=r.username,r.password&&(i+=":"+r.password),i+="@"):r.password?(i+=":"+r.password,i+="@"):r.protocol!=="file:"&&Y(r.protocol)&&!n&&r.pathname!=="/"&&(i+="@"),(n[n.length-1]===":"||Wt.test(r.hostname)&&!r.port)&&(n+=":"),i+=n+r.pathname,t=typeof r.query=="object"?e(r.query):r.query,t&&(i+=t.charAt(0)!=="?"?"?"+t:t),r.hash&&(i+=r.hash),i}Z.prototype={set:on,toString:an};Z.extractProtocol=Qt;Z.location=Jt;Z.trimLeft=Xe;Z.qs=$e;var ln=Z;const un=sr(ln);function sn(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=Math.random()*16|0,r=e==="x"?t:t&3|8;return r.toString(16)})}function Fe(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Fe=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(u,a,l){u[a]=l.value},i=typeof Symbol=="function"?Symbol:{},s=i.iterator||"@@iterator",f=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function y(u,a,l){return Object.defineProperty(u,a,{value:l,enumerable:!0,configurable:!0,writable:!0}),u[a]}try{y({},"")}catch{y=function(l,p,v){return l[p]=v}}function m(u,a,l,p){var v=a&&a.prototype instanceof C?a:C,h=Object.create(v.prototype),_=new A(p||[]);return o(h,"_invoke",{value:T(u,l,_)}),h}function d(u,a,l){try{return{type:"normal",arg:u.call(a,l)}}catch(p){return{type:"throw",arg:p}}}t.wrap=m;var g="suspendedStart",$="suspendedYield",x="executing",O="completed",b={};function C(){}function R(){}function S(){}var D={};y(D,s,function(){return this});var E=Object.getPrototypeOf,G=E&&E(E(Q([])));G&&G!==r&&n.call(G,s)&&(D=G);var F=S.prototype=C.prototype=Object.create(D);function N(u){["next","throw","return"].forEach(function(a){y(u,a,function(l){return this._invoke(a,l)})})}function w(u,a){function l(v,h,_,U){var P=d(u[v],u,h);if(P.type!=="throw"){var q=P.arg,L=q.value;return L&&te(L)=="object"&&n.call(L,"__await")?a.resolve(L.__await).then(function(H){l("next",H,_,U)},function(H){l("throw",H,_,U)}):a.resolve(L).then(function(H){q.value=H,_(q)},function(H){return l("throw",H,_,U)})}U(P.arg)}var p;o(this,"_invoke",{value:function(h,_){function U(){return new a(function(P,q){l(h,_,P,q)})}return p=p?p.then(U,U):U()}})}function T(u,a,l){var p=g;return function(v,h){if(p===x)throw Error("Generator is already running");if(p===O){if(v==="throw")throw h;return{value:e,done:!0}}for(l.method=v,l.arg=h;;){var _=l.delegate;if(_){var U=K(_,l);if(U){if(U===b)continue;return U}}if(l.method==="next")l.sent=l._sent=l.arg;else if(l.method==="throw"){if(p===g)throw p=O,l.arg;l.dispatchException(l.arg)}else l.method==="return"&&l.abrupt("return",l.arg);p=x;var P=d(u,a,l);if(P.type==="normal"){if(p=l.done?O:$,P.arg===b)continue;return{value:P.arg,done:l.done}}P.type==="throw"&&(p=O,l.method="throw",l.arg=P.arg)}}}function K(u,a){var l=a.method,p=u.iterator[l];if(p===e)return a.delegate=null,l==="throw"&&u.iterator.return&&(a.method="return",a.arg=e,K(u,a),a.method==="throw")||l!=="return"&&(a.method="throw",a.arg=new TypeError("The iterator does not provide a '"+l+"' method")),b;var v=d(p,u.iterator,a.arg);if(v.type==="throw")return a.method="throw",a.arg=v.arg,a.delegate=null,b;var h=v.arg;return h?h.done?(a[u.resultName]=h.value,a.next=u.nextLoc,a.method!=="return"&&(a.method="next",a.arg=e),a.delegate=null,b):h:(a.method="throw",a.arg=new TypeError("iterator result is not an object"),a.delegate=null,b)}function ce(u){var a={tryLoc:u[0]};1 in u&&(a.catchLoc=u[1]),2 in u&&(a.finallyLoc=u[2],a.afterLoc=u[3]),this.tryEntries.push(a)}function W(u){var a=u.completion||{};a.type="normal",delete a.arg,u.completion=a}function A(u){this.tryEntries=[{tryLoc:"root"}],u.forEach(ce,this),this.reset(!0)}function Q(u){if(u||u===""){var a=u[s];if(a)return a.call(u);if(typeof u.next=="function")return u;if(!isNaN(u.length)){var l=-1,p=function v(){for(;++l<u.length;)if(n.call(u,l))return v.value=u[l],v.done=!1,v;return v.value=e,v.done=!0,v};return p.next=p}}throw new TypeError(te(u)+" is not iterable")}return R.prototype=S,o(F,"constructor",{value:S,configurable:!0}),o(S,"constructor",{value:R,configurable:!0}),R.displayName=y(S,c,"GeneratorFunction"),t.isGeneratorFunction=function(u){var a=typeof u=="function"&&u.constructor;return!!a&&(a===R||(a.displayName||a.name)==="GeneratorFunction")},t.mark=function(u){return Object.setPrototypeOf?Object.setPrototypeOf(u,S):(u.__proto__=S,y(u,c,"GeneratorFunction")),u.prototype=Object.create(F),u},t.awrap=function(u){return{__await:u}},N(w.prototype),y(w.prototype,f,function(){return this}),t.AsyncIterator=w,t.async=function(u,a,l,p,v){v===void 0&&(v=Promise);var h=new w(m(u,a,l,p),v);return t.isGeneratorFunction(a)?h:h.next().then(function(_){return _.done?_.value:h.next()})},N(F),y(F,c,"Generator"),y(F,s,function(){return this}),y(F,"toString",function(){return"[object Generator]"}),t.keys=function(u){var a=Object(u),l=[];for(var p in a)l.push(p);return l.reverse(),function v(){for(;l.length;){var h=l.pop();if(h in a)return v.value=h,v.done=!1,v}return v.done=!0,v}},t.values=Q,A.prototype={constructor:A,reset:function(a){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(W),!a)for(var l in this)l.charAt(0)==="t"&&n.call(this,l)&&!isNaN(+l.slice(1))&&(this[l]=e)},stop:function(){this.done=!0;var a=this.tryEntries[0].completion;if(a.type==="throw")throw a.arg;return this.rval},dispatchException:function(a){if(this.done)throw a;var l=this;function p(q,L){return _.type="throw",_.arg=a,l.next=q,L&&(l.method="next",l.arg=e),!!L}for(var v=this.tryEntries.length-1;v>=0;--v){var h=this.tryEntries[v],_=h.completion;if(h.tryLoc==="root")return p("end");if(h.tryLoc<=this.prev){var U=n.call(h,"catchLoc"),P=n.call(h,"finallyLoc");if(U&&P){if(this.prev<h.catchLoc)return p(h.catchLoc,!0);if(this.prev<h.finallyLoc)return p(h.finallyLoc)}else if(U){if(this.prev<h.catchLoc)return p(h.catchLoc,!0)}else{if(!P)throw Error("try statement without catch or finally");if(this.prev<h.finallyLoc)return p(h.finallyLoc)}}}},abrupt:function(a,l){for(var p=this.tryEntries.length-1;p>=0;--p){var v=this.tryEntries[p];if(v.tryLoc<=this.prev&&n.call(v,"finallyLoc")&&this.prev<v.finallyLoc){var h=v;break}}h&&(a==="break"||a==="continue")&&h.tryLoc<=l&&l<=h.finallyLoc&&(h=null);var _=h?h.completion:{};return _.type=a,_.arg=l,h?(this.method="next",this.next=h.finallyLoc,b):this.complete(_)},complete:function(a,l){if(a.type==="throw")throw a.arg;return a.type==="break"||a.type==="continue"?this.next=a.arg:a.type==="return"?(this.rval=this.arg=a.arg,this.method="return",this.next="end"):a.type==="normal"&&l&&(this.next=l),b},finish:function(a){for(var l=this.tryEntries.length-1;l>=0;--l){var p=this.tryEntries[l];if(p.finallyLoc===a)return this.complete(p.completion,p.afterLoc),W(p),b}},catch:function(a){for(var l=this.tryEntries.length-1;l>=0;--l){var p=this.tryEntries[l];if(p.tryLoc===a){var v=p.completion;if(v.type==="throw"){var h=v.arg;W(p)}return h}}throw Error("illegal catch attempt")},delegateYield:function(a,l,p){return this.delegate={iterator:Q(a),resultName:l,nextLoc:p},this.method==="next"&&(this.arg=e),b}},t}function ut(e,t,r,n,o,i,s){try{var f=e[i](s),c=f.value}catch(y){r(y);return}f.done?t(c):Promise.resolve(c).then(n,o)}function fn(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function s(c){ut(i,n,o,s,f,"next",c)}function f(c){ut(i,n,o,s,f,"throw",c)}s(void 0)})}}function er(e,t){return dn(e)||pn(e,t)||tr(e,t)||cn()}function cn(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pn(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,s,f=[],c=!0,y=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(f.push(n.value),f.length!==t);c=!0);}catch(m){y=!0,o=m}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(y)throw o}}return f}}function dn(e){if(Array.isArray(e))return e}function te(e){"@babel/helpers - typeof";return te=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},te(e)}function hn(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=tr(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(y){throw y},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,f;return{s:function(){r=r.call(e)},n:function(){var y=r.next();return i=y.done,y},e:function(y){s=!0,f=y},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw f}}}}function tr(e,t){if(e){if(typeof e=="string")return st(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return st(e,t)}}function st(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ft(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function ne(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ft(Object(r),!0).forEach(function(n){vn(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ft(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function vn(e,t,r){return t=rr(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ct(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rr(n.key),n)}}function mn(e,t,r){return t&&ct(e.prototype,t),r&&ct(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rr(e){var t=_n(e,"string");return te(t)=="symbol"?t:t+""}function _n(e,t){if(te(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(te(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ne="tus-v1",Ee="ietf-draft-03",gn={endpoint:null,uploadUrl:null,metadata:{},metadataForPartialUploads:{},fingerprint:null,uploadSize:null,onProgress:null,onChunkComplete:null,onSuccess:null,onError:null,onUploadUrlAvailable:null,overridePatchMethod:!1,headers:{},addRequestId:!1,onBeforeRequest:null,onAfterResponse:null,onShouldRetry:nr,chunkSize:Number.POSITIVE_INFINITY,retryDelays:[0,1e3,3e3,5e3],parallelUploads:1,parallelUploadBoundaries:null,storeFingerprintForResuming:!0,removeFingerprintOnSuccess:!1,uploadLengthDeferred:!1,uploadDataDuringCreation:!1,urlStorage:null,fileReader:null,httpStack:null,protocol:Ne},Oe=function(){function e(t,r){yn(this,e),"resume"in r&&console.log("tus: The `resume` option has been removed in tus-js-client v2. Please use the URL storage API instead."),this.options=r,this.options.chunkSize=Number(this.options.chunkSize),this._urlStorage=this.options.urlStorage,this.file=t,this.url=null,this._req=null,this._fingerprint=null,this._urlStorageKey=null,this._offset=null,this._aborted=!1,this._size=null,this._source=null,this._retryAttempt=0,this._retryTimeout=null,this._offsetBeforeRetry=0,this._parallelUploads=null,this._parallelUploadUrls=null}return mn(e,[{key:"findPreviousUploads",value:function(){var r=this;return this.options.fingerprint(this.file,this.options).then(function(n){return r._urlStorage.findUploadsByFingerprint(n)})}},{key:"resumeFromPreviousUpload",value:function(r){this.url=r.uploadUrl||null,this._parallelUploadUrls=r.parallelUploadUrls||null,this._urlStorageKey=r.urlStorageKey}},{key:"start",value:function(){var r=this,n=this.file;if(!n){this._emitError(new Error("tus: no file or stream to upload provided"));return}if(![Ne,Ee].includes(this.options.protocol)){this._emitError(new Error("tus: unsupported protocol ".concat(this.options.protocol)));return}if(!this.options.endpoint&&!this.options.uploadUrl&&!this.url){this._emitError(new Error("tus: neither an endpoint or an upload URL is provided"));return}var o=this.options.retryDelays;if(o!=null&&Object.prototype.toString.call(o)!=="[object Array]"){this._emitError(new Error("tus: the `retryDelays` option must either be an array or null"));return}if(this.options.parallelUploads>1)for(var i=0,s=["uploadUrl","uploadSize","uploadLengthDeferred"];i<s.length;i++){var f=s[i];if(this.options[f]){this._emitError(new Error("tus: cannot use the ".concat(f," option when parallelUploads is enabled")));return}}if(this.options.parallelUploadBoundaries){if(this.options.parallelUploads<=1){this._emitError(new Error("tus: cannot use the `parallelUploadBoundaries` option when `parallelUploads` is disabled"));return}if(this.options.parallelUploads!==this.options.parallelUploadBoundaries.length){this._emitError(new Error("tus: the `parallelUploadBoundaries` must have the same length as the value of `parallelUploads`"));return}}this.options.fingerprint(n,this.options).then(function(c){return r._fingerprint=c,r._source?r._source:r.options.fileReader.openFile(n,r.options.chunkSize)}).then(function(c){if(r._source=c,r.options.uploadLengthDeferred)r._size=null;else if(r.options.uploadSize!=null){if(r._size=Number(r.options.uploadSize),Number.isNaN(r._size)){r._emitError(new Error("tus: cannot convert `uploadSize` option into a number"));return}}else if(r._size=r._source.size,r._size==null){r._emitError(new Error("tus: cannot automatically derive upload's size from input. Specify it manually using the `uploadSize` option or use the `uploadLengthDeferred` option"));return}r.options.parallelUploads>1||r._parallelUploadUrls!=null?r._startParallelUpload():r._startSingleUpload()}).catch(function(c){r._emitError(c)})}},{key:"_startParallelUpload",value:function(){var r,n=this,o=this._size,i=0;this._parallelUploads=[];var s=this._parallelUploadUrls!=null?this._parallelUploadUrls.length:this.options.parallelUploads,f=(r=this.options.parallelUploadBoundaries)!==null&&r!==void 0?r:wn(this._source.size,s);this._parallelUploadUrls&&f.forEach(function(m,d){m.uploadUrl=n._parallelUploadUrls[d]||null}),this._parallelUploadUrls=new Array(f.length);var c=f.map(function(m,d){var g=0;return n._source.slice(m.start,m.end).then(function($){var x=$.value;return new Promise(function(O,b){var C=ne(ne({},n.options),{},{uploadUrl:m.uploadUrl||null,storeFingerprintForResuming:!1,removeFingerprintOnSuccess:!1,parallelUploads:1,parallelUploadBoundaries:null,metadata:n.options.metadataForPartialUploads,headers:ne(ne({},n.options.headers),{},{"Upload-Concat":"partial"}),onSuccess:O,onError:b,onProgress:function(D){i=i-g+D,g=D,n._emitProgress(i,o)},onUploadUrlAvailable:function(){n._parallelUploadUrls[d]=R.url,n._parallelUploadUrls.filter(function(D){return!!D}).length===f.length&&n._saveUploadInUrlStorage()}}),R=new e(x,C);R.start(),n._parallelUploads.push(R)})})}),y;Promise.all(c).then(function(){y=n._openRequest("POST",n.options.endpoint),y.setHeader("Upload-Concat","final;".concat(n._parallelUploadUrls.join(" ")));var m=pt(n.options.metadata);return m!==""&&y.setHeader("Upload-Metadata",m),n._sendRequest(y,null)}).then(function(m){if(!oe(m.getStatus(),200)){n._emitHttpError(y,m,"tus: unexpected response while creating upload");return}var d=m.getHeader("Location");if(d==null){n._emitHttpError(y,m,"tus: invalid or missing Location header");return}n.url=yt(n.options.endpoint,d),"Created upload at ".concat(n.url),n._emitSuccess(m)}).catch(function(m){n._emitError(m)})}},{key:"_startSingleUpload",value:function(){if(this._aborted=!1,this.url!=null){"Resuming upload from previous URL: ".concat(this.url),this._resumeUpload();return}if(this.options.uploadUrl!=null){"Resuming upload from provided URL: ".concat(this.options.uploadUrl),this.url=this.options.uploadUrl,this._resumeUpload();return}this._createUpload()}},{key:"abort",value:function(r){var n=this;if(this._parallelUploads!=null){var o=hn(this._parallelUploads),i;try{for(o.s();!(i=o.n()).done;){var s=i.value;s.abort(r)}}catch(f){o.e(f)}finally{o.f()}}return this._req!==null&&this._req.abort(),this._aborted=!0,this._retryTimeout!=null&&(clearTimeout(this._retryTimeout),this._retryTimeout=null),!r||this.url==null?Promise.resolve():e.terminate(this.url,this.options).then(function(){return n._removeFromUrlStorage()})}},{key:"_emitHttpError",value:function(r,n,o,i){this._emitError(new Ue(o,i,r,n))}},{key:"_emitError",value:function(r){var n=this;if(!this._aborted){if(this.options.retryDelays!=null){var o=this._offset!=null&&this._offset>this._offsetBeforeRetry;if(o&&(this._retryAttempt=0),vt(r,this._retryAttempt,this.options)){var i=this.options.retryDelays[this._retryAttempt++];this._offsetBeforeRetry=this._offset,this._retryTimeout=setTimeout(function(){n.start()},i);return}}if(typeof this.options.onError=="function")this.options.onError(r);else throw r}}},{key:"_emitSuccess",value:function(r){this.options.removeFingerprintOnSuccess&&this._removeFromUrlStorage(),typeof this.options.onSuccess=="function"&&this.options.onSuccess({lastResponse:r})}},{key:"_emitProgress",value:function(r,n){typeof this.options.onProgress=="function"&&this.options.onProgress(r,n)}},{key:"_emitChunkComplete",value:function(r,n,o){typeof this.options.onChunkComplete=="function"&&this.options.onChunkComplete(r,n,o)}},{key:"_createUpload",value:function(){var r=this;if(!this.options.endpoint){this._emitError(new Error("tus: unable to create upload because no endpoint is provided"));return}var n=this._openRequest("POST",this.options.endpoint);this.options.uploadLengthDeferred?n.setHeader("Upload-Defer-Length","1"):n.setHeader("Upload-Length","".concat(this._size));var o=pt(this.options.metadata);o!==""&&n.setHeader("Upload-Metadata",o);var i;this.options.uploadDataDuringCreation&&!this.options.uploadLengthDeferred?(this._offset=0,i=this._addChunkToRequest(n)):(this.options.protocol===Ee&&n.setHeader("Upload-Complete","?0"),i=this._sendRequest(n,null)),i.then(function(s){if(!oe(s.getStatus(),200)){r._emitHttpError(n,s,"tus: unexpected response while creating upload");return}var f=s.getHeader("Location");if(f==null){r._emitHttpError(n,s,"tus: invalid or missing Location header");return}if(r.url=yt(r.options.endpoint,f),"Created upload at ".concat(r.url),typeof r.options.onUploadUrlAvailable=="function"&&r.options.onUploadUrlAvailable(),r._size===0){r._emitSuccess(s),r._source.close();return}r._saveUploadInUrlStorage().then(function(){r.options.uploadDataDuringCreation?r._handleUploadResponse(n,s):(r._offset=0,r._performUpload())})}).catch(function(s){r._emitHttpError(n,null,"tus: failed to create upload",s)})}},{key:"_resumeUpload",value:function(){var r=this,n=this._openRequest("HEAD",this.url),o=this._sendRequest(n,null);o.then(function(i){var s=i.getStatus();if(!oe(s,200)){if(s===423){r._emitHttpError(n,i,"tus: upload is currently locked; retry later");return}if(oe(s,400)&&r._removeFromUrlStorage(),!r.options.endpoint){r._emitHttpError(n,i,"tus: unable to resume upload (new upload cannot be created without an endpoint)");return}r.url=null,r._createUpload();return}var f=Number.parseInt(i.getHeader("Upload-Offset"),10);if(Number.isNaN(f)){r._emitHttpError(n,i,"tus: invalid or missing offset value");return}var c=Number.parseInt(i.getHeader("Upload-Length"),10);if(Number.isNaN(c)&&!r.options.uploadLengthDeferred&&r.options.protocol===Ne){r._emitHttpError(n,i,"tus: invalid or missing length value");return}typeof r.options.onUploadUrlAvailable=="function"&&r.options.onUploadUrlAvailable(),r._saveUploadInUrlStorage().then(function(){if(f===c){r._emitProgress(c,c),r._emitSuccess(i);return}r._offset=f,r._performUpload()})}).catch(function(i){r._emitHttpError(n,null,"tus: failed to resume upload",i)})}},{key:"_performUpload",value:function(){var r=this;if(!this._aborted){var n;this.options.overridePatchMethod?(n=this._openRequest("POST",this.url),n.setHeader("X-HTTP-Method-Override","PATCH")):n=this._openRequest("PATCH",this.url),n.setHeader("Upload-Offset","".concat(this._offset));var o=this._addChunkToRequest(n);o.then(function(i){if(!oe(i.getStatus(),200)){r._emitHttpError(n,i,"tus: unexpected response while uploading chunk");return}r._handleUploadResponse(n,i)}).catch(function(i){r._aborted||r._emitHttpError(n,null,"tus: failed to upload chunk at offset ".concat(r._offset),i)})}}},{key:"_addChunkToRequest",value:function(r){var n=this,o=this._offset,i=this._offset+this.options.chunkSize;return r.setProgressHandler(function(s){n._emitProgress(o+s,n._size)}),r.setHeader("Content-Type","application/offset+octet-stream"),(i===Number.POSITIVE_INFINITY||i>this._size)&&!this.options.uploadLengthDeferred&&(i=this._size),this._source.slice(o,i).then(function(s){var f=s.value,c=s.done,y=f!=null&&f.size?f.size:0;n.options.uploadLengthDeferred&&c&&(n._size=n._offset+y,r.setHeader("Upload-Length","".concat(n._size)));var m=n._offset+y;return!n.options.uploadLengthDeferred&&c&&m!==n._size?Promise.reject(new Error("upload was configured with a size of ".concat(n._size," bytes, but the source is done after ").concat(m," bytes"))):f===null?n._sendRequest(r):(n.options.protocol===Ee&&r.setHeader("Upload-Complete",c?"?1":"?0"),n._emitProgress(n._offset,n._size),n._sendRequest(r,f))})}},{key:"_handleUploadResponse",value:function(r,n){var o=Number.parseInt(n.getHeader("Upload-Offset"),10);if(Number.isNaN(o)){this._emitHttpError(r,n,"tus: invalid or missing offset value");return}if(this._emitProgress(o,this._size),this._emitChunkComplete(o-this._offset,o,this._size),this._offset=o,o===this._size){this._emitSuccess(n),this._source.close();return}this._performUpload()}},{key:"_openRequest",value:function(r,n){var o=dt(r,n,this.options);return this._req=o,o}},{key:"_removeFromUrlStorage",value:function(){var r=this;this._urlStorageKey&&(this._urlStorage.removeUpload(this._urlStorageKey).catch(function(n){r._emitError(n)}),this._urlStorageKey=null)}},{key:"_saveUploadInUrlStorage",value:function(){var r=this;if(!this.options.storeFingerprintForResuming||!this._fingerprint||this._urlStorageKey!==null)return Promise.resolve();var n={size:this._size,metadata:this.options.metadata,creationTime:new Date().toString()};return this._parallelUploads?n.parallelUploadUrls=this._parallelUploadUrls:n.uploadUrl=this.url,this._urlStorage.addUpload(this._fingerprint,n).then(function(o){r._urlStorageKey=o})}},{key:"_sendRequest",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return ht(r,n,this.options)}}],[{key:"terminate",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=dt("DELETE",r,n);return ht(o,null,n).then(function(i){if(i.getStatus()!==204)throw new Ue("tus: unexpected response while terminating upload",null,o,i)}).catch(function(i){if(i instanceof Ue||(i=new Ue("tus: failed to terminate upload",i,o,null)),!vt(i,0,n))throw i;var s=n.retryDelays[0],f=n.retryDelays.slice(1),c=ne(ne({},n),{},{retryDelays:f});return new Promise(function(y){return setTimeout(y,s)}).then(function(){return e.terminate(r,c)})})}}])}();function pt(e){return Object.entries(e).map(function(t){var r=er(t,2),n=r[0],o=r[1];return"".concat(n," ").concat(Kr.encode(String(o)))}).join(",")}function oe(e,t){return e>=t&&e<t+100}function dt(e,t,r){var n=r.httpStack.createRequest(e,t);r.protocol===Ee?n.setHeader("Upload-Draft-Interop-Version","5"):n.setHeader("Tus-Resumable","1.0.0");for(var o=r.headers||{},i=0,s=Object.entries(o);i<s.length;i++){var f=er(s[i],2),c=f[0],y=f[1];n.setHeader(c,y)}if(r.addRequestId){var m=sn();n.setHeader("X-Request-ID",m)}return n}function ht(e,t,r){return Be.apply(this,arguments)}function Be(){return Be=fn(Fe().mark(function e(t,r,n){var o;return Fe().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(typeof n.onBeforeRequest!="function"){s.next=3;break}return s.next=3,n.onBeforeRequest(t);case 3:return s.next=5,t.send(r);case 5:if(o=s.sent,typeof n.onAfterResponse!="function"){s.next=9;break}return s.next=9,n.onAfterResponse(t,o);case 9:return s.abrupt("return",o);case 10:case"end":return s.stop()}},e)})),Be.apply(this,arguments)}function bn(){var e=!0;return typeof navigator<"u"&&navigator.onLine===!1&&(e=!1),e}function vt(e,t,r){return r.retryDelays==null||t>=r.retryDelays.length||e.originalRequest==null?!1:r&&typeof r.onShouldRetry=="function"?r.onShouldRetry(e,t,r):nr(e)}function nr(e){var t=e.originalResponse?e.originalResponse.getStatus():0;return(!oe(t,400)||t===409||t===423)&&bn()}function yt(e,t){return new un(t,e).toString()}function wn(e,t){for(var r=Math.floor(e/t),n=[],o=0;o<t;o++)n.push({start:r*o,end:r*(o+1)});return n[t-1].end=e,n}Oe.defaultOptions=gn;var or=function(){return typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative"};function Un(e){return new Promise(function(t,r){var n=new XMLHttpRequest;n.responseType="blob",n.onload=function(){var o=n.response;t(o)},n.onerror=function(o){r(o)},n.open("GET",e),n.send()})}var Sn=function(){return typeof window<"u"&&(typeof window.PhoneGap<"u"||typeof window.Cordova<"u"||typeof window.cordova<"u")};function xn(e){return new Promise(function(t,r){var n=new FileReader;n.onload=function(){var o=new Uint8Array(n.result);t({value:o})},n.onerror=function(o){r(o)},n.readAsArrayBuffer(e)})}function ye(e){"@babel/helpers - typeof";return ye=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ye(e)}function Pn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kn(n.key),n)}}function En(e,t,r){return t&&mt(e.prototype,t),r&&mt(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kn(e){var t=On(e,"string");return ye(t)=="symbol"?t:t+""}function On(e,t){if(ye(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ye(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _t=function(){function e(t){Pn(this,e),this._file=t,this.size=t.size}return En(e,[{key:"slice",value:function(r,n){if(Sn())return xn(this._file.slice(r,n));var o=this._file.slice(r,n),i=n>=this.size;return Promise.resolve({value:o,done:i})}},{key:"close",value:function(){}}])}();function me(e){"@babel/helpers - typeof";return me=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},me(e)}function Rn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$n(n.key),n)}}function jn(e,t,r){return t&&gt(e.prototype,t),r&&gt(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $n(e){var t=Tn(e,"string");return me(t)=="symbol"?t:t+""}function Tn(e,t){if(me(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(me(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bt(e){return e===void 0?0:e.size!==void 0?e.size:e.length}function An(e,t){if(e.concat)return e.concat(t);if(e instanceof Blob)return new Blob([e,t],{type:e.type});if(e.set){var r=new e.constructor(e.length+t.length);return r.set(e),r.set(t,e.length),r}throw new Error("Unknown data type")}var Ln=function(){function e(t){Rn(this,e),this._buffer=void 0,this._bufferOffset=0,this._reader=t,this._done=!1}return jn(e,[{key:"slice",value:function(r,n){return r<this._bufferOffset?Promise.reject(new Error("Requested data is before the reader's current offset")):this._readUntilEnoughDataOrDone(r,n)}},{key:"_readUntilEnoughDataOrDone",value:function(r,n){var o=this,i=n<=this._bufferOffset+bt(this._buffer);if(this._done||i){var s=this._getDataFromBuffer(r,n),f=s==null?this._done:!1;return Promise.resolve({value:s,done:f})}return this._reader.read().then(function(c){var y=c.value,m=c.done;return m?o._done=!0:o._buffer===void 0?o._buffer=y:o._buffer=An(o._buffer,y),o._readUntilEnoughDataOrDone(r,n)})}},{key:"_getDataFromBuffer",value:function(r,n){r>this._bufferOffset&&(this._buffer=this._buffer.slice(r-this._bufferOffset),this._bufferOffset=r);var o=bt(this._buffer)===0;return this._done&&o?null:this._buffer.slice(0,n-r)}},{key:"close",value:function(){this._reader.cancel&&this._reader.cancel()}}])}();function re(e){"@babel/helpers - typeof";return re=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},re(e)}function ze(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ze=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(u,a,l){u[a]=l.value},i=typeof Symbol=="function"?Symbol:{},s=i.iterator||"@@iterator",f=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function y(u,a,l){return Object.defineProperty(u,a,{value:l,enumerable:!0,configurable:!0,writable:!0}),u[a]}try{y({},"")}catch{y=function(l,p,v){return l[p]=v}}function m(u,a,l,p){var v=a&&a.prototype instanceof C?a:C,h=Object.create(v.prototype),_=new A(p||[]);return o(h,"_invoke",{value:T(u,l,_)}),h}function d(u,a,l){try{return{type:"normal",arg:u.call(a,l)}}catch(p){return{type:"throw",arg:p}}}t.wrap=m;var g="suspendedStart",$="suspendedYield",x="executing",O="completed",b={};function C(){}function R(){}function S(){}var D={};y(D,s,function(){return this});var E=Object.getPrototypeOf,G=E&&E(E(Q([])));G&&G!==r&&n.call(G,s)&&(D=G);var F=S.prototype=C.prototype=Object.create(D);function N(u){["next","throw","return"].forEach(function(a){y(u,a,function(l){return this._invoke(a,l)})})}function w(u,a){function l(v,h,_,U){var P=d(u[v],u,h);if(P.type!=="throw"){var q=P.arg,L=q.value;return L&&re(L)=="object"&&n.call(L,"__await")?a.resolve(L.__await).then(function(H){l("next",H,_,U)},function(H){l("throw",H,_,U)}):a.resolve(L).then(function(H){q.value=H,_(q)},function(H){return l("throw",H,_,U)})}U(P.arg)}var p;o(this,"_invoke",{value:function(h,_){function U(){return new a(function(P,q){l(h,_,P,q)})}return p=p?p.then(U,U):U()}})}function T(u,a,l){var p=g;return function(v,h){if(p===x)throw Error("Generator is already running");if(p===O){if(v==="throw")throw h;return{value:e,done:!0}}for(l.method=v,l.arg=h;;){var _=l.delegate;if(_){var U=K(_,l);if(U){if(U===b)continue;return U}}if(l.method==="next")l.sent=l._sent=l.arg;else if(l.method==="throw"){if(p===g)throw p=O,l.arg;l.dispatchException(l.arg)}else l.method==="return"&&l.abrupt("return",l.arg);p=x;var P=d(u,a,l);if(P.type==="normal"){if(p=l.done?O:$,P.arg===b)continue;return{value:P.arg,done:l.done}}P.type==="throw"&&(p=O,l.method="throw",l.arg=P.arg)}}}function K(u,a){var l=a.method,p=u.iterator[l];if(p===e)return a.delegate=null,l==="throw"&&u.iterator.return&&(a.method="return",a.arg=e,K(u,a),a.method==="throw")||l!=="return"&&(a.method="throw",a.arg=new TypeError("The iterator does not provide a '"+l+"' method")),b;var v=d(p,u.iterator,a.arg);if(v.type==="throw")return a.method="throw",a.arg=v.arg,a.delegate=null,b;var h=v.arg;return h?h.done?(a[u.resultName]=h.value,a.next=u.nextLoc,a.method!=="return"&&(a.method="next",a.arg=e),a.delegate=null,b):h:(a.method="throw",a.arg=new TypeError("iterator result is not an object"),a.delegate=null,b)}function ce(u){var a={tryLoc:u[0]};1 in u&&(a.catchLoc=u[1]),2 in u&&(a.finallyLoc=u[2],a.afterLoc=u[3]),this.tryEntries.push(a)}function W(u){var a=u.completion||{};a.type="normal",delete a.arg,u.completion=a}function A(u){this.tryEntries=[{tryLoc:"root"}],u.forEach(ce,this),this.reset(!0)}function Q(u){if(u||u===""){var a=u[s];if(a)return a.call(u);if(typeof u.next=="function")return u;if(!isNaN(u.length)){var l=-1,p=function v(){for(;++l<u.length;)if(n.call(u,l))return v.value=u[l],v.done=!1,v;return v.value=e,v.done=!0,v};return p.next=p}}throw new TypeError(re(u)+" is not iterable")}return R.prototype=S,o(F,"constructor",{value:S,configurable:!0}),o(S,"constructor",{value:R,configurable:!0}),R.displayName=y(S,c,"GeneratorFunction"),t.isGeneratorFunction=function(u){var a=typeof u=="function"&&u.constructor;return!!a&&(a===R||(a.displayName||a.name)==="GeneratorFunction")},t.mark=function(u){return Object.setPrototypeOf?Object.setPrototypeOf(u,S):(u.__proto__=S,y(u,c,"GeneratorFunction")),u.prototype=Object.create(F),u},t.awrap=function(u){return{__await:u}},N(w.prototype),y(w.prototype,f,function(){return this}),t.AsyncIterator=w,t.async=function(u,a,l,p,v){v===void 0&&(v=Promise);var h=new w(m(u,a,l,p),v);return t.isGeneratorFunction(a)?h:h.next().then(function(_){return _.done?_.value:h.next()})},N(F),y(F,c,"Generator"),y(F,s,function(){return this}),y(F,"toString",function(){return"[object Generator]"}),t.keys=function(u){var a=Object(u),l=[];for(var p in a)l.push(p);return l.reverse(),function v(){for(;l.length;){var h=l.pop();if(h in a)return v.value=h,v.done=!1,v}return v.done=!0,v}},t.values=Q,A.prototype={constructor:A,reset:function(a){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(W),!a)for(var l in this)l.charAt(0)==="t"&&n.call(this,l)&&!isNaN(+l.slice(1))&&(this[l]=e)},stop:function(){this.done=!0;var a=this.tryEntries[0].completion;if(a.type==="throw")throw a.arg;return this.rval},dispatchException:function(a){if(this.done)throw a;var l=this;function p(q,L){return _.type="throw",_.arg=a,l.next=q,L&&(l.method="next",l.arg=e),!!L}for(var v=this.tryEntries.length-1;v>=0;--v){var h=this.tryEntries[v],_=h.completion;if(h.tryLoc==="root")return p("end");if(h.tryLoc<=this.prev){var U=n.call(h,"catchLoc"),P=n.call(h,"finallyLoc");if(U&&P){if(this.prev<h.catchLoc)return p(h.catchLoc,!0);if(this.prev<h.finallyLoc)return p(h.finallyLoc)}else if(U){if(this.prev<h.catchLoc)return p(h.catchLoc,!0)}else{if(!P)throw Error("try statement without catch or finally");if(this.prev<h.finallyLoc)return p(h.finallyLoc)}}}},abrupt:function(a,l){for(var p=this.tryEntries.length-1;p>=0;--p){var v=this.tryEntries[p];if(v.tryLoc<=this.prev&&n.call(v,"finallyLoc")&&this.prev<v.finallyLoc){var h=v;break}}h&&(a==="break"||a==="continue")&&h.tryLoc<=l&&l<=h.finallyLoc&&(h=null);var _=h?h.completion:{};return _.type=a,_.arg=l,h?(this.method="next",this.next=h.finallyLoc,b):this.complete(_)},complete:function(a,l){if(a.type==="throw")throw a.arg;return a.type==="break"||a.type==="continue"?this.next=a.arg:a.type==="return"?(this.rval=this.arg=a.arg,this.method="return",this.next="end"):a.type==="normal"&&l&&(this.next=l),b},finish:function(a){for(var l=this.tryEntries.length-1;l>=0;--l){var p=this.tryEntries[l];if(p.finallyLoc===a)return this.complete(p.completion,p.afterLoc),W(p),b}},catch:function(a){for(var l=this.tryEntries.length-1;l>=0;--l){var p=this.tryEntries[l];if(p.tryLoc===a){var v=p.completion;if(v.type==="throw"){var h=v.arg;W(p)}return h}}throw Error("illegal catch attempt")},delegateYield:function(a,l,p){return this.delegate={iterator:Q(a),resultName:l,nextLoc:p},this.method==="next"&&(this.arg=e),b}},t}function wt(e,t,r,n,o,i,s){try{var f=e[i](s),c=f.value}catch(y){r(y);return}f.done?t(c):Promise.resolve(c).then(n,o)}function In(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function s(c){wt(i,n,o,s,f,"next",c)}function f(c){wt(i,n,o,s,f,"throw",c)}s(void 0)})}}function Cn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ut(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Fn(n.key),n)}}function Dn(e,t,r){return t&&Ut(e.prototype,t),r&&Ut(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Fn(e){var t=Nn(e,"string");return re(t)=="symbol"?t:t+""}function Nn(e,t){if(re(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(re(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Bn=function(){function e(){Cn(this,e)}return Dn(e,[{key:"openFile",value:function(){var t=In(ze().mark(function n(o,i){var s;return ze().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(!(or()&&o&&typeof o.uri<"u")){c.next=11;break}return c.prev=1,c.next=4,Un(o.uri);case 4:return s=c.sent,c.abrupt("return",new _t(s));case 8:throw c.prev=8,c.t0=c.catch(1),new Error("tus: cannot fetch `file.uri` as Blob, make sure the uri is correct and accessible. ".concat(c.t0));case 11:if(!(typeof o.slice=="function"&&typeof o.size<"u")){c.next=13;break}return c.abrupt("return",Promise.resolve(new _t(o)));case 13:if(typeof o.read!="function"){c.next=18;break}if(i=Number(i),Number.isFinite(i)){c.next=17;break}return c.abrupt("return",Promise.reject(new Error("cannot create source for stream without a finite value for the `chunkSize` option")));case 17:return c.abrupt("return",Promise.resolve(new Ln(o,i)));case 18:return c.abrupt("return",Promise.reject(new Error("source object may only be an instance of File, Blob, or Reader in this environment")));case 19:case"end":return c.stop()}},n,null,[[1,8]])}));function r(n,o){return t.apply(this,arguments)}return r}()}])}();function zn(e,t){return or()?Promise.resolve(qn(e,t)):Promise.resolve(["tus-br",e.name,e.type,e.size,e.lastModified,t.endpoint].join("-"))}function qn(e,t){var r=e.exif?Hn(JSON.stringify(e.exif)):"noexif";return["tus-rn",e.name||"noname",e.size||"nosize",r,t.endpoint].join("/")}function Hn(e){var t=0;if(e.length===0)return t;for(var r=0;r<e.length;r++){var n=e.charCodeAt(r);t=(t<<5)-t+n,t&=t}return t}function _e(e){"@babel/helpers - typeof";return _e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_e(e)}function Ye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function St(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Vn(n.key),n)}}function Ze(e,t,r){return t&&St(e.prototype,t),r&&St(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vn(e){var t=Mn(e,"string");return _e(t)=="symbol"?t:t+""}function Mn(e,t){if(_e(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_e(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Gn=function(){function e(){Ye(this,e)}return Ze(e,[{key:"createRequest",value:function(r,n){return new Kn(r,n)}},{key:"getName",value:function(){return"XHRHttpStack"}}])}(),Kn=function(){function e(t,r){Ye(this,e),this._xhr=new XMLHttpRequest,this._xhr.open(t,r,!0),this._method=t,this._url=r,this._headers={}}return Ze(e,[{key:"getMethod",value:function(){return this._method}},{key:"getURL",value:function(){return this._url}},{key:"setHeader",value:function(r,n){this._xhr.setRequestHeader(r,n),this._headers[r]=n}},{key:"getHeader",value:function(r){return this._headers[r]}},{key:"setProgressHandler",value:function(r){"upload"in this._xhr&&(this._xhr.upload.onprogress=function(n){n.lengthComputable&&r(n.loaded)})}},{key:"send",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return new Promise(function(o,i){r._xhr.onload=function(){o(new Xn(r._xhr))},r._xhr.onerror=function(s){i(s)},r._xhr.send(n)})}},{key:"abort",value:function(){return this._xhr.abort(),Promise.resolve()}},{key:"getUnderlyingObject",value:function(){return this._xhr}}])}(),Xn=function(){function e(t){Ye(this,e),this._xhr=t}return Ze(e,[{key:"getStatus",value:function(){return this._xhr.status}},{key:"getHeader",value:function(r){return this._xhr.getResponseHeader(r)}},{key:"getBody",value:function(){return this._xhr.responseText}},{key:"getUnderlyingObject",value:function(){return this._xhr}}])}();function ge(e){"@babel/helpers - typeof";return ge=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ge(e)}function Yn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Wn(n.key),n)}}function Zn(e,t,r){return t&&xt(e.prototype,t),r&&xt(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Wn(e){var t=Jn(e,"string");return ge(t)=="symbol"?t:t+""}function Jn(e,t){if(ge(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ge(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qe=!1;try{qe="localStorage"in window;var Ae="tusSupport",Pt=localStorage.getItem(Ae);localStorage.setItem(Ae,Pt),Pt===null&&localStorage.removeItem(Ae)}catch(e){if(e.code===e.SECURITY_ERR||e.code===e.QUOTA_EXCEEDED_ERR)qe=!1;else throw e}var Qn=qe,eo=function(){function e(){Yn(this,e)}return Zn(e,[{key:"findAllUploads",value:function(){var r=this._findEntries("tus::");return Promise.resolve(r)}},{key:"findUploadsByFingerprint",value:function(r){var n=this._findEntries("tus::".concat(r,"::"));return Promise.resolve(n)}},{key:"removeUpload",value:function(r){return localStorage.removeItem(r),Promise.resolve()}},{key:"addUpload",value:function(r,n){var o=Math.round(Math.random()*1e12),i="tus::".concat(r,"::").concat(o);return localStorage.setItem(i,JSON.stringify(n)),Promise.resolve(i)}},{key:"_findEntries",value:function(r){for(var n=[],o=0;o<localStorage.length;o++){var i=localStorage.key(o);if(i.indexOf(r)===0)try{var s=JSON.parse(localStorage.getItem(i));s.urlStorageKey=i,n.push(s)}catch{}}return n}}])}();function se(e){"@babel/helpers - typeof";return se=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},se(e)}function to(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Et(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ar(n.key),n)}}function ro(e,t,r){return t&&Et(e.prototype,t),r&&Et(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function no(e,t,r){return t=Re(t),oo(e,ir()?Reflect.construct(t,r||[],Re(e).constructor):t.apply(e,r))}function oo(e,t){if(t&&(se(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return io(e)}function io(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ir(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ir=function(){return!!e})()}function Re(e){return Re=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Re(e)}function ao(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&He(e,t)}function He(e,t){return He=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},He(e,t)}function kt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function ie(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kt(Object(r),!0).forEach(function(n){lo(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kt(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function lo(e,t,r){return t=ar(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ar(e){var t=uo(e,"string");return se(t)=="symbol"?t:t+""}function uo(e,t){if(se(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(se(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ot=ie(ie({},Oe.defaultOptions),{},{httpStack:new Gn,fileReader:new Bn,urlStorage:Qn?new eo:new Cr,fingerprint:zn}),so=function(e){function t(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return to(this,t),n=ie(ie({},Ot),n),no(this,t,[r,n])}return ao(t,e),ro(t,null,[{key:"terminate",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return o=ie(ie({},Ot),o),Oe.terminate(n,o)}}])}(Oe);const lr=e=>($t("data-v-2dc78883"),e=e(),Tt(),e),fo={class:"yandex-video-uploader"},co=lr(()=>j("h3",{class:"yandex-video-uploader__drop-region__label"}," Кликните или перетащите файл сюда ",-1)),po={class:"yandex-video-uploader__drop-region__hint"},ho=["accept"],vo={key:1,class:"yandex-video-uploader__uploader"},yo={key:0,class:"yandex-video-uploader__uploader__progress"},mo={key:1,class:"yandex-video-uploader__uploader__actions"},_o={key:2,class:"yandex-video-uploader__uploader__error"},go=lr(()=>j("h3",null,"Ошибка загрузки",-1)),bo=be({__name:"yandex-video-uploader",props:{uploadUrl:{}},emits:["before-upload","upload-finished","error"],setup(e,{emit:t}){const r=e,n=t,o={chunkSize:5*1024*1024,allowedFormats:["video/mp4","video/avi","video/mov"]},i=o.allowedFormats.map(N=>N.split("/")[1]).join(", "),s=`yandex-uploader-${fr()}`,f=M(null),c=M(null),y=M(!1),m=M(0),d=M(!1),g=M(null);let $=0;const x=M(!1);function O(){x.value=!0,clearTimeout($)}function b(){$=setTimeout(()=>{x.value=!1},50)}function C(N){var T;const w=Array.from(((T=N.dataTransfer)==null?void 0:T.files)||[]);w&&w[0]&&F(w[0])&&(f.value=w[0],n("before-upload",f.value))}function R(N){const T=N.target.files;T&&T[0]&&F(T[0])&&(f.value=T[0],n("before-upload",f.value))}xe(()=>r.uploadUrl,()=>{r.uploadUrl&&S()});function S(){var w;if(!f.value||!r.uploadUrl)return;y.value=!0;const N={uploadUrl:r.uploadUrl,chunkSize:o.chunkSize,metadata:{filename:f.value.name,filetype:f.value.type},onError:T=>{y.value=!1,g.value=T,n("error")},onProgress:(T,K)=>{m.value=Math.floor(T/K*100)},onSuccess:()=>{y.value=!1,n("upload-finished")},retryDelays:[0,1e3,3e3,5e3]};c.value=new so(f.value,N),(w=c.value)==null||w.start()}function D(){d.value=!0,c.value&&c.value.abort()}function E(){c.value?(d.value=!1,c.value.start()):S()}function G(){c.value&&(c.value.abort(),c.value=null,y.value=!1,m.value=0,f.value=null,d.value=!1)}function F(N){return o.allowedFormats.includes(N.type)}return(N,w)=>{const T=pr,K=je,ce=dr,W=Rt("auto-animate");return jt((k(),B("div",fo,[f.value?V("",!0):(k(),B("label",{key:0,class:cr(["yandex-video-uploader__drop-region",{"yandex-video-uploader__drop-region--drag":x.value}]),for:s,onDragenter:w[1]||(w[1]=we(A=>O(),["prevent"])),onDragleave:w[2]||(w[2]=we(A=>b(),["prevent"])),onDragover:w[3]||(w[3]=we(()=>{},["prevent"])),onMouseleave:w[4]||(w[4]=A=>b()),onDrop:w[5]||(w[5]=we(A=>C(A),["prevent"]))},[co,j("p",po," Допустимые форматы: "+Te(ke(i)),1),j("input",{id:s,hidden:"",type:"file",onChange:w[0]||(w[0]=A=>R(A)),accept:o.allowedFormats.join(", ")},null,40,ho)],34)),y.value||f.value?(k(),B("div",vo,[g.value?V("",!0):(k(),B("div",yo,[j("h1",null,Te(m.value)+"%",1),z(T,{value:m.value},null,8,["value"])])),g.value?V("",!0):(k(),B("div",mo,[!d.value&&y.value?(k(),ee(K,{key:0,design:"inline",onClick:w[6]||(w[6]=A=>D())},{default:X(()=>[J(" Пауза ")]),_:1})):V("",!0),d.value?(k(),ee(K,{key:1,design:"primary",onClick:w[7]||(w[7]=A=>E())},{default:X(()=>[J(" Продолжить ")]),_:1})):V("",!0),z(K,{design:"danger",onClick:w[8]||(w[8]=A=>G())},{default:X(()=>[J(" Отменить ")]),_:1})])),g.value?(k(),B("div",_o,[z(ce,null,{default:X(()=>[go,j("p",null,Te(g.value),1)]),_:1})])):V("",!0)])):V("",!0)])),[[W]])}}});const wo=At(bo,[["__scopeId","data-v-2dc78883"]]),Uo={class:"video-creation-upload-form"},So={key:1,class:"video-creation-upload-form__link"},xo=j("br",null,null,-1),Po=j("br",null,null,-1),Eo={class:"video-creation-upload-form__actions"},ko=be({__name:"video-creation-upload-form",props:{videoLink:{},uploadUrl:{},serviceType:{}},emits:["publish","before-upload","finish-upload"],setup(e,{emit:t}){const r=t,n=M(!1),o=()=>{n.value=!0,r("finish-upload")};return(i,s)=>{const f=wo,c=Lt,y=hr,m=je;return k(),B("div",Uo,[i.serviceType==="yandex"?(k(),ee(f,{key:0,"upload-url":i.uploadUrl,onBeforeUpload:s[0]||(s[0]=d=>i.$emit("before-upload",d)),onUploadFinished:s[1]||(s[1]=d=>o())},null,8,["upload-url"])):V("",!0),i.videoLink?(k(),B("div",So,[z(c,{readonly:"",label:"Ссылка на видео","model-value":`${ke(ae).Constants.APP_URL}${i.videoLink}`,type:"text","copy-button":""},null,8,["model-value"]),xo,z(y,null,{default:X(()=>[J(" Видео будет доступно после полной загрузки и обработки, это может занять некоторое время. ")]),_:1})])):V("",!0),Po,j("div",Eo,[n.value?(k(),ee(m,{key:0,onClick:s[2]||(s[2]=d=>i.$emit("publish")),design:"primary",alignment:"right"},{default:X(()=>[J(" Опубликовать видео ")]),_:1})):V("",!0)])])}}}),Oo={class:"video-creation-info-form"},Ro={class:"form-group"},jo={class:"form-group"},$o={class:"form-group"},To={class:"form-group"},Ao={class:"row"},Lo={class:"col-md-4"},Io={key:0,class:"col-md-4"},Co={key:1,class:"col-md-4"},Do={class:"form-group"},Fo=be({__name:"video-creation-info-form",props:{video:{}},emits:["update:video","next-step"],setup(e,{emit:t}){const r=e,n=t,o=ae.Services.UI,i=It({get:()=>r.video,set:d=>n("update:video",d)}),s=M([]);xe(s,d=>{i.value.thumbnail=d[0]||null});const f=M(null);xe(f,d=>{switch(i.value.accessType){case"courseId":i.value.accessValue=d.map(g=>g.id).join(",");break;case"role":i.value.accessValue=(d==null?void 0:d.value)||"student";break;case"everyone":default:i.value.accessValue=null;break}}),xe(()=>i.value.accessType,()=>{switch(i.value.accessType){case"role":i.value.accessValue="student";break;case"courseId":case"everyone":default:i.value.accessValue=null;break}});const c=[{value:"everyone",label:"Всем"},{value:"courseId",label:"Участникам курса"},{value:"role",label:"По роли"}];function y(){m()&&n("next-step")}function m(){return!i.value.title.length||i.value.title.length>100?(o.openErrorModal("Не удалось создать видео","Название не должно быть пустым или превышать 100 символов"),!1):i.value.serviceType?!0:(o.openErrorModal("Не удалось создать видео","Выберите сервис для загрузки видео"),!1)}return(d,g)=>{const $=Lt,x=vr,O=yr,b=mr,C=_r,R=gr,S=br,D=je;return k(),B("div",Oo,[j("div",Ro,[z($,{label:"Название",modelValue:i.value.title,"onUpdate:modelValue":g[0]||(g[0]=E=>i.value.title=E),type:"text",validators:[E=>E.length>0||"Введите название видео",E=>E.length<=100||"Название не должно превышать 100 символов"]},null,8,["modelValue","validators"])]),j("div",jo,[z(x,{modelValue:s.value,"onUpdate:modelValue":g[1]||(g[1]=E=>s.value=E),label:"Превью-изображение","max-count":1,"allowed-mime-types":["image/jpeg","image/png"]},null,8,["modelValue"])]),j("div",$o,[z(O,{label:"Описание",modelValue:i.value.description,"onUpdate:modelValue":g[2]||(g[2]=E=>i.value.description=E)},null,8,["modelValue"])]),j("div",To,[j("div",Ao,[j("div",Lo,[z($,{label:"Дата публикации",modelValue:i.value.publishedAt,"onUpdate:modelValue":g[3]||(g[3]=E=>i.value.publishedAt=E),type:"date"},null,8,["modelValue"])]),ke(ae).Context.roleIs(["admin","teacher"])?(k(),B("div",Io,[z(b,{label:"Видео доступно",modelValue:i.value.accessType,"onUpdate:modelValue":g[4]||(g[4]=E=>i.value.accessType=E),options:c},null,8,["modelValue"]),i.value.accessType==="everyone"?(k(),ee(C,{key:0,small:"",class:"everyone-access-type-warning"},{default:X(()=>[J(" Доступно всем пользователям, включая всех, кто перешел по ссылке или зарегистрировался на платформе без приобретения курса. ")]),_:1})):V("",!0)])):V("",!0),ke(ae).Context.roleIs(["admin","teacher"])?(k(),B("div",Co,[i.value.accessType==="courseId"?(k(),ee(R,{key:0,label:"Курс","max-count":10,modelValue:f.value,"onUpdate:modelValue":g[5]||(g[5]=E=>f.value=E)},null,8,["modelValue"])):i.value.accessType==="role"?(k(),ee(S,{key:1,label:"Роль",modelValue:f.value,"onUpdate:modelValue":g[6]||(g[6]=E=>f.value=E)},null,8,["modelValue"])):V("",!0)])):V("",!0)])]),j("div",Do,[z(D,{alignment:"right",onClick:y},{default:X(()=>[J(" Следующий шаг ")]),_:1})])])}}});const ur=e=>($t("data-v-41f541a9"),e=e(),Tt(),e),No={class:"video-creation-form"},Bo={key:0,class:"video-creation-form__info-step"},zo={key:1,class:"video-creation-form__upload-step"},qo={key:2,class:"video-creation-form__success-step"},Ho=ur(()=>j("h1",{class:"video-creation-form__success-step__title"}," Видео успешно загружено ",-1)),Vo=ur(()=>j("p",{class:"video-creation-form__success-step__hint"}," Видео будет доступно после обработки, это может занять некоторое время. Чем больше видео, тем дольше обработка. ",-1)),Mo={class:"video-creation-form__success-step__actions"},Go=be({__name:"video-creation-form",emits:["video-created"],setup(e,{emit:t}){const r=t,n=ae.Services.Video,o=ae.Services.UI,i=M(g()),s=It(()=>i.value.id?`/nootube/video/${i.value.id}`:null),f=M("info");async function c($){var x,O;try{i.value.sizeInBytes=$.size;const b=await n.createVideo({...i.value,id:void 0});if(!((x=b.data)!=null&&x.id)||!((O=b.data)!=null&&O.uploadUrl))throw new Error("Не удалось создать видео");i.value.id=b.data.id,i.value.uploadUrl=b.data.uploadUrl}catch(b){o.openErrorModal("Не удалось создать видео",b.message),f.value="info"}finally{f.value="upload"}}async function y(){if(i.value.id)try{await n.finishUpload(i.value.id,{showLoader:!0}),i.value.state="uploaded"}catch($){o.openErrorModal("Не удалось завершить загрузку видео",$.message),f.value="upload"}}async function m(){if(i.value.id)try{await n.publish(i.value.id),f.value="success",r("video-created",i.value)}catch($){o.openErrorModal("Не удалось сохранить видео",$.message),f.value="upload"}}function d(){i.value=g(),f.value="info"}function g(){return{id:null,title:"",description:wr(),publishedAt:new Date,serviceType:"yandex",uniqueIdentifier:"",state:"not-uploaded",accessType:"everyone",accessValue:null,sizeInBytes:0,duration:0,chapters:[],thumbnail:null,uploadUrl:null,url:null}}return($,x)=>{const O=Fo,b=ko,C=je,R=Rt("auto-animate");return jt((k(),B("div",No,[f.value==="info"?(k(),B("div",Bo,[z(O,{video:i.value,"onUpdate:video":x[0]||(x[0]=S=>i.value=S),onNextStep:x[1]||(x[1]=S=>f.value="upload")},null,8,["video"])])):f.value==="upload"?(k(),B("div",zo,[z(b,{"upload-url":i.value.uploadUrl,"service-type":i.value.serviceType,"video-link":s.value,onBeforeUpload:x[2]||(x[2]=S=>c(S)),onFinishUpload:x[3]||(x[3]=S=>y()),onPublish:x[4]||(x[4]=S=>m())},null,8,["upload-url","service-type","video-link"])])):f.value==="success"?(k(),B("div",qo,[Ho,Vo,j("div",Mo,[z(C,{to:s.value,design:"primary",alignment:"center"},{default:X(()=>[J(" Перейти к видео ")]),_:1},8,["to"]),z(C,{onClick:x[5]||(x[5]=S=>d()),design:"secondary",alignment:"center"},{default:X(()=>[J(" Загрузить еще видео ")]),_:1})])])):V("",!0)])),[[R]])}}});const Ko=At(Go,[["__scopeId","data-v-41f541a9"]]),Xo={class:"upload-video-view"},Zo=be({__name:"upload-video-view",setup(e){function t(r){}return(r,n)=>{const o=Ko;return k(),B("div",Xo,[z(o,{onUploaded:n[0]||(n[0]=i=>void 0)})])}}});export{Zo as default};
