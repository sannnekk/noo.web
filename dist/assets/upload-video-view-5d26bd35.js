import{a3 as ur,a4 as Ze,d as _e,a5 as lr,r as H,w as we,q as kt,s as Rt,a as O,i as N,g as A,v as je,u as Te,f as z,j as q,b as J,e as G,y as K,a6 as sr,E as Ee,D as fr,p as jt,l as $t,_ as Tt,C as fe,c as At,a1 as cr,a7 as pr,a8 as dr,a9 as hr,aa as yr,ab as vr,ac as mr,ad as _r}from"./index-493c59df.js";function ie(e){"@babel/helpers - typeof";return ie=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ie(e)}function We(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,br(n.key),n)}}function gr(e,t,r){return t&&We(e.prototype,t),r&&We(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function br(e){var t=wr(e,"string");return ie(t)=="symbol"?t:t+""}function wr(e,t){if(ie(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ie(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ur(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Sr(e,t,r){return t=pe(t),xr(e,He()?Reflect.construct(t,r||[],pe(e).constructor):t.apply(e,r))}function xr(e,t){if(t&&(ie(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Pr(e)}function Pr(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Er(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ce(e,t)}function Ae(e){var t=typeof Map=="function"?new Map:void 0;return Ae=function(n){if(n===null||!kr(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t<"u"){if(t.has(n))return t.get(n);t.set(n,o)}function o(){return Or(n,arguments,pe(this).constructor)}return o.prototype=Object.create(n.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),ce(o,n)},Ae(e)}function Or(e,t,r){if(He())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,t);var o=new(e.bind.apply(e,n));return r&&ce(o,r.prototype),o}function He(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(He=function(){return!!e})()}function kr(e){try{return Function.toString.call(e).indexOf("[native code]")!==-1}catch{return typeof e=="function"}}function ce(e,t){return ce=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},ce(e,t)}function pe(e){return pe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},pe(e)}var ge=function(e){function t(r){var n,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(Ur(this,t),n=Sr(this,t,[r]),n.originalRequest=i,n.originalResponse=s,n.causingError=o,o!=null&&(r+=", caused by ".concat(o.toString())),i!=null){var f=i.getHeader("X-Request-ID")||"n/a",c=i.getMethod(),v=i.getURL(),m=s?s.getStatus():"n/a",h=s?s.getBody()||"":"n/a";r+=", originated from request (method: ".concat(c,", url: ").concat(v,", response code: ").concat(m,", response text: ").concat(h,", request id: ").concat(f,")")}return n.message=r,n}return Er(t,e),gr(t)}(Ae(Error));function de(e){"@babel/helpers - typeof";return de=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},de(e)}function Rr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Je(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$r(n.key),n)}}function jr(e,t,r){return t&&Je(e.prototype,t),r&&Je(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $r(e){var t=Tr(e,"string");return de(t)=="symbol"?t:t+""}function Tr(e,t){if(de(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(de(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ar=function(){function e(){Rr(this,e)}return jr(e,[{key:"listAllUploads",value:function(){return Promise.resolve([])}},{key:"findUploadsByFingerprint",value:function(r){return Promise.resolve([])}},{key:"removeUpload",value:function(r){return Promise.resolve()}},{key:"addUpload",value:function(r,n){return Promise.resolve(null)}}])}();const Lt="3.7.7",Lr=Lt,ue=typeof Buffer=="function",Qe=typeof TextDecoder=="function"?new TextDecoder:void 0,et=typeof TextEncoder=="function"?new TextEncoder:void 0,Ir="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",se=Array.prototype.slice.call(Ir),be=(e=>{let t={};return e.forEach((r,n)=>t[r]=n),t})(se),Cr=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,T=String.fromCharCode.bind(String),tt=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):e=>new Uint8Array(Array.prototype.slice.call(e,0)),It=e=>e.replace(/=/g,"").replace(/[+\/]/g,t=>t=="+"?"-":"_"),Ct=e=>e.replace(/[^A-Za-z0-9\+\/]/g,""),Ft=e=>{let t,r,n,o,i="";const s=e.length%3;for(let f=0;f<e.length;){if((r=e.charCodeAt(f++))>255||(n=e.charCodeAt(f++))>255||(o=e.charCodeAt(f++))>255)throw new TypeError("invalid character found");t=r<<16|n<<8|o,i+=se[t>>18&63]+se[t>>12&63]+se[t>>6&63]+se[t&63]}return s?i.slice(0,s-3)+"===".substring(s):i},Ve=typeof btoa=="function"?e=>btoa(e):ue?e=>Buffer.from(e,"binary").toString("base64"):Ft,Le=ue?e=>Buffer.from(e).toString("base64"):e=>{let r=[];for(let n=0,o=e.length;n<o;n+=4096)r.push(T.apply(null,e.subarray(n,n+4096)));return Ve(r.join(""))},Ue=(e,t=!1)=>t?It(Le(e)):Le(e),Fr=e=>{if(e.length<2){var t=e.charCodeAt(0);return t<128?e:t<2048?T(192|t>>>6)+T(128|t&63):T(224|t>>>12&15)+T(128|t>>>6&63)+T(128|t&63)}else{var t=65536+(e.charCodeAt(0)-55296)*1024+(e.charCodeAt(1)-56320);return T(240|t>>>18&7)+T(128|t>>>12&63)+T(128|t>>>6&63)+T(128|t&63)}},Dr=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,Dt=e=>e.replace(Dr,Fr),rt=ue?e=>Buffer.from(e,"utf8").toString("base64"):et?e=>Le(et.encode(e)):e=>Ve(Dt(e)),oe=(e,t=!1)=>t?It(rt(e)):rt(e),nt=e=>oe(e,!0),Nr=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,Br=e=>{switch(e.length){case 4:var t=(7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3),r=t-65536;return T((r>>>10)+55296)+T((r&1023)+56320);case 3:return T((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return T((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},Nt=e=>e.replace(Nr,Br),Bt=e=>{if(e=e.replace(/\s+/g,""),!Cr.test(e))throw new TypeError("malformed base64.");e+="==".slice(2-(e.length&3));let t,r="",n,o;for(let i=0;i<e.length;)t=be[e.charAt(i++)]<<18|be[e.charAt(i++)]<<12|(n=be[e.charAt(i++)])<<6|(o=be[e.charAt(i++)]),r+=n===64?T(t>>16&255):o===64?T(t>>16&255,t>>8&255):T(t>>16&255,t>>8&255,t&255);return r},Me=typeof atob=="function"?e=>atob(Ct(e)):ue?e=>Buffer.from(e,"base64").toString("binary"):Bt,zt=ue?e=>tt(Buffer.from(e,"base64")):e=>tt(Me(e).split("").map(t=>t.charCodeAt(0))),qt=e=>zt(Ht(e)),zr=ue?e=>Buffer.from(e,"base64").toString("utf8"):Qe?e=>Qe.decode(zt(e)):e=>Nt(Me(e)),Ht=e=>Ct(e.replace(/[-_]/g,t=>t=="-"?"+":"/")),Ie=e=>zr(Ht(e)),qr=e=>{if(typeof e!="string")return!1;const t=e.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(t)||!/[^\s0-9a-zA-Z\-_]/.test(t)},Vt=e=>({value:e,enumerable:!1,writable:!0,configurable:!0}),Mt=function(){const e=(t,r)=>Object.defineProperty(String.prototype,t,Vt(r));e("fromBase64",function(){return Ie(this)}),e("toBase64",function(t){return oe(this,t)}),e("toBase64URI",function(){return oe(this,!0)}),e("toBase64URL",function(){return oe(this,!0)}),e("toUint8Array",function(){return qt(this)})},Gt=function(){const e=(t,r)=>Object.defineProperty(Uint8Array.prototype,t,Vt(r));e("toBase64",function(t){return Ue(this,t)}),e("toBase64URI",function(){return Ue(this,!0)}),e("toBase64URL",function(){return Ue(this,!0)})},Hr=()=>{Mt(),Gt()},Vr={version:Lt,VERSION:Lr,atob:Me,atobPolyfill:Bt,btoa:Ve,btoaPolyfill:Ft,fromBase64:Ie,toBase64:oe,encode:oe,encodeURI:nt,encodeURL:nt,utob:Dt,btou:Nt,decode:Ie,isValid:qr,fromUint8Array:Ue,toUint8Array:qt,extendString:Mt,extendUint8Array:Gt,extendBuiltins:Hr};var Mr=function(t,r){if(r=r.split(":")[0],t=+t,!t)return!1;switch(r){case"http":case"ws":return t!==80;case"https":case"wss":return t!==443;case"ftp":return t!==21;case"gopher":return t!==70;case"file":return!1}return t!==0},Ge={},Gr=Object.prototype.hasOwnProperty,Kr;function ot(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch{return null}}function it(e){try{return encodeURIComponent(e)}catch{return null}}function Xr(e){for(var t=/([^=?#&]+)=?([^&]*)/g,r={},n;n=t.exec(e);){var o=ot(n[1]),i=ot(n[2]);o===null||i===null||o in r||(r[o]=i)}return r}function Yr(e,t){t=t||"";var r=[],n,o;typeof t!="string"&&(t="?");for(o in e)if(Gr.call(e,o)){if(n=e[o],!n&&(n===null||n===Kr||isNaN(n))&&(n=""),o=it(o),n=it(n),o===null||n===null)continue;r.push(o+"="+n)}return r.length?t+r.join("&"):""}Ge.stringify=Yr;Ge.parse=Xr;var Kt=Mr,Oe=Ge,Zr=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,Xt=/[\n\r\t]/g,Wr=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,Yt=/:\d+$/,Jr=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,Qr=/^[a-zA-Z]:/;function Ke(e){return(e||"").toString().replace(Zr,"")}var Ce=[["#","hash"],["?","query"],function(t,r){return V(r.protocol)?t.replace(/\\/g,"/"):t},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],at={hash:1,query:1};function Zt(e){var t;typeof window<"u"?t=window:typeof Ze<"u"?t=Ze:typeof self<"u"?t=self:t={};var r=t.location||{};e=e||r;var n={},o=typeof e,i;if(e.protocol==="blob:")n=new M(unescape(e.pathname),{});else if(o==="string"){n=new M(e,{});for(i in at)delete n[i]}else if(o==="object"){for(i in e)i in at||(n[i]=e[i]);n.slashes===void 0&&(n.slashes=Wr.test(e.href))}return n}function V(e){return e==="file:"||e==="ftp:"||e==="http:"||e==="https:"||e==="ws:"||e==="wss:"}function Wt(e,t){e=Ke(e),e=e.replace(Xt,""),t=t||{};var r=Jr.exec(e),n=r[1]?r[1].toLowerCase():"",o=!!r[2],i=!!r[3],s=0,f;return o?i?(f=r[2]+r[3]+r[4],s=r[2].length+r[3].length):(f=r[2]+r[4],s=r[2].length):i?(f=r[3]+r[4],s=r[3].length):f=r[4],n==="file:"?s>=2&&(f=f.slice(2)):V(n)?f=r[4]:n?o&&(f=f.slice(2)):s>=2&&V(t.protocol)&&(f=r[4]),{protocol:n,slashes:o||V(n),slashesCount:s,rest:f}}function en(e,t){if(e==="")return t;for(var r=(t||"/").split("/").slice(0,-1).concat(e.split("/")),n=r.length,o=r[n-1],i=!1,s=0;n--;)r[n]==="."?r.splice(n,1):r[n]===".."?(r.splice(n,1),s++):s&&(n===0&&(i=!0),r.splice(n,1),s--);return i&&r.unshift(""),(o==="."||o==="..")&&r.push(""),r.join("/")}function M(e,t,r){if(e=Ke(e),e=e.replace(Xt,""),!(this instanceof M))return new M(e,t,r);var n,o,i,s,f,c,v=Ce.slice(),m=typeof t,h=this,g=0;for(m!=="object"&&m!=="string"&&(r=t,t=null),r&&typeof r!="function"&&(r=Oe.parse),t=Zt(t),o=Wt(e||"",t),n=!o.protocol&&!o.slashes,h.slashes=o.slashes||n&&t.slashes,h.protocol=o.protocol||t.protocol||"",e=o.rest,(o.protocol==="file:"&&(o.slashesCount!==2||Qr.test(e))||!o.slashes&&(o.protocol||o.slashesCount<2||!V(h.protocol)))&&(v[3]=[/(.*)/,"pathname"]);g<v.length;g++){if(s=v[g],typeof s=="function"){e=s(e,h);continue}i=s[0],c=s[1],i!==i?h[c]=e:typeof i=="string"?(f=i==="@"?e.lastIndexOf(i):e.indexOf(i),~f&&(typeof s[2]=="number"?(h[c]=e.slice(0,f),e=e.slice(f+s[2])):(h[c]=e.slice(f),e=e.slice(0,f)))):(f=i.exec(e))&&(h[c]=f[1],e=e.slice(0,f.index)),h[c]=h[c]||n&&s[3]&&t[c]||"",s[4]&&(h[c]=h[c].toLowerCase())}r&&(h.query=r(h.query)),n&&t.slashes&&h.pathname.charAt(0)!=="/"&&(h.pathname!==""||t.pathname!=="")&&(h.pathname=en(h.pathname,t.pathname)),h.pathname.charAt(0)!=="/"&&V(h.protocol)&&(h.pathname="/"+h.pathname),Kt(h.port,h.protocol)||(h.host=h.hostname,h.port=""),h.username=h.password="",h.auth&&(f=h.auth.indexOf(":"),~f?(h.username=h.auth.slice(0,f),h.username=encodeURIComponent(decodeURIComponent(h.username)),h.password=h.auth.slice(f+1),h.password=encodeURIComponent(decodeURIComponent(h.password))):h.username=encodeURIComponent(decodeURIComponent(h.auth)),h.auth=h.password?h.username+":"+h.password:h.username),h.origin=h.protocol!=="file:"&&V(h.protocol)&&h.host?h.protocol+"//"+h.host:"null",h.href=h.toString()}function tn(e,t,r){var n=this;switch(e){case"query":typeof t=="string"&&t.length&&(t=(r||Oe.parse)(t)),n[e]=t;break;case"port":n[e]=t,Kt(t,n.protocol)?t&&(n.host=n.hostname+":"+t):(n.host=n.hostname,n[e]="");break;case"hostname":n[e]=t,n.port&&(t+=":"+n.port),n.host=t;break;case"host":n[e]=t,Yt.test(t)?(t=t.split(":"),n.port=t.pop(),n.hostname=t.join(":")):(n.hostname=t,n.port="");break;case"protocol":n.protocol=t.toLowerCase(),n.slashes=!r;break;case"pathname":case"hash":if(t){var o=e==="pathname"?"/":"#";n[e]=t.charAt(0)!==o?o+t:t}else n[e]=t;break;case"username":case"password":n[e]=encodeURIComponent(t);break;case"auth":var i=t.indexOf(":");~i?(n.username=t.slice(0,i),n.username=encodeURIComponent(decodeURIComponent(n.username)),n.password=t.slice(i+1),n.password=encodeURIComponent(decodeURIComponent(n.password))):n.username=encodeURIComponent(decodeURIComponent(t))}for(var s=0;s<Ce.length;s++){var f=Ce[s];f[4]&&(n[f[1]]=n[f[1]].toLowerCase())}return n.auth=n.password?n.username+":"+n.password:n.username,n.origin=n.protocol!=="file:"&&V(n.protocol)&&n.host?n.protocol+"//"+n.host:"null",n.href=n.toString(),n}function rn(e){(!e||typeof e!="function")&&(e=Oe.stringify);var t,r=this,n=r.host,o=r.protocol;o&&o.charAt(o.length-1)!==":"&&(o+=":");var i=o+(r.protocol&&r.slashes||V(r.protocol)?"//":"");return r.username?(i+=r.username,r.password&&(i+=":"+r.password),i+="@"):r.password?(i+=":"+r.password,i+="@"):r.protocol!=="file:"&&V(r.protocol)&&!n&&r.pathname!=="/"&&(i+="@"),(n[n.length-1]===":"||Yt.test(r.hostname)&&!r.port)&&(n+=":"),i+=n+r.pathname,t=typeof r.query=="object"?e(r.query):r.query,t&&(i+=t.charAt(0)!=="?"?"?"+t:t),r.hash&&(i+=r.hash),i}M.prototype={set:tn,toString:rn};M.extractProtocol=Wt;M.location=Zt;M.trimLeft=Ke;M.qs=Oe;var nn=M;const on=ur(nn);function an(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=Math.random()*16|0,r=e==="x"?t:t&3|8;return r.toString(16)})}function Fe(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Fe=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(l,a,u){l[a]=u.value},i=typeof Symbol=="function"?Symbol:{},s=i.iterator||"@@iterator",f=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function v(l,a,u){return Object.defineProperty(l,a,{value:u,enumerable:!0,configurable:!0,writable:!0}),l[a]}try{v({},"")}catch{v=function(u,p,y){return u[p]=y}}function m(l,a,u,p){var y=a&&a.prototype instanceof L?a:L,d=Object.create(y.prototype),_=new Z(p||[]);return o(d,"_invoke",{value:ke(l,u,_)}),d}function h(l,a,u){try{return{type:"normal",arg:l.call(a,u)}}catch(p){return{type:"throw",arg:p}}}t.wrap=m;var g="suspendedStart",j="suspendedYield",P="executing",k="completed",b={};function L(){}function R(){}function w(){}var E={};v(E,s,function(){return this});var U=Object.getPrototypeOf,I=U&&U(U(W([])));I&&I!==r&&n.call(I,s)&&(E=I);var C=w.prototype=L.prototype=Object.create(E);function X(l){["next","throw","return"].forEach(function(a){v(l,a,function(u){return this._invoke(a,u)})})}function B(l,a){function u(y,d,_,S){var x=h(l[y],l,d);if(x.type!=="throw"){var F=x.arg,$=F.value;return $&&Q($)=="object"&&n.call($,"__await")?a.resolve($.__await).then(function(D){u("next",D,_,S)},function(D){u("throw",D,_,S)}):a.resolve($).then(function(D){F.value=D,_(F)},function(D){return u("throw",D,_,S)})}S(x.arg)}var p;o(this,"_invoke",{value:function(d,_){function S(){return new a(function(x,F){u(d,_,x,F)})}return p=p?p.then(S,S):S()}})}function ke(l,a,u){var p=g;return function(y,d){if(p===P)throw Error("Generator is already running");if(p===k){if(y==="throw")throw d;return{value:e,done:!0}}for(u.method=y,u.arg=d;;){var _=u.delegate;if(_){var S=le(_,u);if(S){if(S===b)continue;return S}}if(u.method==="next")u.sent=u._sent=u.arg;else if(u.method==="throw"){if(p===g)throw p=k,u.arg;u.dispatchException(u.arg)}else u.method==="return"&&u.abrupt("return",u.arg);p=P;var x=h(l,a,u);if(x.type==="normal"){if(p=u.done?k:j,x.arg===b)continue;return{value:x.arg,done:u.done}}x.type==="throw"&&(p=k,u.method="throw",u.arg=x.arg)}}}function le(l,a){var u=a.method,p=l.iterator[u];if(p===e)return a.delegate=null,u==="throw"&&l.iterator.return&&(a.method="return",a.arg=e,le(l,a),a.method==="throw")||u!=="return"&&(a.method="throw",a.arg=new TypeError("The iterator does not provide a '"+u+"' method")),b;var y=h(p,l.iterator,a.arg);if(y.type==="throw")return a.method="throw",a.arg=y.arg,a.delegate=null,b;var d=y.arg;return d?d.done?(a[l.resultName]=d.value,a.next=l.nextLoc,a.method!=="return"&&(a.method="next",a.arg=e),a.delegate=null,b):d:(a.method="throw",a.arg=new TypeError("iterator result is not an object"),a.delegate=null,b)}function Re(l){var a={tryLoc:l[0]};1 in l&&(a.catchLoc=l[1]),2 in l&&(a.finallyLoc=l[2],a.afterLoc=l[3]),this.tryEntries.push(a)}function Y(l){var a=l.completion||{};a.type="normal",delete a.arg,l.completion=a}function Z(l){this.tryEntries=[{tryLoc:"root"}],l.forEach(Re,this),this.reset(!0)}function W(l){if(l||l===""){var a=l[s];if(a)return a.call(l);if(typeof l.next=="function")return l;if(!isNaN(l.length)){var u=-1,p=function y(){for(;++u<l.length;)if(n.call(l,u))return y.value=l[u],y.done=!1,y;return y.value=e,y.done=!0,y};return p.next=p}}throw new TypeError(Q(l)+" is not iterable")}return R.prototype=w,o(C,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:R,configurable:!0}),R.displayName=v(w,c,"GeneratorFunction"),t.isGeneratorFunction=function(l){var a=typeof l=="function"&&l.constructor;return!!a&&(a===R||(a.displayName||a.name)==="GeneratorFunction")},t.mark=function(l){return Object.setPrototypeOf?Object.setPrototypeOf(l,w):(l.__proto__=w,v(l,c,"GeneratorFunction")),l.prototype=Object.create(C),l},t.awrap=function(l){return{__await:l}},X(B.prototype),v(B.prototype,f,function(){return this}),t.AsyncIterator=B,t.async=function(l,a,u,p,y){y===void 0&&(y=Promise);var d=new B(m(l,a,u,p),y);return t.isGeneratorFunction(a)?d:d.next().then(function(_){return _.done?_.value:d.next()})},X(C),v(C,c,"Generator"),v(C,s,function(){return this}),v(C,"toString",function(){return"[object Generator]"}),t.keys=function(l){var a=Object(l),u=[];for(var p in a)u.push(p);return u.reverse(),function y(){for(;u.length;){var d=u.pop();if(d in a)return y.value=d,y.done=!1,y}return y.done=!0,y}},t.values=W,Z.prototype={constructor:Z,reset:function(a){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(Y),!a)for(var u in this)u.charAt(0)==="t"&&n.call(this,u)&&!isNaN(+u.slice(1))&&(this[u]=e)},stop:function(){this.done=!0;var a=this.tryEntries[0].completion;if(a.type==="throw")throw a.arg;return this.rval},dispatchException:function(a){if(this.done)throw a;var u=this;function p(F,$){return _.type="throw",_.arg=a,u.next=F,$&&(u.method="next",u.arg=e),!!$}for(var y=this.tryEntries.length-1;y>=0;--y){var d=this.tryEntries[y],_=d.completion;if(d.tryLoc==="root")return p("end");if(d.tryLoc<=this.prev){var S=n.call(d,"catchLoc"),x=n.call(d,"finallyLoc");if(S&&x){if(this.prev<d.catchLoc)return p(d.catchLoc,!0);if(this.prev<d.finallyLoc)return p(d.finallyLoc)}else if(S){if(this.prev<d.catchLoc)return p(d.catchLoc,!0)}else{if(!x)throw Error("try statement without catch or finally");if(this.prev<d.finallyLoc)return p(d.finallyLoc)}}}},abrupt:function(a,u){for(var p=this.tryEntries.length-1;p>=0;--p){var y=this.tryEntries[p];if(y.tryLoc<=this.prev&&n.call(y,"finallyLoc")&&this.prev<y.finallyLoc){var d=y;break}}d&&(a==="break"||a==="continue")&&d.tryLoc<=u&&u<=d.finallyLoc&&(d=null);var _=d?d.completion:{};return _.type=a,_.arg=u,d?(this.method="next",this.next=d.finallyLoc,b):this.complete(_)},complete:function(a,u){if(a.type==="throw")throw a.arg;return a.type==="break"||a.type==="continue"?this.next=a.arg:a.type==="return"?(this.rval=this.arg=a.arg,this.method="return",this.next="end"):a.type==="normal"&&u&&(this.next=u),b},finish:function(a){for(var u=this.tryEntries.length-1;u>=0;--u){var p=this.tryEntries[u];if(p.finallyLoc===a)return this.complete(p.completion,p.afterLoc),Y(p),b}},catch:function(a){for(var u=this.tryEntries.length-1;u>=0;--u){var p=this.tryEntries[u];if(p.tryLoc===a){var y=p.completion;if(y.type==="throw"){var d=y.arg;Y(p)}return d}}throw Error("illegal catch attempt")},delegateYield:function(a,u,p){return this.delegate={iterator:W(a),resultName:u,nextLoc:p},this.method==="next"&&(this.arg=e),b}},t}function ut(e,t,r,n,o,i,s){try{var f=e[i](s),c=f.value}catch(v){r(v);return}f.done?t(c):Promise.resolve(c).then(n,o)}function un(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function s(c){ut(i,n,o,s,f,"next",c)}function f(c){ut(i,n,o,s,f,"throw",c)}s(void 0)})}}function Jt(e,t){return fn(e)||sn(e,t)||Qt(e,t)||ln()}function ln(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sn(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,s,f=[],c=!0,v=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(f.push(n.value),f.length!==t);c=!0);}catch(m){v=!0,o=m}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(v)throw o}}return f}}function fn(e){if(Array.isArray(e))return e}function Q(e){"@babel/helpers - typeof";return Q=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Q(e)}function cn(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=Qt(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(v){throw v},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,f;return{s:function(){r=r.call(e)},n:function(){var v=r.next();return i=v.done,v},e:function(v){s=!0,f=v},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw f}}}}function Qt(e,t){if(e){if(typeof e=="string")return lt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lt(e,t)}}function lt(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function st(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function te(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?st(Object(r),!0).forEach(function(n){pn(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):st(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pn(e,t,r){return t=er(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ft(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,er(n.key),n)}}function hn(e,t,r){return t&&ft(e.prototype,t),r&&ft(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function er(e){var t=yn(e,"string");return Q(t)=="symbol"?t:t+""}function yn(e,t){if(Q(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Q(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var De="tus-v1",Se="ietf-draft-03",vn={endpoint:null,uploadUrl:null,metadata:{},metadataForPartialUploads:{},fingerprint:null,uploadSize:null,onProgress:null,onChunkComplete:null,onSuccess:null,onError:null,onUploadUrlAvailable:null,overridePatchMethod:!1,headers:{},addRequestId:!1,onBeforeRequest:null,onAfterResponse:null,onShouldRetry:tr,chunkSize:Number.POSITIVE_INFINITY,retryDelays:[0,1e3,3e3,5e3],parallelUploads:1,parallelUploadBoundaries:null,storeFingerprintForResuming:!0,removeFingerprintOnSuccess:!1,uploadLengthDeferred:!1,uploadDataDuringCreation:!1,urlStorage:null,fileReader:null,httpStack:null,protocol:De},xe=function(){function e(t,r){dn(this,e),"resume"in r&&console.log("tus: The `resume` option has been removed in tus-js-client v2. Please use the URL storage API instead."),this.options=r,this.options.chunkSize=Number(this.options.chunkSize),this._urlStorage=this.options.urlStorage,this.file=t,this.url=null,this._req=null,this._fingerprint=null,this._urlStorageKey=null,this._offset=null,this._aborted=!1,this._size=null,this._source=null,this._retryAttempt=0,this._retryTimeout=null,this._offsetBeforeRetry=0,this._parallelUploads=null,this._parallelUploadUrls=null}return hn(e,[{key:"findPreviousUploads",value:function(){var r=this;return this.options.fingerprint(this.file,this.options).then(function(n){return r._urlStorage.findUploadsByFingerprint(n)})}},{key:"resumeFromPreviousUpload",value:function(r){this.url=r.uploadUrl||null,this._parallelUploadUrls=r.parallelUploadUrls||null,this._urlStorageKey=r.urlStorageKey}},{key:"start",value:function(){var r=this,n=this.file;if(!n){this._emitError(new Error("tus: no file or stream to upload provided"));return}if(![De,Se].includes(this.options.protocol)){this._emitError(new Error("tus: unsupported protocol ".concat(this.options.protocol)));return}if(!this.options.endpoint&&!this.options.uploadUrl&&!this.url){this._emitError(new Error("tus: neither an endpoint or an upload URL is provided"));return}var o=this.options.retryDelays;if(o!=null&&Object.prototype.toString.call(o)!=="[object Array]"){this._emitError(new Error("tus: the `retryDelays` option must either be an array or null"));return}if(this.options.parallelUploads>1)for(var i=0,s=["uploadUrl","uploadSize","uploadLengthDeferred"];i<s.length;i++){var f=s[i];if(this.options[f]){this._emitError(new Error("tus: cannot use the ".concat(f," option when parallelUploads is enabled")));return}}if(this.options.parallelUploadBoundaries){if(this.options.parallelUploads<=1){this._emitError(new Error("tus: cannot use the `parallelUploadBoundaries` option when `parallelUploads` is disabled"));return}if(this.options.parallelUploads!==this.options.parallelUploadBoundaries.length){this._emitError(new Error("tus: the `parallelUploadBoundaries` must have the same length as the value of `parallelUploads`"));return}}this.options.fingerprint(n,this.options).then(function(c){return r._fingerprint=c,r._source?r._source:r.options.fileReader.openFile(n,r.options.chunkSize)}).then(function(c){if(r._source=c,r.options.uploadLengthDeferred)r._size=null;else if(r.options.uploadSize!=null){if(r._size=Number(r.options.uploadSize),Number.isNaN(r._size)){r._emitError(new Error("tus: cannot convert `uploadSize` option into a number"));return}}else if(r._size=r._source.size,r._size==null){r._emitError(new Error("tus: cannot automatically derive upload's size from input. Specify it manually using the `uploadSize` option or use the `uploadLengthDeferred` option"));return}r.options.parallelUploads>1||r._parallelUploadUrls!=null?r._startParallelUpload():r._startSingleUpload()}).catch(function(c){r._emitError(c)})}},{key:"_startParallelUpload",value:function(){var r,n=this,o=this._size,i=0;this._parallelUploads=[];var s=this._parallelUploadUrls!=null?this._parallelUploadUrls.length:this.options.parallelUploads,f=(r=this.options.parallelUploadBoundaries)!==null&&r!==void 0?r:_n(this._source.size,s);this._parallelUploadUrls&&f.forEach(function(m,h){m.uploadUrl=n._parallelUploadUrls[h]||null}),this._parallelUploadUrls=new Array(f.length);var c=f.map(function(m,h){var g=0;return n._source.slice(m.start,m.end).then(function(j){var P=j.value;return new Promise(function(k,b){var L=te(te({},n.options),{},{uploadUrl:m.uploadUrl||null,storeFingerprintForResuming:!1,removeFingerprintOnSuccess:!1,parallelUploads:1,parallelUploadBoundaries:null,metadata:n.options.metadataForPartialUploads,headers:te(te({},n.options.headers),{},{"Upload-Concat":"partial"}),onSuccess:k,onError:b,onProgress:function(E){i=i-g+E,g=E,n._emitProgress(i,o)},onUploadUrlAvailable:function(){n._parallelUploadUrls[h]=R.url,n._parallelUploadUrls.filter(function(E){return!!E}).length===f.length&&n._saveUploadInUrlStorage()}}),R=new e(P,L);R.start(),n._parallelUploads.push(R)})})}),v;Promise.all(c).then(function(){v=n._openRequest("POST",n.options.endpoint),v.setHeader("Upload-Concat","final;".concat(n._parallelUploadUrls.join(" ")));var m=ct(n.options.metadata);return m!==""&&v.setHeader("Upload-Metadata",m),n._sendRequest(v,null)}).then(function(m){if(!re(m.getStatus(),200)){n._emitHttpError(v,m,"tus: unexpected response while creating upload");return}var h=m.getHeader("Location");if(h==null){n._emitHttpError(v,m,"tus: invalid or missing Location header");return}n.url=yt(n.options.endpoint,h),"Created upload at ".concat(n.url),n._emitSuccess(m)}).catch(function(m){n._emitError(m)})}},{key:"_startSingleUpload",value:function(){if(this._aborted=!1,this.url!=null){"Resuming upload from previous URL: ".concat(this.url),this._resumeUpload();return}if(this.options.uploadUrl!=null){"Resuming upload from provided URL: ".concat(this.options.uploadUrl),this.url=this.options.uploadUrl,this._resumeUpload();return}this._createUpload()}},{key:"abort",value:function(r){var n=this;if(this._parallelUploads!=null){var o=cn(this._parallelUploads),i;try{for(o.s();!(i=o.n()).done;){var s=i.value;s.abort(r)}}catch(f){o.e(f)}finally{o.f()}}return this._req!==null&&this._req.abort(),this._aborted=!0,this._retryTimeout!=null&&(clearTimeout(this._retryTimeout),this._retryTimeout=null),!r||this.url==null?Promise.resolve():e.terminate(this.url,this.options).then(function(){return n._removeFromUrlStorage()})}},{key:"_emitHttpError",value:function(r,n,o,i){this._emitError(new ge(o,i,r,n))}},{key:"_emitError",value:function(r){var n=this;if(!this._aborted){if(this.options.retryDelays!=null){var o=this._offset!=null&&this._offset>this._offsetBeforeRetry;if(o&&(this._retryAttempt=0),ht(r,this._retryAttempt,this.options)){var i=this.options.retryDelays[this._retryAttempt++];this._offsetBeforeRetry=this._offset,this._retryTimeout=setTimeout(function(){n.start()},i);return}}if(typeof this.options.onError=="function")this.options.onError(r);else throw r}}},{key:"_emitSuccess",value:function(r){this.options.removeFingerprintOnSuccess&&this._removeFromUrlStorage(),typeof this.options.onSuccess=="function"&&this.options.onSuccess({lastResponse:r})}},{key:"_emitProgress",value:function(r,n){typeof this.options.onProgress=="function"&&this.options.onProgress(r,n)}},{key:"_emitChunkComplete",value:function(r,n,o){typeof this.options.onChunkComplete=="function"&&this.options.onChunkComplete(r,n,o)}},{key:"_createUpload",value:function(){var r=this;if(!this.options.endpoint){this._emitError(new Error("tus: unable to create upload because no endpoint is provided"));return}var n=this._openRequest("POST",this.options.endpoint);this.options.uploadLengthDeferred?n.setHeader("Upload-Defer-Length","1"):n.setHeader("Upload-Length","".concat(this._size));var o=ct(this.options.metadata);o!==""&&n.setHeader("Upload-Metadata",o);var i;this.options.uploadDataDuringCreation&&!this.options.uploadLengthDeferred?(this._offset=0,i=this._addChunkToRequest(n)):(this.options.protocol===Se&&n.setHeader("Upload-Complete","?0"),i=this._sendRequest(n,null)),i.then(function(s){if(!re(s.getStatus(),200)){r._emitHttpError(n,s,"tus: unexpected response while creating upload");return}var f=s.getHeader("Location");if(f==null){r._emitHttpError(n,s,"tus: invalid or missing Location header");return}if(r.url=yt(r.options.endpoint,f),"Created upload at ".concat(r.url),typeof r.options.onUploadUrlAvailable=="function"&&r.options.onUploadUrlAvailable(),r._size===0){r._emitSuccess(s),r._source.close();return}r._saveUploadInUrlStorage().then(function(){r.options.uploadDataDuringCreation?r._handleUploadResponse(n,s):(r._offset=0,r._performUpload())})}).catch(function(s){r._emitHttpError(n,null,"tus: failed to create upload",s)})}},{key:"_resumeUpload",value:function(){var r=this,n=this._openRequest("HEAD",this.url),o=this._sendRequest(n,null);o.then(function(i){var s=i.getStatus();if(!re(s,200)){if(s===423){r._emitHttpError(n,i,"tus: upload is currently locked; retry later");return}if(re(s,400)&&r._removeFromUrlStorage(),!r.options.endpoint){r._emitHttpError(n,i,"tus: unable to resume upload (new upload cannot be created without an endpoint)");return}r.url=null,r._createUpload();return}var f=Number.parseInt(i.getHeader("Upload-Offset"),10);if(Number.isNaN(f)){r._emitHttpError(n,i,"tus: invalid or missing offset value");return}var c=Number.parseInt(i.getHeader("Upload-Length"),10);if(Number.isNaN(c)&&!r.options.uploadLengthDeferred&&r.options.protocol===De){r._emitHttpError(n,i,"tus: invalid or missing length value");return}typeof r.options.onUploadUrlAvailable=="function"&&r.options.onUploadUrlAvailable(),r._saveUploadInUrlStorage().then(function(){if(f===c){r._emitProgress(c,c),r._emitSuccess(i);return}r._offset=f,r._performUpload()})}).catch(function(i){r._emitHttpError(n,null,"tus: failed to resume upload",i)})}},{key:"_performUpload",value:function(){var r=this;if(!this._aborted){var n;this.options.overridePatchMethod?(n=this._openRequest("POST",this.url),n.setHeader("X-HTTP-Method-Override","PATCH")):n=this._openRequest("PATCH",this.url),n.setHeader("Upload-Offset","".concat(this._offset));var o=this._addChunkToRequest(n);o.then(function(i){if(!re(i.getStatus(),200)){r._emitHttpError(n,i,"tus: unexpected response while uploading chunk");return}r._handleUploadResponse(n,i)}).catch(function(i){r._aborted||r._emitHttpError(n,null,"tus: failed to upload chunk at offset ".concat(r._offset),i)})}}},{key:"_addChunkToRequest",value:function(r){var n=this,o=this._offset,i=this._offset+this.options.chunkSize;return r.setProgressHandler(function(s){n._emitProgress(o+s,n._size)}),r.setHeader("Content-Type","application/offset+octet-stream"),(i===Number.POSITIVE_INFINITY||i>this._size)&&!this.options.uploadLengthDeferred&&(i=this._size),this._source.slice(o,i).then(function(s){var f=s.value,c=s.done,v=f!=null&&f.size?f.size:0;n.options.uploadLengthDeferred&&c&&(n._size=n._offset+v,r.setHeader("Upload-Length","".concat(n._size)));var m=n._offset+v;return!n.options.uploadLengthDeferred&&c&&m!==n._size?Promise.reject(new Error("upload was configured with a size of ".concat(n._size," bytes, but the source is done after ").concat(m," bytes"))):f===null?n._sendRequest(r):(n.options.protocol===Se&&r.setHeader("Upload-Complete",c?"?1":"?0"),n._emitProgress(n._offset,n._size),n._sendRequest(r,f))})}},{key:"_handleUploadResponse",value:function(r,n){var o=Number.parseInt(n.getHeader("Upload-Offset"),10);if(Number.isNaN(o)){this._emitHttpError(r,n,"tus: invalid or missing offset value");return}if(this._emitProgress(o,this._size),this._emitChunkComplete(o-this._offset,o,this._size),this._offset=o,o===this._size){this._emitSuccess(n),this._source.close();return}this._performUpload()}},{key:"_openRequest",value:function(r,n){var o=pt(r,n,this.options);return this._req=o,o}},{key:"_removeFromUrlStorage",value:function(){var r=this;this._urlStorageKey&&(this._urlStorage.removeUpload(this._urlStorageKey).catch(function(n){r._emitError(n)}),this._urlStorageKey=null)}},{key:"_saveUploadInUrlStorage",value:function(){var r=this;if(!this.options.storeFingerprintForResuming||!this._fingerprint||this._urlStorageKey!==null)return Promise.resolve();var n={size:this._size,metadata:this.options.metadata,creationTime:new Date().toString()};return this._parallelUploads?n.parallelUploadUrls=this._parallelUploadUrls:n.uploadUrl=this.url,this._urlStorage.addUpload(this._fingerprint,n).then(function(o){r._urlStorageKey=o})}},{key:"_sendRequest",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return dt(r,n,this.options)}}],[{key:"terminate",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=pt("DELETE",r,n);return dt(o,null,n).then(function(i){if(i.getStatus()!==204)throw new ge("tus: unexpected response while terminating upload",null,o,i)}).catch(function(i){if(i instanceof ge||(i=new ge("tus: failed to terminate upload",i,o,null)),!ht(i,0,n))throw i;var s=n.retryDelays[0],f=n.retryDelays.slice(1),c=te(te({},n),{},{retryDelays:f});return new Promise(function(v){return setTimeout(v,s)}).then(function(){return e.terminate(r,c)})})}}])}();function ct(e){return Object.entries(e).map(function(t){var r=Jt(t,2),n=r[0],o=r[1];return"".concat(n," ").concat(Vr.encode(String(o)))}).join(",")}function re(e,t){return e>=t&&e<t+100}function pt(e,t,r){var n=r.httpStack.createRequest(e,t);r.protocol===Se?n.setHeader("Upload-Draft-Interop-Version","5"):n.setHeader("Tus-Resumable","1.0.0");for(var o=r.headers||{},i=0,s=Object.entries(o);i<s.length;i++){var f=Jt(s[i],2),c=f[0],v=f[1];n.setHeader(c,v)}if(r.addRequestId){var m=an();n.setHeader("X-Request-ID",m)}return n}function dt(e,t,r){return Ne.apply(this,arguments)}function Ne(){return Ne=un(Fe().mark(function e(t,r,n){var o;return Fe().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(typeof n.onBeforeRequest!="function"){s.next=3;break}return s.next=3,n.onBeforeRequest(t);case 3:return s.next=5,t.send(r);case 5:if(o=s.sent,typeof n.onAfterResponse!="function"){s.next=9;break}return s.next=9,n.onAfterResponse(t,o);case 9:return s.abrupt("return",o);case 10:case"end":return s.stop()}},e)})),Ne.apply(this,arguments)}function mn(){var e=!0;return typeof navigator<"u"&&navigator.onLine===!1&&(e=!1),e}function ht(e,t,r){return r.retryDelays==null||t>=r.retryDelays.length||e.originalRequest==null?!1:r&&typeof r.onShouldRetry=="function"?r.onShouldRetry(e,t,r):tr(e)}function tr(e){var t=e.originalResponse?e.originalResponse.getStatus():0;return(!re(t,400)||t===409||t===423)&&mn()}function yt(e,t){return new on(t,e).toString()}function _n(e,t){for(var r=Math.floor(e/t),n=[],o=0;o<t;o++)n.push({start:r*o,end:r*(o+1)});return n[t-1].end=e,n}xe.defaultOptions=vn;var rr=function(){return typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative"};function gn(e){return new Promise(function(t,r){var n=new XMLHttpRequest;n.responseType="blob",n.onload=function(){var o=n.response;t(o)},n.onerror=function(o){r(o)},n.open("GET",e),n.send()})}var bn=function(){return typeof window<"u"&&(typeof window.PhoneGap<"u"||typeof window.Cordova<"u"||typeof window.cordova<"u")};function wn(e){return new Promise(function(t,r){var n=new FileReader;n.onload=function(){var o=new Uint8Array(n.result);t({value:o})},n.onerror=function(o){r(o)},n.readAsArrayBuffer(e)})}function he(e){"@babel/helpers - typeof";return he=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},he(e)}function Un(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xn(n.key),n)}}function Sn(e,t,r){return t&&vt(e.prototype,t),r&&vt(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xn(e){var t=Pn(e,"string");return he(t)=="symbol"?t:t+""}function Pn(e,t){if(he(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(he(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mt=function(){function e(t){Un(this,e),this._file=t,this.size=t.size}return Sn(e,[{key:"slice",value:function(r,n){if(bn())return wn(this._file.slice(r,n));var o=this._file.slice(r,n),i=n>=this.size;return Promise.resolve({value:o,done:i})}},{key:"close",value:function(){}}])}();function ye(e){"@babel/helpers - typeof";return ye=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ye(e)}function En(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _t(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kn(n.key),n)}}function On(e,t,r){return t&&_t(e.prototype,t),r&&_t(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kn(e){var t=Rn(e,"string");return ye(t)=="symbol"?t:t+""}function Rn(e,t){if(ye(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ye(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gt(e){return e===void 0?0:e.size!==void 0?e.size:e.length}function jn(e,t){if(e.concat)return e.concat(t);if(e instanceof Blob)return new Blob([e,t],{type:e.type});if(e.set){var r=new e.constructor(e.length+t.length);return r.set(e),r.set(t,e.length),r}throw new Error("Unknown data type")}var $n=function(){function e(t){En(this,e),this._buffer=void 0,this._bufferOffset=0,this._reader=t,this._done=!1}return On(e,[{key:"slice",value:function(r,n){return r<this._bufferOffset?Promise.reject(new Error("Requested data is before the reader's current offset")):this._readUntilEnoughDataOrDone(r,n)}},{key:"_readUntilEnoughDataOrDone",value:function(r,n){var o=this,i=n<=this._bufferOffset+gt(this._buffer);if(this._done||i){var s=this._getDataFromBuffer(r,n),f=s==null?this._done:!1;return Promise.resolve({value:s,done:f})}return this._reader.read().then(function(c){var v=c.value,m=c.done;return m?o._done=!0:o._buffer===void 0?o._buffer=v:o._buffer=jn(o._buffer,v),o._readUntilEnoughDataOrDone(r,n)})}},{key:"_getDataFromBuffer",value:function(r,n){r>this._bufferOffset&&(this._buffer=this._buffer.slice(r-this._bufferOffset),this._bufferOffset=r);var o=gt(this._buffer)===0;return this._done&&o?null:this._buffer.slice(0,n-r)}},{key:"close",value:function(){this._reader.cancel&&this._reader.cancel()}}])}();function ee(e){"@babel/helpers - typeof";return ee=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ee(e)}function Be(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Be=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(l,a,u){l[a]=u.value},i=typeof Symbol=="function"?Symbol:{},s=i.iterator||"@@iterator",f=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function v(l,a,u){return Object.defineProperty(l,a,{value:u,enumerable:!0,configurable:!0,writable:!0}),l[a]}try{v({},"")}catch{v=function(u,p,y){return u[p]=y}}function m(l,a,u,p){var y=a&&a.prototype instanceof L?a:L,d=Object.create(y.prototype),_=new Z(p||[]);return o(d,"_invoke",{value:ke(l,u,_)}),d}function h(l,a,u){try{return{type:"normal",arg:l.call(a,u)}}catch(p){return{type:"throw",arg:p}}}t.wrap=m;var g="suspendedStart",j="suspendedYield",P="executing",k="completed",b={};function L(){}function R(){}function w(){}var E={};v(E,s,function(){return this});var U=Object.getPrototypeOf,I=U&&U(U(W([])));I&&I!==r&&n.call(I,s)&&(E=I);var C=w.prototype=L.prototype=Object.create(E);function X(l){["next","throw","return"].forEach(function(a){v(l,a,function(u){return this._invoke(a,u)})})}function B(l,a){function u(y,d,_,S){var x=h(l[y],l,d);if(x.type!=="throw"){var F=x.arg,$=F.value;return $&&ee($)=="object"&&n.call($,"__await")?a.resolve($.__await).then(function(D){u("next",D,_,S)},function(D){u("throw",D,_,S)}):a.resolve($).then(function(D){F.value=D,_(F)},function(D){return u("throw",D,_,S)})}S(x.arg)}var p;o(this,"_invoke",{value:function(d,_){function S(){return new a(function(x,F){u(d,_,x,F)})}return p=p?p.then(S,S):S()}})}function ke(l,a,u){var p=g;return function(y,d){if(p===P)throw Error("Generator is already running");if(p===k){if(y==="throw")throw d;return{value:e,done:!0}}for(u.method=y,u.arg=d;;){var _=u.delegate;if(_){var S=le(_,u);if(S){if(S===b)continue;return S}}if(u.method==="next")u.sent=u._sent=u.arg;else if(u.method==="throw"){if(p===g)throw p=k,u.arg;u.dispatchException(u.arg)}else u.method==="return"&&u.abrupt("return",u.arg);p=P;var x=h(l,a,u);if(x.type==="normal"){if(p=u.done?k:j,x.arg===b)continue;return{value:x.arg,done:u.done}}x.type==="throw"&&(p=k,u.method="throw",u.arg=x.arg)}}}function le(l,a){var u=a.method,p=l.iterator[u];if(p===e)return a.delegate=null,u==="throw"&&l.iterator.return&&(a.method="return",a.arg=e,le(l,a),a.method==="throw")||u!=="return"&&(a.method="throw",a.arg=new TypeError("The iterator does not provide a '"+u+"' method")),b;var y=h(p,l.iterator,a.arg);if(y.type==="throw")return a.method="throw",a.arg=y.arg,a.delegate=null,b;var d=y.arg;return d?d.done?(a[l.resultName]=d.value,a.next=l.nextLoc,a.method!=="return"&&(a.method="next",a.arg=e),a.delegate=null,b):d:(a.method="throw",a.arg=new TypeError("iterator result is not an object"),a.delegate=null,b)}function Re(l){var a={tryLoc:l[0]};1 in l&&(a.catchLoc=l[1]),2 in l&&(a.finallyLoc=l[2],a.afterLoc=l[3]),this.tryEntries.push(a)}function Y(l){var a=l.completion||{};a.type="normal",delete a.arg,l.completion=a}function Z(l){this.tryEntries=[{tryLoc:"root"}],l.forEach(Re,this),this.reset(!0)}function W(l){if(l||l===""){var a=l[s];if(a)return a.call(l);if(typeof l.next=="function")return l;if(!isNaN(l.length)){var u=-1,p=function y(){for(;++u<l.length;)if(n.call(l,u))return y.value=l[u],y.done=!1,y;return y.value=e,y.done=!0,y};return p.next=p}}throw new TypeError(ee(l)+" is not iterable")}return R.prototype=w,o(C,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:R,configurable:!0}),R.displayName=v(w,c,"GeneratorFunction"),t.isGeneratorFunction=function(l){var a=typeof l=="function"&&l.constructor;return!!a&&(a===R||(a.displayName||a.name)==="GeneratorFunction")},t.mark=function(l){return Object.setPrototypeOf?Object.setPrototypeOf(l,w):(l.__proto__=w,v(l,c,"GeneratorFunction")),l.prototype=Object.create(C),l},t.awrap=function(l){return{__await:l}},X(B.prototype),v(B.prototype,f,function(){return this}),t.AsyncIterator=B,t.async=function(l,a,u,p,y){y===void 0&&(y=Promise);var d=new B(m(l,a,u,p),y);return t.isGeneratorFunction(a)?d:d.next().then(function(_){return _.done?_.value:d.next()})},X(C),v(C,c,"Generator"),v(C,s,function(){return this}),v(C,"toString",function(){return"[object Generator]"}),t.keys=function(l){var a=Object(l),u=[];for(var p in a)u.push(p);return u.reverse(),function y(){for(;u.length;){var d=u.pop();if(d in a)return y.value=d,y.done=!1,y}return y.done=!0,y}},t.values=W,Z.prototype={constructor:Z,reset:function(a){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(Y),!a)for(var u in this)u.charAt(0)==="t"&&n.call(this,u)&&!isNaN(+u.slice(1))&&(this[u]=e)},stop:function(){this.done=!0;var a=this.tryEntries[0].completion;if(a.type==="throw")throw a.arg;return this.rval},dispatchException:function(a){if(this.done)throw a;var u=this;function p(F,$){return _.type="throw",_.arg=a,u.next=F,$&&(u.method="next",u.arg=e),!!$}for(var y=this.tryEntries.length-1;y>=0;--y){var d=this.tryEntries[y],_=d.completion;if(d.tryLoc==="root")return p("end");if(d.tryLoc<=this.prev){var S=n.call(d,"catchLoc"),x=n.call(d,"finallyLoc");if(S&&x){if(this.prev<d.catchLoc)return p(d.catchLoc,!0);if(this.prev<d.finallyLoc)return p(d.finallyLoc)}else if(S){if(this.prev<d.catchLoc)return p(d.catchLoc,!0)}else{if(!x)throw Error("try statement without catch or finally");if(this.prev<d.finallyLoc)return p(d.finallyLoc)}}}},abrupt:function(a,u){for(var p=this.tryEntries.length-1;p>=0;--p){var y=this.tryEntries[p];if(y.tryLoc<=this.prev&&n.call(y,"finallyLoc")&&this.prev<y.finallyLoc){var d=y;break}}d&&(a==="break"||a==="continue")&&d.tryLoc<=u&&u<=d.finallyLoc&&(d=null);var _=d?d.completion:{};return _.type=a,_.arg=u,d?(this.method="next",this.next=d.finallyLoc,b):this.complete(_)},complete:function(a,u){if(a.type==="throw")throw a.arg;return a.type==="break"||a.type==="continue"?this.next=a.arg:a.type==="return"?(this.rval=this.arg=a.arg,this.method="return",this.next="end"):a.type==="normal"&&u&&(this.next=u),b},finish:function(a){for(var u=this.tryEntries.length-1;u>=0;--u){var p=this.tryEntries[u];if(p.finallyLoc===a)return this.complete(p.completion,p.afterLoc),Y(p),b}},catch:function(a){for(var u=this.tryEntries.length-1;u>=0;--u){var p=this.tryEntries[u];if(p.tryLoc===a){var y=p.completion;if(y.type==="throw"){var d=y.arg;Y(p)}return d}}throw Error("illegal catch attempt")},delegateYield:function(a,u,p){return this.delegate={iterator:W(a),resultName:u,nextLoc:p},this.method==="next"&&(this.arg=e),b}},t}function bt(e,t,r,n,o,i,s){try{var f=e[i](s),c=f.value}catch(v){r(v);return}f.done?t(c):Promise.resolve(c).then(n,o)}function Tn(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function s(c){bt(i,n,o,s,f,"next",c)}function f(c){bt(i,n,o,s,f,"throw",c)}s(void 0)})}}function An(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,In(n.key),n)}}function Ln(e,t,r){return t&&wt(e.prototype,t),r&&wt(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function In(e){var t=Cn(e,"string");return ee(t)=="symbol"?t:t+""}function Cn(e,t){if(ee(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ee(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Fn=function(){function e(){An(this,e)}return Ln(e,[{key:"openFile",value:function(){var t=Tn(Be().mark(function n(o,i){var s;return Be().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(!(rr()&&o&&typeof o.uri<"u")){c.next=11;break}return c.prev=1,c.next=4,gn(o.uri);case 4:return s=c.sent,c.abrupt("return",new mt(s));case 8:throw c.prev=8,c.t0=c.catch(1),new Error("tus: cannot fetch `file.uri` as Blob, make sure the uri is correct and accessible. ".concat(c.t0));case 11:if(!(typeof o.slice=="function"&&typeof o.size<"u")){c.next=13;break}return c.abrupt("return",Promise.resolve(new mt(o)));case 13:if(typeof o.read!="function"){c.next=18;break}if(i=Number(i),Number.isFinite(i)){c.next=17;break}return c.abrupt("return",Promise.reject(new Error("cannot create source for stream without a finite value for the `chunkSize` option")));case 17:return c.abrupt("return",Promise.resolve(new $n(o,i)));case 18:return c.abrupt("return",Promise.reject(new Error("source object may only be an instance of File, Blob, or Reader in this environment")));case 19:case"end":return c.stop()}},n,null,[[1,8]])}));function r(n,o){return t.apply(this,arguments)}return r}()}])}();function Dn(e,t){return rr()?Promise.resolve(Nn(e,t)):Promise.resolve(["tus-br",e.name,e.type,e.size,e.lastModified,t.endpoint].join("-"))}function Nn(e,t){var r=e.exif?Bn(JSON.stringify(e.exif)):"noexif";return["tus-rn",e.name||"noname",e.size||"nosize",r,t.endpoint].join("/")}function Bn(e){var t=0;if(e.length===0)return t;for(var r=0;r<e.length;r++){var n=e.charCodeAt(r);t=(t<<5)-t+n,t&=t}return t}function ve(e){"@babel/helpers - typeof";return ve=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ve(e)}function Xe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ut(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zn(n.key),n)}}function Ye(e,t,r){return t&&Ut(e.prototype,t),r&&Ut(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zn(e){var t=qn(e,"string");return ve(t)=="symbol"?t:t+""}function qn(e,t){if(ve(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ve(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Hn=function(){function e(){Xe(this,e)}return Ye(e,[{key:"createRequest",value:function(r,n){return new Vn(r,n)}},{key:"getName",value:function(){return"XHRHttpStack"}}])}(),Vn=function(){function e(t,r){Xe(this,e),this._xhr=new XMLHttpRequest,this._xhr.open(t,r,!0),this._method=t,this._url=r,this._headers={}}return Ye(e,[{key:"getMethod",value:function(){return this._method}},{key:"getURL",value:function(){return this._url}},{key:"setHeader",value:function(r,n){this._xhr.setRequestHeader(r,n),this._headers[r]=n}},{key:"getHeader",value:function(r){return this._headers[r]}},{key:"setProgressHandler",value:function(r){"upload"in this._xhr&&(this._xhr.upload.onprogress=function(n){n.lengthComputable&&r(n.loaded)})}},{key:"send",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return new Promise(function(o,i){r._xhr.onload=function(){o(new Mn(r._xhr))},r._xhr.onerror=function(s){i(s)},r._xhr.send(n)})}},{key:"abort",value:function(){return this._xhr.abort(),Promise.resolve()}},{key:"getUnderlyingObject",value:function(){return this._xhr}}])}(),Mn=function(){function e(t){Xe(this,e),this._xhr=t}return Ye(e,[{key:"getStatus",value:function(){return this._xhr.status}},{key:"getHeader",value:function(r){return this._xhr.getResponseHeader(r)}},{key:"getBody",value:function(){return this._xhr.responseText}},{key:"getUnderlyingObject",value:function(){return this._xhr}}])}();function me(e){"@babel/helpers - typeof";return me=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},me(e)}function Gn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function St(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Xn(n.key),n)}}function Kn(e,t,r){return t&&St(e.prototype,t),r&&St(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Xn(e){var t=Yn(e,"string");return me(t)=="symbol"?t:t+""}function Yn(e,t){if(me(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(me(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ze=!1;try{ze="localStorage"in window;var $e="tusSupport",xt=localStorage.getItem($e);localStorage.setItem($e,xt),xt===null&&localStorage.removeItem($e)}catch(e){if(e.code===e.SECURITY_ERR||e.code===e.QUOTA_EXCEEDED_ERR)ze=!1;else throw e}var Zn=ze,Wn=function(){function e(){Gn(this,e)}return Kn(e,[{key:"findAllUploads",value:function(){var r=this._findEntries("tus::");return Promise.resolve(r)}},{key:"findUploadsByFingerprint",value:function(r){var n=this._findEntries("tus::".concat(r,"::"));return Promise.resolve(n)}},{key:"removeUpload",value:function(r){return localStorage.removeItem(r),Promise.resolve()}},{key:"addUpload",value:function(r,n){var o=Math.round(Math.random()*1e12),i="tus::".concat(r,"::").concat(o);return localStorage.setItem(i,JSON.stringify(n)),Promise.resolve(i)}},{key:"_findEntries",value:function(r){for(var n=[],o=0;o<localStorage.length;o++){var i=localStorage.key(o);if(i.indexOf(r)===0)try{var s=JSON.parse(localStorage.getItem(i));s.urlStorageKey=i,n.push(s)}catch{}}return n}}])}();function ae(e){"@babel/helpers - typeof";return ae=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ae(e)}function Jn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Pt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,or(n.key),n)}}function Qn(e,t,r){return t&&Pt(e.prototype,t),r&&Pt(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function eo(e,t,r){return t=Pe(t),to(e,nr()?Reflect.construct(t,r||[],Pe(e).constructor):t.apply(e,r))}function to(e,t){if(t&&(ae(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ro(e)}function ro(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(nr=function(){return!!e})()}function Pe(e){return Pe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Pe(e)}function no(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qe(e,t)}function qe(e,t){return qe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},qe(e,t)}function Et(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function ne(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Et(Object(r),!0).forEach(function(n){oo(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Et(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function oo(e,t,r){return t=or(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function or(e){var t=io(e,"string");return ae(t)=="symbol"?t:t+""}function io(e,t){if(ae(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ae(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ot=ne(ne({},xe.defaultOptions),{},{httpStack:new Hn,fileReader:new Fn,urlStorage:Zn?new Wn:new Ar,fingerprint:Dn}),ao=function(e){function t(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Jn(this,t),n=ne(ne({},Ot),n),eo(this,t,[r,n])}return no(t,e),Qn(t,null,[{key:"terminate",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return o=ne(ne({},Ot),o),xe.terminate(n,o)}}])}(xe);const ir=e=>(jt("data-v-51bbb306"),e=e(),$t(),e),uo={class:"yandex-video-uploader"},lo=ir(()=>A("h3",{class:"yandex-video-uploader__drop-region__label"}," Кликните или перетащите файл сюда ",-1)),so={class:"yandex-video-uploader__drop-region__hint"},fo=["accept"],co={key:1,class:"yandex-video-uploader__uploader"},po={key:0,class:"yandex-video-uploader__uploader__progress"},ho={key:1,class:"yandex-video-uploader__uploader__actions"},yo={key:2,class:"yandex-video-uploader__uploader__error"},vo=ir(()=>A("h3",null,"Ошибка загрузки",-1)),mo=_e({__name:"yandex-video-uploader",props:{uploadUrl:{}},emits:["before-upload","upload-finished","error"],setup(e,{emit:t}){const r=e,n=t,o={chunkSize:5*1024*1024,allowedFormats:["video/mp4","video/avi","video/mov"]},i=o.allowedFormats.map(w=>w.split("/")[1]).join(", "),s=`yandex-uploader-${lr()}`,f=H(null),c=H(null),v=H(!1),m=H(0),h=H(!1),g=H(null);function j(w){const U=w.target.files;U&&U[0]&&R(U[0])&&(f.value=U[0],n("before-upload",f.value))}we(()=>r.uploadUrl,()=>{r.uploadUrl&&P()});function P(){var E;if(!f.value||!r.uploadUrl)return;v.value=!0;const w={uploadUrl:r.uploadUrl,chunkSize:o.chunkSize,metadata:{filename:f.value.name,filetype:f.value.type},onError:U=>{v.value=!1,g.value=U,n("error")},onProgress:(U,I)=>{m.value=Math.floor(U/I*100)},onSuccess:()=>{v.value=!1,n("upload-finished")},retryDelays:[0,1e3,3e3,5e3]};c.value=new ao(f.value,w),(E=c.value)==null||E.start()}function k(){h.value=!0,c.value&&c.value.abort()}function b(){c.value?(h.value=!1,c.value.start()):P()}function L(){c.value&&(c.value.abort(),c.value=null,v.value=!1,m.value=0,f.value=null,h.value=!1)}function R(w){return o.allowedFormats.includes(w.type)}return(w,E)=>{const U=sr,I=Ee,C=fr,X=kt("auto-animate");return Rt((O(),N("div",uo,[f.value?z("",!0):(O(),N("label",{key:0,class:"yandex-video-uploader__drop-region",for:s},[lo,A("p",so," Допустимые форматы: "+je(Te(i)),1),A("input",{id:s,hidden:"",type:"file",onChange:E[0]||(E[0]=B=>j(B)),accept:o.allowedFormats.join(", ")},null,40,fo)])),v.value||f.value?(O(),N("div",co,[g.value?z("",!0):(O(),N("div",po,[A("h1",null,je(m.value)+"%",1),q(U,{value:m.value},null,8,["value"])])),g.value?z("",!0):(O(),N("div",ho,[!h.value&&v.value?(O(),J(I,{key:0,design:"inline",onClick:E[1]||(E[1]=B=>k())},{default:G(()=>[K(" Пауза ")]),_:1})):z("",!0),h.value?(O(),J(I,{key:1,design:"primary",onClick:E[2]||(E[2]=B=>b())},{default:G(()=>[K(" Продолжить ")]),_:1})):z("",!0),q(I,{design:"danger",onClick:E[3]||(E[3]=B=>L())},{default:G(()=>[K(" Отменить ")]),_:1})])),g.value?(O(),N("div",yo,[q(C,null,{default:G(()=>[vo,A("p",null,je(g.value),1)]),_:1})])):z("",!0)])):z("",!0)])),[[X]])}}});const _o=Tt(mo,[["__scopeId","data-v-51bbb306"]]),go={class:"video-creation-upload-form"},bo={class:"video-creation-upload-form__actions"},wo=_e({__name:"video-creation-upload-form",props:{uploadUrl:{},serviceType:{}},emits:["publish","before-upload","finish-upload"],setup(e,{emit:t}){const r=t,n=H(!1),o=()=>{n.value=!0,r("finish-upload")};return(i,s)=>{const f=_o,c=Ee;return O(),N("div",go,[i.serviceType==="yandex"?(O(),J(f,{key:0,"upload-url":i.uploadUrl,onBeforeUpload:s[0]||(s[0]=v=>i.$emit("before-upload",v)),onUploadFinished:s[1]||(s[1]=v=>o())},null,8,["upload-url"])):z("",!0),A("div",bo,[n.value?(O(),J(c,{key:0,onClick:s[2]||(s[2]=v=>i.$emit("publish")),design:"primary",alignment:"right"},{default:G(()=>[K(" Опубликовать видео ")]),_:1})):z("",!0)])])}}}),Uo={class:"video-creation-info-form"},So={class:"form-group"},xo={class:"form-group"},Po={class:"form-group"},Eo={class:"form-group"},Oo={class:"row"},ko={class:"col-md-4"},Ro={key:0,class:"col-md-4"},jo={key:1,class:"col-md-4"},$o={class:"form-group"},To=_e({__name:"video-creation-info-form",props:{video:{}},emits:["update:video","next-step"],setup(e,{emit:t}){const r=e,n=t,o=fe.Services.UI,i=At({get:()=>r.video,set:h=>n("update:video",h)}),s=H([]);we(s,h=>{i.value.thumbnail=h[0]||null});const f=H(null);we(f,h=>{switch(i.value.accessType){case"courseId":i.value.accessValue=(h==null?void 0:h.id)||null;break;case"role":i.value.accessValue=(h==null?void 0:h.value)||"student";break;case"everyone":default:i.value.accessValue=null;break}}),we(()=>i.value.accessType,()=>{switch(i.value.accessType){case"role":i.value.accessValue="student";break;case"courseId":case"everyone":default:i.value.accessValue=null;break}});const c=[{value:"everyone",label:"Всем"},{value:"courseId",label:"Участникам курса"},{value:"role",label:"По роли"}];function v(){m()&&n("next-step")}function m(){return!i.value.title.length||i.value.title.length>100?(o.openErrorModal("Не удалось создать видео","Название не должно быть пустым или превышать 100 символов"),!1):i.value.serviceType?!0:(o.openErrorModal("Не удалось создать видео","Выберите сервис для загрузки видео"),!1)}return(h,g)=>{const j=cr,P=pr,k=dr,b=hr,L=yr,R=vr,w=mr,E=Ee;return O(),N("div",Uo,[A("div",So,[q(j,{label:"Название",modelValue:i.value.title,"onUpdate:modelValue":g[0]||(g[0]=U=>i.value.title=U),type:"text",validators:[U=>U.length>0||"Введите название видео",U=>U.length<=100||"Название не должно превышать 100 символов"]},null,8,["modelValue","validators"])]),A("div",xo,[q(P,{modelValue:s.value,"onUpdate:modelValue":g[1]||(g[1]=U=>s.value=U),label:"Превью-изображение","max-count":1,"allowed-mime-types":["image/jpeg","image/png"]},null,8,["modelValue"])]),A("div",Po,[q(k,{label:"Описание",modelValue:i.value.description,"onUpdate:modelValue":g[2]||(g[2]=U=>i.value.description=U)},null,8,["modelValue"])]),A("div",Eo,[A("div",Oo,[A("div",ko,[q(j,{label:"Дата публикации",modelValue:i.value.publishedAt,"onUpdate:modelValue":g[3]||(g[3]=U=>i.value.publishedAt=U),type:"date"},null,8,["modelValue"])]),Te(fe).Context.roleIs(["admin","teacher"])?(O(),N("div",Ro,[q(b,{label:"Видео доступно",modelValue:i.value.accessType,"onUpdate:modelValue":g[4]||(g[4]=U=>i.value.accessType=U),options:c},null,8,["modelValue"]),i.value.accessType==="everyone"?(O(),J(L,{key:0,small:"",class:"everyone-access-type-warning"},{default:G(()=>[K(" Доступно всем пользователям, включая всех, кто перешел по ссылке или зарегестрировался на платформе без приобретения курса. ")]),_:1})):z("",!0)])):z("",!0),Te(fe).Context.roleIs(["admin","teacher"])?(O(),N("div",jo,[i.value.accessType==="courseId"?(O(),J(R,{key:0,label:"Курс",modelValue:f.value,"onUpdate:modelValue":g[5]||(g[5]=U=>f.value=U)},null,8,["modelValue"])):i.value.accessType==="role"?(O(),J(w,{key:1,label:"Роль",modelValue:f.value,"onUpdate:modelValue":g[6]||(g[6]=U=>f.value=U)},null,8,["modelValue"])):z("",!0)])):z("",!0)])]),A("div",$o,[q(E,{alignment:"right",onClick:v},{default:G(()=>[K(" Следующий шаг ")]),_:1})])])}}});const ar=e=>(jt("data-v-2910ed7d"),e=e(),$t(),e),Ao={class:"video-creation-form"},Lo={key:0,class:"video-creation-form__info-step"},Io={key:1,class:"video-creation-form__upload-step"},Co={key:2,class:"video-creation-form__success-step"},Fo=ar(()=>A("h1",{class:"video-creation-form__success-step__title"}," Видео успешно загружено ",-1)),Do=ar(()=>A("p",{class:"video-creation-form__success-step__hint"}," Видео будет доступно после обработки, это может занять некоторое время. Чем больше видео, тем дольше обработка. ",-1)),No={class:"video-creation-form__success-step__actions"},Bo=_e({__name:"video-creation-form",emits:["video-created"],setup(e,{emit:t}){const r=t,n=fe.Services.Video,o=fe.Services.UI,i=H(g()),s=At(()=>`/nootube/video/${i.value.id}`),f=H("info");async function c(j){var P,k;try{i.value.sizeInBytes=j.size;const b=await n.createVideo({...i.value,id:void 0});if(!((P=b.data)!=null&&P.id)||!((k=b.data)!=null&&k.uploadUrl))throw new Error("Не удалось создать видео");i.value.id=b.data.id,i.value.uploadUrl=b.data.uploadUrl}catch(b){o.openErrorModal("Не удалось создать видео",b.message),f.value="info"}finally{f.value="upload"}}async function v(){if(i.value.id)try{await n.finishUpload(i.value.id,{showLoader:!0}),i.value.state="uploaded"}catch(j){o.openErrorModal("Не удалось завершить загрузку видео",j.message),f.value="upload"}}async function m(){if(i.value.id)try{await n.publish(i.value.id),f.value="success",r("video-created",i.value)}catch(j){o.openErrorModal("Не удалось сохранить видео",j.message),f.value="upload"}}function h(){i.value=g(),f.value="info"}function g(){return{id:null,title:"",description:_r(),publishedAt:new Date,serviceType:"yandex",uniqueIdentifier:"",state:"not-uploaded",accessType:"everyone",accessValue:null,sizeInBytes:0,duration:0,chapters:[],thumbnail:null,uploadUrl:null,url:null}}return(j,P)=>{const k=To,b=wo,L=Ee,R=kt("auto-animate");return Rt((O(),N("div",Ao,[f.value==="info"?(O(),N("div",Lo,[q(k,{video:i.value,"onUpdate:video":P[0]||(P[0]=w=>i.value=w),onNextStep:P[1]||(P[1]=w=>f.value="upload")},null,8,["video"])])):f.value==="upload"?(O(),N("div",Io,[q(b,{"upload-url":i.value.uploadUrl,"service-type":i.value.serviceType,onBeforeUpload:P[2]||(P[2]=w=>c(w)),onFinishUpload:P[3]||(P[3]=w=>v()),onPublish:P[4]||(P[4]=w=>m())},null,8,["upload-url","service-type"])])):f.value==="success"?(O(),N("div",Co,[Fo,Do,A("div",No,[q(L,{to:s.value,design:"primary",alignment:"center"},{default:G(()=>[K(" Перейти к видео ")]),_:1},8,["to"]),q(L,{onClick:P[5]||(P[5]=w=>h()),design:"secondary",alignment:"center"},{default:G(()=>[K(" Загрузить еще видео ")]),_:1})])])):z("",!0)])),[[R]])}}});const zo=Tt(Bo,[["__scopeId","data-v-2910ed7d"]]),qo={class:"upload-video-view"},Vo=_e({__name:"upload-video-view",setup(e){function t(r){}return(r,n)=>{const o=zo;return O(),N("div",qo,[q(o,{onUploaded:n[0]||(n[0]=i=>void 0)})])}}});export{Vo as default};
