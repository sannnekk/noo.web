import{a as W,c as H,o as n,b as l,e as o,t as r,z as V,m as S,A as N,F as A,B as P,f as c,w as d,h as k,D as G,E as J,G as O,H as Y,g as s,v as u,s as _,x as j,I as q,J as Q,k as X,K as Z,C as $,p as ee,l as se,y as te}from"./index-d3bd2430.js";import{_ as oe}from"./user-card-44ecb111.js";import{u as y}from"./assigned-work-ea1564cc.js";import{u as f}from"./useDate-126c6fe0.js";import"./deltaHelpers-643e5dae.js";const ne={class:"assigned-work-solve-solve-status__text"},ie=W({__name:"assigned-work-check-status",props:{status:{}},setup(i){const e=i,w=H(()=>{switch(e.status){case"not-checked":return"Не проверено";case"in-progress":return"В процессе";case"checked-in-deadline":return"Проверено в дедлайн";case"checked-after-deadline":return"Проверено после дедлайна";case"checked-automatically":return"Проверено автоматически";default:return"неизвестно"}});return(p,t)=>(n(),l("div",{class:V(["assigned-work-solve-status",{"assigned-work-solve-status--not-started":e.status==="not-started","assigned-work-solve-status--in-progress":e.status==="in-progress","assigned-work-solve-status--checked-in-deadline":e.status==="checked-in-deadline","assigned-work-solve-status--checked-after-deadline":e.status==="checked-after-deadline","assigned-work-solve-status--checked-automatically":e.status==="checked-automatically"}])},[o("span",ne,r(w.value),1)],2))}});const ae=S(ie,[["__scopeId","data-v-71565f8a"]]),re={class:"assigned-work-solve-solve-status__text"},_e=W({__name:"assigned-work-solve-status",props:{status:{}},setup(i){const e=i,w=H(()=>{switch(e.status){case"not-started":return"Не начато";case"in-progress":return"В процессе";case"made-in-deadline":return"Сдано в дедлайн";case"made-after-deadline":return"Сдано после дедлайна";default:return"неизвестно"}});return(p,t)=>(n(),l("div",{class:V(["assigned-work-solve-status",{"assigned-work-solve-status--not-started":e.status==="not-started","assigned-work-solve-status--in-progress":e.status==="in-progress","assigned-work-solve-status--made-in-deadline":e.status==="made-in-deadline","assigned-work-solve-status--made-after-deadline":e.status==="made-after-deadline"}])},[o("span",re,r(w.value),1)],2))}});const de=S(_e,[["__scopeId","data-v-3fd6b884"]]),le={class:"task-list"},ce={key:1},ue=W({__name:"task-list",props:{baseUrl:{},tasks:{},workId:{},isSolvedFunction:{type:Function},scoreFunction:{type:Function}},setup(i){return(e,w)=>{const p=G,t=N("router-link");return n(),l("ul",le,[(n(!0),l(A,null,P(e.tasks,(v,x)=>(n(),l("li",{key:v.id},[c(t,{to:`${e.baseUrl}/${v.slug}`,class:V({success:e.scoreFunction(v)==="success",warning:e.scoreFunction(v)==="warning",error:e.scoreFunction(v)==="error"})},{default:d(()=>[e.isSolvedFunction(v)?(n(),k(p,{key:0,class:"task-list__icon",name:"check-green"})):(n(),l("span",ce,r(x+1),1))]),_:2},1032,["to","class"])]))),128))])}}});const ke=S(ue,[["__scopeId","data-v-4bb01805"]]),pe=[{keys:["Ctrl","Enter"],description:"Отправить решение/проверку",shortcut:["Ctrl","Enter"],handler:()=>{const i=y();i.sureSubmitModalVisible=!0}},{keys:["Ctrl","ArrowLeft"],description:"Предыдущее задание",shortcut:["Ctrl","ArrowLeft"],handler:()=>{const i=y(),e=i._router;i.previousTaskLink&&e.push(i.previousTaskLink)}},{keys:["Ctrl","ArrowRight"],description:"Следующее задание",shortcut:["Ctrl","ArrowRight"],handler:()=>{const i=y(),e=i._router;i.nextTaskLink&&e.push(i.nextTaskLink)}}],g=i=>(ee("data-v-89298e3e"),i=i(),se(),i),ve={class:"work-view"},me={class:"work-view__sidebar"},ge={class:"work-view__sidebar__title"},we={key:0},he={class:"work-view__sidebar__info"},be={key:0,class:"work-view__sidebar__info__check-deadline"},fe={key:1,class:"work-view__sidebar__info__solve-deadline"},ye={class:"work-view__sidebar__info__solve-status"},We={key:2,class:"work-view__sidebar__info__solve-status"},Se={class:"work-view__sidebar__info__check-status"},xe={key:3,class:"work-view__sidebar__info__solve-status"},Ce={class:"work-view__sidebar__score"},$e={class:"work-view__sidebar__submit"},Ae={class:"work-view__sidebar__people"},Ve={class:"work-view__sidebar__people__student"},Fe=g(()=>o("label",null,"Ученик: ",-1)),Me={class:"work-view__sidebar__people__mentor"},Te=g(()=>o("label",null,"Проверяющие кураторы: ",-1)),De={class:"work-view__content"},Ue={class:"task-view__title"},Ie={key:1,class:"work-view__not-found"},Be=g(()=>o("h1",{class:"work-view__not-found__title"},"Работа не найдена",-1)),Le=[Be],Ee=g(()=>o("br",null,null,-1)),He=g(()=>o("br",null,null,-1)),Ne=g(()=>o("br",null,null,-1)),Pe=g(()=>o("br",null,null,-1)),ze=g(()=>o("p",null," Уже решенная работа НЕ будет удалена, будет создана новая работа с теми же заданиями ",-1)),Ke=W({__name:"work-view",setup(i){const e=y();e.fetchAssignedWork(),J(()=>e.assignedWork,()=>{var p;(p=e.assignedWork)!=null&&p.work&&te(e.assignedWork.work.name)},{deep:!0,immediate:!0});const w=O(pe);return Y(()=>{w()}),(p,t)=>{const v=de,x=ae,b=j,F=oe,z=N("router-view"),K=q,M=Q,C=X,R=Z;return n(),l(A,null,[o("div",ve,[s(e).assignedWork?(n(),k(K,{key:0},{sidebar:d(()=>{var a,m,T,D,U,I,B,L,E;return[o("div",me,[o("h2",ge,r(s(e).mode==="check"?"Проверка":"Работа"),1),s(e).mode==="solve"?(n(),l("p",we)):u("",!0),o("div",he,[((a=s($).Context.User)==null?void 0:a.role)==="mentor"&&s(e).assignedWork.checkDeadlineAt?(n(),l("p",be," Дедлайн проверки: "+r(s(f)(s(e).assignedWork.checkDeadlineAt,{precision:"day"}).toBeautiful()),1)):u("",!0),s(e).assignedWork.solveDeadlineAt?(n(),l("p",fe," Дедлайн сдачи: "+r(s(f)(s(e).assignedWork.solveDeadlineAt,{precision:"day"}).toBeautiful()),1)):u("",!0),o("p",ye,[_(" Статус работы: "),c(v,{status:s(e).assignedWork.solveStatus},null,8,["status"])]),s(e).assignedWork.solvedAt?(n(),l("p",We," Работа сдана: "+r(s(f)(s(e).assignedWork.solvedAt,{precision:"day"}).toBeautiful()),1)):u("",!0),o("p",Se,[_(" Статус проверки: "),c(x,{status:s(e).assignedWork.checkStatus},null,8,["status"])]),s(e).assignedWork.checkedAt?(n(),l("p",xe," Работа проверена: "+r(s(f)(s(e).assignedWork.checkedAt,{precision:"day"}).toBeautiful()),1)):u("",!0)]),c(ke,{"work-id":s(e).assignedWorkId,"is-solved-function":s(e).taskHasAnswer,"score-function":s(e).taskScoreStatus,"base-url":s(e).baseUrl,tasks:((m=s(e).assignedWork.work)==null?void 0:m.tasks)||[]},null,8,["work-id","is-solved-function","score-function","base-url","tasks"]),o("p",Ce,[_(" Оценка: "),o("b",null,r(s(e).workScoreText===null?"не выставлена":s(e).workScoreText),1),_(" из "),o("b",null,r(s(e).assignedWork.maxScore),1),_(" "+r(s(e).assignedWork.score?"("+(s(e).assignedWork.score/s(e).assignedWork.maxScore*100).toFixed(2)+"%)":""),1)]),o("div",$e,[["check","solve"].includes(s(e).mode)?(n(),k(b,{key:0,alignment:"stretch",onClick:t[0]||(t[0]=h=>s(e).submitWork())},{default:d(()=>[_(r(s(e).mode==="check"?"Завершить проверку":"Завершить работу"),1)]),_:1})):u("",!0),s(e).mode==="read"&&((D=(T=s(e).assignedWork)==null?void 0:T.work)==null?void 0:D.type)==="test"&&((U=s($).Context.User)==null?void 0:U.role)==="student"&&(((I=s(e).assignedWork)==null?void 0:I.checkStatus)=="checked-in-deadline"||((B=s(e).assignedWork)==null?void 0:B.checkStatus)=="checked-after-deadline"||((L=s(e).assignedWork)==null?void 0:L.checkStatus)=="checked-automatically")?(n(),k(b,{key:1,alignment:"stretch",onClick:t[1]||(t[1]=h=>s(e).remakeModal.visible=!0)},{default:d(()=>[_(" Переделать работу ")]),_:1})):u("",!0),["check","solve"].includes(s(e).mode)?(n(),k(b,{key:2,class:"work-view__sidebar__save-button",alignment:"stretch",design:"inline",onClick:t[2]||(t[2]=h=>s(e).saveProgress())},{default:d(()=>[_(" Сохранить без сдачи ")]),_:1})):u("",!0),["check","solve"].includes(s(e).mode)?(n(),k(b,{key:3,class:"work-view__sidebar__shift-button",alignment:"stretch",design:"inline",onClick:t[3]||(t[3]=h=>s(e).shiftDeadline())},{default:d(()=>[_(r(s(e).mode==="check"?"Сдвинуть дедлайн проверки":"Сдвинуть дедлайн сдачи"),1)]),_:1})):u("",!0),c(b,{to:["admin","teacher"].includes((E=s($).Context.User)==null?void 0:E.role)?"/works":"/assigned-works",alignment:"stretch",design:"inline",class:"work-view__sidebar__back-button"},{default:d(()=>[_(" Вернуться к списку работ ")]),_:1},8,["to"]),o("div",Ae,[o("div",Ve,[Fe,c(F,{user:s(e).assignedWork.student},null,8,["user"])]),o("div",Me,[Te,(n(!0),l(A,null,P(s(e).assignedWork.mentors,h=>(n(),k(F,{user:h,key:h.id},null,8,["user"]))),128))])])])])]}),content:d(()=>{var a,m;return[o("div",De,[o("h2",Ue,r((m=(a=s(e).assignedWork)==null?void 0:a.work)==null?void 0:m.name),1),(n(),k(z,{key:p.$route.fullPath}))])]}),_:1})):(n(),l("div",Ie,Le))]),c(C,{visible:s(e).sureSubmitModalVisible,"onUpdate:visible":t[4]||(t[4]=a=>s(e).sureSubmitModalVisible=a),onConfirm:t[5]||(t[5]=a=>s(e).submitWork())},{title:d(()=>[_(r(s(e).mode==="check"?"Завершить проверку":"Завершить работу"),1)]),text:d(()=>[_(r(s(e).mode==="check"?"Вы уверены, что хотите завершить проверку?":"Вы уверены, что хотите завершить работу?")+" ",1),Ee,He,s(e).sureSubmitModalError?(n(),k(M,{key:0},{default:d(()=>[_(r(s(e).sureSubmitModalError),1)]),_:1})):u("",!0)]),_:1},8,["visible"]),c(C,{visible:s(e).shiftDeadlineModalVisible,"onUpdate:visible":t[6]||(t[6]=a=>s(e).shiftDeadlineModalVisible=a),onConfirm:t[7]||(t[7]=a=>s(e).shiftDeadline())},{title:d(()=>[_(" Сдвинуть дедлайн на 1 день ")]),text:d(()=>[_(" Вы уверены, что хотите сдвинуть дедлайн? "),Ne,Pe,c(M,null,{default:d(()=>[_(" Сдвинуть дедлайн можно только один раз ")]),_:1})]),_:1},8,["visible"]),c(C,{visible:s(e).remakeModal.visible,"onUpdate:visible":t[9]||(t[9]=a=>s(e).remakeModal.visible=a),onConfirm:t[10]||(t[10]=a=>s(e).remakeWork())},{title:d(()=>{var a,m;return[_(' Вы уверены, что хотите заново сделать работу "'+r((m=(a=s(e).assignedWork)==null?void 0:a.work)==null?void 0:m.name)+'"? ',1)]}),text:d(()=>[ze,c(R,{modelValue:s(e).remakeModal.onlyFalse,"onUpdate:modelValue":t[8]||(t[8]=a=>s(e).remakeModal.onlyFalse=a),label:"Перерешать только неправильные"},null,8,["modelValue"])]),_:1},8,["visible"])],64)}}});const je=S(Ke,[["__scopeId","data-v-89298e3e"]]);export{je as default};
