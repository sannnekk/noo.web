import{d as k,r as x,ab as E,C as V,a as u,i as v,g as l,j as _,e as m,y as f,O as L,ac as I,E as B,_ as w,x as h,P as O,T as N,v as $,b as F,f as T,Z as j,Q as A,p as G,l as P,G as Q,u as y,A as Z}from"./index-959d0ab5.js";import{S as U}from"./settings-section-d2e035cc.js";const q={class:"create-snippet-form"},z={class:"create-snippet-form__name"},H={class:"create-snippet-form__content"},J={class:"create-snippet-form__actions"},K=k({__name:"create-snippet-form",emits:["create-snippet"],setup(r){const t=x({name:"",content:E(),userId:V.Context.User.id});return(i,e)=>{const n=L,c=I,S=B;return u(),v("div",q,[l("div",z,[_(n,{modelValue:t.value.name,"onUpdate:modelValue":e[0]||(e[0]=o=>t.value.name=o),label:"Название сниппета",type:"text",validators:[o=>o.length>0||"Название сниппета должно содержать хотя бы 1 символ",o=>o.length<=50||"Название сниппета не должно превышать 50 символов"]},null,8,["modelValue","validators"])]),l("div",H,[_(c,{label:"Сниппет",modelValue:t.value.content,"onUpdate:modelValue":e[1]||(e[1]=o=>t.value.content=o)},null,8,["modelValue"])]),l("div",J,[_(S,{onClick:e[2]||(e[2]=o=>i.$emit("create-snippet",t.value)),alignment:"right",design:"primary"},{default:m(()=>[f(" Создать сниппет ")]),_:1})])])}}});const R=w(K,[["__scopeId","data-v-71f78365"]]),W=r=>(G("data-v-f34dfc17"),r=r(),P(),r),X={key:0,class:"snippet-list"},Y={class:"snippet-list__item__index"},ee={class:"snippet-list__item__name"},te={class:"snippet-list__item__actions"},ne=["onClick"],se=["onClick"],ie={key:1,class:"snippet-list__no-snippets"},oe=W(()=>l("p",null,[f(" Сниппеты позволяют сохранить и использовать часто используемые фрагменты текста. "),l("br"),f(" Создайте свой первый сниппет! ")],-1)),pe=[oe],ae=k({__name:"snippet-list",props:{snippets:{}},emits:["update","delete"],setup(r,{emit:t}){const i=t,e=h({isOpen:!1,snippet:null}),n=h({isOpen:!1,snippet:null});function c(a){e.snippet=a,e.isOpen=!0}function S(a){n.snippet=a,n.isOpen=!0}function o(){n.snippet&&i("delete",n.snippet)}function p(){e.snippet&&i("update",e.snippet)}return(a,d)=>{const C=j,M=I,b=A;return u(),v(O,null,[a.snippets.length!==0?(u(),v("div",X,[(u(!0),v(O,null,N(a.snippets,(s,g)=>(u(),v("div",{class:"snippet-list__item",key:s.id},[l("div",Y,[l("span",null,$(g+1),1)]),l("div",ee,[l("span",null,$(s.name),1)]),l("div",te,[l("div",{class:"snippet-list__item__actions__edit",onClick:D=>c(s)},[_(C,{name:"edit"})],8,ne),l("div",{class:"snippet-list__item__actions__delete",onClick:D=>S(s)},[_(C,{name:"delete"})],8,se)])]))),128))])):(u(),v("div",ie,pe)),_(b,{visible:e.isOpen,"onUpdate:visible":d[1]||(d[1]=s=>e.isOpen=s),onConfirm:d[2]||(d[2]=s=>p())},{title:m(()=>[f("Редактировать сниппет")]),text:m(()=>{var s;return[(s=e.snippet)!=null&&s.content?(u(),F(M,{key:0,label:"Сниппет",modelValue:e.snippet.content,"onUpdate:modelValue":d[0]||(d[0]=g=>e.snippet.content=g)},null,8,["modelValue"])):T("",!0)]}),_:1},8,["visible"]),_(b,{visible:n.isOpen,"onUpdate:visible":d[3]||(d[3]=s=>n.isOpen=s),onConfirm:d[4]||(d[4]=s=>o())},{title:m(()=>{var s;return[f('Удалить сниппет "'+$((s=n.snippet)==null?void 0:s.name)+'"',1)]}),text:m(()=>[f(" Вы уверены, что хотите удалить этот сниппет? ")]),_:1},8,["visible"])],64)}}});const le=w(ae,[["__scopeId","data-v-f34dfc17"]]),_e=Q("settings-module:snippets",()=>{const r=V.Services.Snippet,t=V.Services.UI,i=x(!1),e=x([]);async function n(){i.value=!0;try{const p=await r.getSnippets();e.value=p.data}catch(p){t.openErrorModal("Ошибка при загрузке сниппетов",p.message)}finally{i.value=!1}}async function c(p){i.value=!0;try{await r.createSnippet(p),await n()}catch(a){t.openErrorModal("Ошибка при создании сниппета",a.message)}finally{i.value=!1}}async function S(p){i.value=!0;try{await r.updateSnippet(p.id,p),await n()}catch(a){t.openErrorModal("Ошибка при обновлении сниппета",a.message)}finally{i.value=!1}}async function o(p){i.value=!0;try{await r.deleteSnippet(p.id),await n()}catch(a){t.openErrorModal("Ошибка при удалении сниппета",a.message)}finally{i.value=!1}}return{moduleLoading:i,snippets:e,fetchSnippets:n,createSnippet:c,updateSnippet:S,deleteSnippet:o}}),re={key:0,class:"snippets-view"},ce={key:1,class:"snippets-view__loading"},de=k({__name:"snippets-view",setup(r){const t=_e();return t.fetchSnippets(),(i,e)=>{const n=Z;return y(t).moduleLoading?(u(),v("div",ce,[_(n,{contrast:""})])):(u(),v("div",re,[_(U,null,{title:m(()=>[f(" Мои сниппеты ")]),content:m(()=>[_(le,{snippets:y(t).snippets,onUpdate:e[0]||(e[0]=c=>y(t).updateSnippet(c)),onDelete:e[1]||(e[1]=c=>y(t).deleteSnippet(c))},null,8,["snippets"])]),_:1}),_(U,null,{title:m(()=>[f(" Создать сниппет ")]),content:m(()=>[_(R,{onCreateSnippet:e[2]||(e[2]=c=>y(t).createSnippet(c))})]),_:1})]))}}});const ve=w(de,[["__scopeId","data-v-40727319"]]);export{ve as default};
