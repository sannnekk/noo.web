import{d as N,C as g,c as j,a as p,b as F,an as O,r as V,w as h,q,s as C,i as f,g as s,j as a,f as S,e as b,y,v as G,a2 as L,aC as P,P as T,ao as z,a9 as A,ac as H,D as J,E as K,p as Q,l as R,_ as W,G as X}from"./index-585f48eb.js";import{S as Y}from"./settings-section-32a79a3a.js";const Z=N({__name:"course-select",props:{label:{},modelValue:{}},emits:["update:modelValue"],setup(n,{emit:d}){const c=n,e=d,t=g.Services.Course,i=g.Services.UI;async function m(r){try{return t.getCourses(r)}catch(v){i.openErrorModal("Произошла ошибка при загрузке курсов",v.message)}}const u=j({get:()=>c.modelValue?[c.modelValue]:[],set:r=>{r.length===0&&e("update:modelValue",null),e("update:modelValue",r[0])}});return(r,v)=>{const _=O;return p(),F(_,{label:r.label,"fetch-function":m,"label-keys":["subject.name","name"],"max-count":1,modelValue:u.value,"onUpdate:modelValue":v[0]||(v[0]=o=>u.value=o)},null,8,["label","modelValue"])}}}),ee=n=>(Q("data-v-e83b61e3"),n=n(),R(),n),oe={class:"create-notification-form"},te={class:"row"},le={class:"col-lg-6"},se={class:"form-group"},ae={class:"col-lg-6"},ne={class:"row"},ie={class:"col-lg-6"},ue={class:"form-group"},ce={class:"col-lg-6"},re={class:"form-group"},_e={class:"row"},de={class:"col-12"},me=ee(()=>s("h4",null,"Кому отправить",-1)),pe={class:"row"},ve={class:"col-lg-6"},fe={class:"form-group"},Ve={class:"col-lg-6"},ge={key:0,class:"form-group"},be={key:1,class:"form-group"},he={key:0,class:"form-errors"},Se={class:"form-actions"},ye=N({__name:"create-notification-form",emits:["create"],setup(n,{emit:d}){const c=d,e=V({title:"",message:"",type:"other",link:"",isBanner:!1}),t=V({selector:"all",value:null}),i=V(null);h(i,()=>{var _;return t.value.value=((_=i.value)==null?void 0:_.value)||null});const m=V(null),u=V([]);h(m,()=>{var _;return t.value.value=((_=m.value)==null?void 0:_.id)||null}),h(()=>t.value.selector,()=>t.value.value=null);function r(){if(u.value=[],!e.value.title){u.value.push("Заголовок обязателен");return}if(t.value.selector==="role"&&!i.value){u.value.push("Выберите роль");return}if(t.value.selector==="course"&&!m.value){u.value.push("Выберите курс");return}c("create",e.value,t.value)}const v=[{value:"all",label:"Всем"},{value:"role",label:"По роли"},{value:"course",label:"По курсу"}];return(_,o)=>{const k=L,x=P,U=T,B=z,I=A,M=H,$=Z,D=J,E=K,w=q("auto-animate");return C((p(),f("div",oe,[s("div",te,[s("div",le,[s("div",se,[a(k,{type:"text",modelValue:e.value.title,"onUpdate:modelValue":o[0]||(o[0]=l=>e.value.title=l),label:"Заголовок",validators:[l=>!!l||"Заголовок обязателен"]},null,8,["modelValue","validators"])])]),s("div",ae,[a(x,{label:"Тип",modelValue:e.value.type,"onUpdate:modelValue":o[1]||(o[1]=l=>e.value.type=l)},null,8,["modelValue"])])]),s("div",ne,[s("div",ie,[s("div",ue,[a(U,{modelValue:e.value.message,"onUpdate:modelValue":o[2]||(o[2]=l=>e.value.message=l),label:"Сообщение (необязательно)"},null,8,["modelValue"])])]),s("div",ce,[s("div",re,[a(k,{label:"Ссылка (необязательно)",type:"url",modelValue:e.value.link,"onUpdate:modelValue":o[3]||(o[3]=l=>e.value.link=l)},null,8,["modelValue"])])])]),s("div",_e,[s("div",de,[a(B,{label:"Создать как баннер",modelValue:e.value.isBanner,"onUpdate:modelValue":o[4]||(o[4]=l=>e.value.isBanner=l)},null,8,["modelValue"])])]),me,s("div",pe,[s("div",ve,[s("div",fe,[a(I,{label:"Селектор",modelValue:t.value.selector,"onUpdate:modelValue":o[5]||(o[5]=l=>t.value.selector=l),options:v},null,8,["modelValue"])])]),C((p(),f("div",Ve,[t.value.selector==="role"?(p(),f("div",ge,[a(M,{label:"Выберите роль",modelValue:i.value,"onUpdate:modelValue":o[6]||(o[6]=l=>i.value=l)},null,8,["modelValue"])])):S("",!0),t.value.selector==="course"?(p(),f("div",be,[a($,{label:"Выберите курс",modelValue:m.value,"onUpdate:modelValue":o[7]||(o[7]=l=>m.value=l),expectId:""},null,8,["modelValue"])])):S("",!0)])),[[w]])]),u.value.length?(p(),f("div",he,[a(D,null,{default:b(()=>[y(G(u.value.join(", ")),1)]),_:1})])):S("",!0),s("div",Se,[a(E,{alignment:"right",onClick:o[8]||(o[8]=l=>r())},{default:b(()=>[y(" Создать и отправить ")]),_:1})])])),[[w]])}}});const Ne=W(ye,[["__scopeId","data-v-e83b61e3"]]),ke=X("settings-module:notifications",()=>{const n=g.Services.Notification,d=g.Services.UI;async function c(e,t){try{await n.createNotification(e,t,{showLoader:!0})}catch(i){d.openErrorModal("Не удалось создать уведомление",i.message)}}return{createNotification:c}}),we={class:"notifications-view"},Ue=N({__name:"notifications-view",setup(n){const d=ke();function c(e,t){d.createNotification(e,t)}return(e,t)=>(p(),f("div",we,[a(Y,null,{title:b(()=>[y("Отправить уведомление")]),content:b(()=>[a(Ne,{onCreate:c})]),_:1})]))}});export{Ue as default};
