import{d as k,r as $,ad as E,C as x,a as u,i as v,g as l,j as _,e as m,y as f,a1 as L,a8 as I,E as B,_ as w,x as h,R as O,V as N,v as V,b as F,f as j,O as A,ae as G,p as R,l as T,G as q,u as y,A as z}from"./index-50888d69.js";import{S as U}from"./settings-section-6eca12c3.js";const H={class:"create-snippet-form"},J={class:"create-snippet-form__name"},K={class:"create-snippet-form__content"},P={class:"create-snippet-form__actions"},Q=k({__name:"create-snippet-form",emits:["create-snippet"],setup(r){const t=$({name:"",content:E(),userId:x.Context.User.id});return(i,e)=>{const n=L,c=I,S=B;return u(),v("div",H,[l("div",J,[_(n,{modelValue:t.value.name,"onUpdate:modelValue":e[0]||(e[0]=o=>t.value.name=o),label:"Название сниппета",type:"text",validators:[o=>o.length>0||"Название сниппета должно содержать хотя бы 1 символ",o=>o.length<=50||"Название сниппета не должно превышать 50 символов"]},null,8,["modelValue","validators"])]),l("div",K,[_(c,{label:"Сниппет",modelValue:t.value.content,"onUpdate:modelValue":e[1]||(e[1]=o=>t.value.content=o)},null,8,["modelValue"])]),l("div",P,[_(S,{onClick:e[2]||(e[2]=o=>i.$emit("create-snippet",t.value)),alignment:"right",design:"primary"},{default:m(()=>[f(" Создать сниппет ")]),_:1})])])}}});const W=w(Q,[["__scopeId","data-v-71f78365"]]),X=r=>(R("data-v-f34dfc17"),r=r(),T(),r),Y={key:0,class:"snippet-list"},Z={class:"snippet-list__item__index"},ee={class:"snippet-list__item__name"},te={class:"snippet-list__item__actions"},ne=["onClick"],se=["onClick"],ie={key:1,class:"snippet-list__no-snippets"},oe=X(()=>l("p",null,[f(" Сниппеты позволяют сохранить и использовать часто используемые фрагменты текста. "),l("br"),f(" Создайте свой первый сниппет! ")],-1)),pe=[oe],ae=k({__name:"snippet-list",props:{snippets:{}},emits:["update","delete"],setup(r,{emit:t}){const i=t,e=h({isOpen:!1,snippet:null}),n=h({isOpen:!1,snippet:null});function c(a){e.snippet=a,e.isOpen=!0}function S(a){n.snippet=a,n.isOpen=!0}function o(){n.snippet&&i("delete",n.snippet)}function p(){e.snippet&&i("update",e.snippet)}return(a,d)=>{const C=A,M=I,b=G;return u(),v(O,null,[a.snippets.length!==0?(u(),v("div",Y,[(u(!0),v(O,null,N(a.snippets,(s,g)=>(u(),v("div",{class:"snippet-list__item",key:s.id},[l("div",Z,[l("span",null,V(g+1),1)]),l("div",ee,[l("span",null,V(s.name),1)]),l("div",te,[l("div",{class:"snippet-list__item__actions__edit",onClick:D=>c(s)},[_(C,{name:"edit"})],8,ne),l("div",{class:"snippet-list__item__actions__delete",onClick:D=>S(s)},[_(C,{name:"delete"})],8,se)])]))),128))])):(u(),v("div",ie,pe)),_(b,{visible:e.isOpen,"onUpdate:visible":d[1]||(d[1]=s=>e.isOpen=s),onConfirm:d[2]||(d[2]=s=>p())},{title:m(()=>[f("Редактировать сниппет")]),text:m(()=>{var s;return[(s=e.snippet)!=null&&s.content?(u(),F(M,{key:0,label:"Сниппет",modelValue:e.snippet.content,"onUpdate:modelValue":d[0]||(d[0]=g=>e.snippet.content=g)},null,8,["modelValue"])):j("",!0)]}),_:1},8,["visible"]),_(b,{visible:n.isOpen,"onUpdate:visible":d[3]||(d[3]=s=>n.isOpen=s),onConfirm:d[4]||(d[4]=s=>o())},{title:m(()=>{var s;return[f('Удалить сниппет "'+V((s=n.snippet)==null?void 0:s.name)+'"',1)]}),text:m(()=>[f(" Вы уверены, что хотите удалить этот сниппет? ")]),_:1},8,["visible"])],64)}}});const le=w(ae,[["__scopeId","data-v-f34dfc17"]]),_e=q("settings-module:snippets",()=>{const r=x.Services.Snippet,t=x.Services.UI,i=$(!1),e=$([]);async function n(){i.value=!0;try{const p=await r.getSnippets();e.value=p.data}catch(p){t.openErrorModal("Ошибка при загрузке сниппетов",p.message)}finally{i.value=!1}}async function c(p){i.value=!0;try{await r.createSnippet(p),await n()}catch(a){t.openErrorModal("Ошибка при создании сниппета",a.message)}finally{i.value=!1}}async function S(p){i.value=!0;try{await r.updateSnippet(p.id,p),await n()}catch(a){t.openErrorModal("Ошибка при обновлении сниппета",a.message)}finally{i.value=!1}}async function o(p){i.value=!0;try{await r.deleteSnippet(p.id),await n()}catch(a){t.openErrorModal("Ошибка при удалении сниппета",a.message)}finally{i.value=!1}}return{moduleLoading:i,snippets:e,fetchSnippets:n,createSnippet:c,updateSnippet:S,deleteSnippet:o}}),re={key:0,class:"snippets-view"},ce={key:1,class:"snippets-view__loading"},de=k({__name:"snippets-view",setup(r){const t=_e();return t.fetchSnippets(),(i,e)=>{const n=z;return y(t).moduleLoading?(u(),v("div",ce,[_(n,{contrast:""})])):(u(),v("div",re,[_(U,null,{title:m(()=>[f(" Мои сниппеты ")]),content:m(()=>[_(le,{snippets:y(t).snippets,onUpdate:e[0]||(e[0]=c=>y(t).updateSnippet(c)),onDelete:e[1]||(e[1]=c=>y(t).deleteSnippet(c))},null,8,["snippets"])]),_:1}),_(U,null,{title:m(()=>[f(" Создать сниппет ")]),content:m(()=>[_(W,{onCreateSnippet:e[2]||(e[2]=c=>y(t).createSnippet(c))})]),_:1})]))}}});const ve=w(de,[["__scopeId","data-v-40727319"]]);export{ve as default};
