import{d as C,a as n,j as r,P as m,T as y,g as s,v as i,t as V,y as h,_ as S,G as I,C as d,r as v,u,k as p,e as g,b as x,f as k,A as E}from"./index-8bafb379.js";import{S as w}from"./settings-section-33eb9412.js";const N={class:"changelog-view"},T={class:"changelog-view__item__version"},b={class:"changelog-view__item__date"},B={class:"changelog-view__item__changes"},F=C({__name:"changelog-view",props:{changelog:{}},setup(_){function t(a){switch(a){case"build":return"BUILD";case"feat":return"FEATURE";case"fix":return"FIX";case"impr":return"IMPROVEMENT";case"refc":return"REFACTOR";case"test":return"TEST";default:return"UNKNOWN"}}return(a,c)=>(n(),r("div",N,[(n(!0),r(m,null,y(a.changelog,e=>(n(),r("div",{class:"changelog-view__item",key:e.version},[s("div",T,"Версия "+i(e.version),1),s("div",b,"Дата релиза: "+i(e.date),1),s("div",B,[s("ul",null,[(n(!0),r(m,null,y(e.changes,(l,f)=>(n(),r("li",{key:f},[s("b",{class:V(l.type)},i(t(l.type)),3),h(" - "),s("span",null,i(l.description),1)]))),128))])])]))),128))]))}});const L=S(F,[["__scopeId","data-v-acfff6da"]]),M=I("settings-module:platform-info",()=>{const _=d.Services.Platform,t=d.Services.UI,a=v(null),c=v([]),e=v(!1);async function l(){e.value=!0,a.value=null;try{const o=await _.getVersion();a.value=o.data}catch(o){t.openErrorModal("Не удалось получить версию платформы",o.message)}finally{e.value=!1}}async function f(){e.value=!0,c.value=[];try{const o=await _.getChangelog();c.value=o.data}catch(o){t.openErrorModal("Не удалось получить changelog",o.message)}finally{e.value}}return{version:a,fetchVersion:l,changelog:c,fetchChangelog:f,moduleLoading:e}}),P={key:0,class:"platform-info-view"},R={key:1,class:"platform-info-view__loading"},U=C({__name:"platform-info-view",setup(_){const t=M();return t.fetchVersion(),d.Context.roleIs(["teacher","admin"])&&t.fetchChangelog(),(a,c)=>{const e=E;return u(t).moduleLoading?(n(),r("div",R,[p(e,{contrast:""})])):(n(),r("div",P,[p(w,null,{title:g(()=>[h(" Текущая версия ")]),content:g(()=>[s("p",null,i(u(t).version),1)]),_:1}),u(d).Context.roleIs(["teacher","admin"])?(n(),x(w,{key:0},{title:g(()=>[h(" Changelog ")]),content:g(()=>[p(L,{changelog:u(t).changelog},null,8,["changelog"])]),_:1})):k("",!0)]))}}});const O=S(U,[["__scopeId","data-v-bd537b06"]]);export{O as default};
