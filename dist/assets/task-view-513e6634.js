var O=Object.defineProperty;var D=(n,e,o)=>e in n?O(n,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[e]=o;var x=(n,e,o)=>(D(n,typeof e!="symbol"?e+"":e,o),o);import{L as T,a as f,c as w,n as L,q as H,o as r,b as k,h as p,M as $,p as b,l as I,e as u,m as g,f as h,N as U,t as q,i as M,g as s,v as m,w as W,s as A,x as N}from"./index-227761f5.js";import{u as Q}from"./assigned-work-e01e90d8.js";import{_ as E}from"./rich-text-area-5e87d7e7.js";import{i as S}from"./deltaHelpers-643e5dae.js";import{_ as R}from"./select-input-fb9e898e.js";function V(n){switch(n){case"answer":return j();case"comment":return F();default:return{}}}function j(){const n=T();return{id:n,slug:n,content:{ops:[{insert:`
`}]},taskId:"",createdAt:new Date,updatedAt:new Date}}function F(){const n=T();return{id:n,slug:n,content:{ops:[{insert:`
`}]},score:0,taskId:"",createdAt:new Date,updatedAt:new Date}}const z=n=>(b("data-v-b38864a2"),n=n(),I(),n),G={class:"task-answer-container"},J=z(()=>u("h4",{class:"task-answer-container__title"},"Ответ:",-1)),K=f({__name:"task-answer-text-container",props:{modelValue:{},task:{},readonly:{type:Boolean},commentable:{type:Boolean}},emits:["update:modelValue"],setup(n,{emit:e}){const o=n,i=w({get(){const a=o.modelValue.answers.find(c=>c.taskId===o.task.id);if(a)return a.content;const t=V("answer");t.taskId=o.task.id;const l={...o.modelValue};return l.answers.push(t),l.answerIds.push(t.id),e("update:modelValue",o.modelValue),t.content},set(a){const t={...o.modelValue};t.answers.find(l=>l.taskId===o.task.id).content=a,e("update:modelValue",t)}});function d(a){i.value=a}return(a,t)=>{const l=$,c=E,_=L("auto-animate");return H((r(),k("div",G,[J,a.readonly?(r(),p(l,{key:0,content:i.value,commentable:a.commentable,onCommented:t[0]||(t[0]=y=>d(y))},null,8,["content","commentable"])):(r(),p(c,{key:1,modelValue:i.value,"onUpdate:modelValue":t[1]||(t[1]=y=>i.value=y)},null,8,["modelValue"]))])),[[_]])}}});const P=g(K,[["__scopeId","data-v-b38864a2"]]),X=n=>(b("data-v-a9624e8f"),n=n(),I(),n),Y={class:"task-answer-container"},Z=X(()=>u("h4",{class:"task-answer-container__title"},"Ответ:",-1)),ee=f({__name:"task-answer-word-container",props:{modelValue:{},task:{},readonly:{type:Boolean}},emits:["update:modelValue"],setup(n,{emit:e}){const o=n,i=w({get(){const d=(o.modelValue.answers||[]).find(l=>l.taskId===o.task.id);if(d)return d.word||"";const a=V("answer");a.taskId=o.task.id;const t={...o.modelValue};return t.answers.push(a),t.answerIds.push(a.id),e("update:modelValue",o.modelValue),a.word||""},set(d){const a={...o.modelValue};a.answers.find(t=>t.taskId===o.task.id).word=d,e("update:modelValue",a)}});return(d,a)=>{const t=U;return r(),k("div",Y,[Z,h(t,{label:"Пробелы и регистр не учитываются в процессе проверки",readonly:d.readonly,modelValue:i.value,"onUpdate:modelValue":a[0]||(a[0]=l=>i.value=l),type:"text"},null,8,["readonly","modelValue"])])}}});const te=g(ee,[["__scopeId","data-v-a9624e8f"]]),oe=n=>(b("data-v-914ef0fe"),n=n(),I(),n),se={class:"task-answer-container"},ne=oe(()=>u("h4",{class:"task-answer-container__title"},"Ответ:",-1)),ae={class:"task-answer-container__hint"},le={class:"task-answer-container__list"},ie=f({__name:"task-answer-options-container",props:{modelValue:{},task:{},readonly:{type:Boolean},multiple:{type:Boolean}},emits:["update:modelValue"],setup(n,{emit:e}){const o=n,i=w({get:()=>{let d=o.modelValue.answers.find(a=>a.taskId===o.task.id);return d||(d=V("answer"),d.taskId=o.task.id),d.chosenTaskOptionIds||[]},set:d=>{const a={...o.modelValue};let t=a.answers.find(l=>l.taskId===o.task.id);t||(t=V("answer"),t.taskId=o.task.id,a.answers.push(t),a.answerIds.push(t.id)),t.chosenTaskOptions=o.task.options.filter(l=>d.includes(l.id)),t.chosenTaskOptionIds=t.chosenTaskOptions.map(l=>l.id),e("update:modelValue",a)}});return(d,a)=>{const t=M;return r(),k("div",se,[ne,u("p",ae,q(d.multiple?"Несколько вариантов ответа могут быть правильными":"Только один вариант ответа правильный"),1),u("div",le,[h(t,{multiple:d.multiple,items:d.task.options||[],readonly:d.readonly,"item-label-key":"name","item-key":"id",modelValue:i.value,"onUpdate:modelValue":a[0]||(a[0]=l=>i.value=l)},null,8,["multiple","items","readonly","modelValue"])])])}}});const de=g(ie,[["__scopeId","data-v-914ef0fe"]]);class re{constructor(e,o){x(this,"quill");x(this,"options");this.quill=e,this.options=o}}class ce extends re{constructor(o,i){super(o,i);x(this,"toolEnabled",!1);document.addEventListener("selectionchange",this.handleSelectionChange.bind(this))}get enabled(){return this.toolEnabled}set enabled(o){this.toolEnabled=o}handleSelectionChange(){if(!this.toolEnabled)return;const o=window.getSelection();if(!o)return;let i=null;try{i=o.getRangeAt(0)}catch{return}if(!i)return;const d=i.cloneContents(),a=document.createElement("quote");a.appendChild(d);const t=a.innerHTML,l=this.quill.clipboard.convert({html:t}),c=this.quill.updateContents(l);console.log("RESULT",c)}}const ue=n=>(b("data-v-28d626fe"),n=n(),I(),n),_e={key:0,class:"task-comment-container"},me=ue(()=>u("h4",{class:"task-comment-container__title"},"Комментарий:",-1)),ke=f({__name:"task-comment-container",props:{modelValue:{},task:{},readonly:{type:Boolean},mode:{}},emits:["update:modelValue"],setup(n,{emit:e}){const o=n,i=w({get(){const t=o.modelValue.comments.find(_=>_.taskId===o.task.id);if(t)return t.content;const l=V("comment");l.taskId=o.task.id;const c={...o.modelValue};return c.comments.push(l),c.commentIds.push(l.id),e("update:modelValue",o.modelValue),l.content},set(t){const l={...o.modelValue};l.comments.find(c=>c.taskId===o.task.id).content=t,e("update:modelValue",l)}}),d={quoteSelection:ce},a={quoteSelection:{}};return(t,l)=>{const c=$,_=E;return t.mode==="check"||!s(S)(i.value)?(r(),k("div",_e,[me,t.readonly?(r(),p(c,{key:0,content:i.value},null,8,["content"])):(r(),p(_,{key:1,modelValue:i.value,"onUpdate:modelValue":l[0]||(l[0]=y=>i.value=y),"additional-modules":d,"additional-module-options":a},null,8,["modelValue"]))])):m("",!0)}}});const pe=g(ke,[["__scopeId","data-v-28d626fe"]]),ye={class:"task-score-container"},ve=f({__name:"task-score-container",props:{modelValue:{},task:{},readonly:{type:Boolean}},emits:["update:modelValue"],setup(n,{emit:e}){const o=n,i=w(()=>{const a=[];for(let t=0;t<=o.task.highestScore;t++)a.push({label:t.toString(),value:t.toString()});return a}),d=w({get(){var c,_;const a=o.modelValue.comments.find(y=>y.taskId===o.task.id);if(a)return((c=a.score)==null?void 0:c.toString())||"0";const t=V("comment");t.taskId=o.task.id;const l={...o.modelValue};return l.comments.push(t),l.commentIds.push(t.id),e("update:modelValue",l),((_=t.score)==null?void 0:_.toString())||"0"},set(a){const t={...o.modelValue};t.comments.find(l=>l.taskId===o.task.id).score=Number(a),e("update:modelValue",t)}});return(a,t)=>{const l=R;return r(),k("div",ye,[h(l,{label:"Балл:",options:i.value,modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=c=>d.value=c),readonly:o.readonly},null,8,["options","modelValue","readonly"])])}}});const he=g(ve,[["__scopeId","data-v-d93ad9f4"]]),C=n=>(b("data-v-27c35868"),n=n(),I(),n),we={key:0,class:"task-view"},Ve={class:"task-view__question"},fe={class:"task-view__question__max-score"},ge={key:0,class:"task-view__answer"},be=C(()=>u("br",null,null,-1)),Ie={class:"taks-view__right-answer"},xe={class:"row"},Ce={class:"col-md-6"},Se={class:"col-md-6"},$e={key:1,class:"task-view__hint"},Be=C(()=>u("h4",{class:"task-view__hint__title"},"Подсказка:",-1)),We={key:2,class:"task-view__hint"},Ae=C(()=>u("h4",{class:"task-view__hint__title"},"Пояснение:",-1)),Te={key:3,class:"task-view__comment"},Ue={key:4,class:"task-view__action-buttons"},qe={key:1,class:"task-view__not-chosen"},Ee=C(()=>u("p",{class:"task-view__task-not-found"},"Выберите задание",-1)),Oe=[Ee],De=f({__name:"task-view",setup(n){const e=Q();return(o,i)=>{var l,c,_,y,B;const d=$,a=U,t=N;return s(e).assignedWork&&s(e).task?(r(),k("div",we,[u("div",Ve,[h(d,{content:s(e).task.content},null,8,["content"]),u("p",fe," Максимальный балл: "+q(s(e).task.highestScore),1)]),["visible","readonly"].includes(s(e).fieldVisibility.solveBox)?(r(),k("div",ge,[s(e).task.type==="text"?(r(),p(P,{key:0,modelValue:s(e).assignedWork,"onUpdate:modelValue":i[0]||(i[0]=v=>s(e).assignedWork=v),task:s(e).task,readonly:s(e).fieldVisibility.solveBox==="readonly",commentable:s(e).fieldVisibility.checkBox==="visible"},null,8,["modelValue","task","readonly","commentable"])):m("",!0),s(e).task.type==="word"?(r(),p(te,{key:1,modelValue:s(e).assignedWork,"onUpdate:modelValue":i[1]||(i[1]=v=>s(e).assignedWork=v),task:s(e).task,readonly:s(e).fieldVisibility.solveBox==="readonly"},null,8,["modelValue","task","readonly"])):s(e).task.type==="multiple_choice"||s(e).task.type==="one_choice"?(r(),p(de,{key:2,modelValue:s(e).assignedWork,"onUpdate:modelValue":i[2]||(i[2]=v=>s(e).assignedWork=v),task:s(e).task,readonly:s(e).fieldVisibility.solveBox==="readonly",multiple:s(e).task.type==="multiple_choice"},null,8,["modelValue","task","readonly","multiple"])):m("",!0)])):m("",!0),be,u("div",Ie,[u("div",xe,[u("div",Ce,[["visible","readonly"].includes(s(e).fieldVisibility.scoreBox)&&((l=s(e).task)==null?void 0:l.type)==="word"?(r(),p(a,{key:0,readonly:"",label:((c=s(e).task)==null?void 0:c.rightAnswer.split("|").length)>1?"Правильные ответы":"Правильный ответ","model-value":((_=s(e).task)==null?void 0:_.rightAnswer.split("|").join(", "))||"",type:"text"},null,8,["label","model-value"])):m("",!0)]),u("div",Se,[["visible","readonly"].includes(s(e).fieldVisibility.scoreBox)?(r(),p(he,{key:0,modelValue:s(e).assignedWork,"onUpdate:modelValue":i[3]||(i[3]=v=>s(e).assignedWork=v),task:s(e).task,readonly:s(e).fieldVisibility.scoreBox==="readonly"},null,8,["modelValue","task","readonly"])):m("",!0)])])]),s(e).task.solveHint&&!s(S)(s(e).task.solveHint)?(r(),k("div",$e,[Be,h(d,{content:s(e).task.solveHint},null,8,["content"])])):m("",!0),s(e).task.checkHint&&["check","read"].includes(s(e).mode)&&!s(S)(s(e).task.solveHint)?(r(),k("div",We,[Ae,h(d,{content:s(e).task.checkHint},null,8,["content"])])):m("",!0),["visible","readonly"].includes(s(e).fieldVisibility.checkBox)?(r(),k("div",Te,[h(pe,{modelValue:s(e).assignedWork,"onUpdate:modelValue":i[4]||(i[4]=v=>s(e).assignedWork=v),task:s(e).task,readonly:s(e).fieldVisibility.checkBox==="readonly",mode:s(e).mode},null,8,["modelValue","task","readonly","mode"])])):m("",!0),(((B=(y=s(e).assignedWork)==null?void 0:y.work)==null?void 0:B.tasks.length)||0)>1?(r(),k("div",Ue,[s(e).previousTaskLink?(r(),p(t,{key:0,alignment:"left",design:"secondary",to:s(e).previousTaskLink},{default:W(()=>[A(" Предыдущий вопрос ")]),_:1},8,["to"])):m("",!0),s(e).nextTaskLink?(r(),p(t,{key:1,alignment:"right",to:s(e).nextTaskLink},{default:W(()=>[A(" Следующий вопрос ")]),_:1},8,["to"])):m("",!0)])):m("",!0)])):(r(),k("div",qe,Oe))}}});const je=g(De,[["__scopeId","data-v-27c35868"]]);export{je as default};
