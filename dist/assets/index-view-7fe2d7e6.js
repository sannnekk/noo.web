import{d as b,C as v,u as W,a as y,o as f,b as x,f as d,y as S,Q as $,e as r,g as i,w as g,s as u,t as L,F as I,_ as V,x as C,j as M,J as B,k as E,p as U,l as D,m as F}from"./index-51ddc428.js";import{_ as N}from"./entity-table-afefe9e7.js";import"./useDate-126c6fe0.js";const T=b("works-module",()=>{const s=v.Services.UI,e=v.Services.Work,{pagination:o,results:p,resultsMeta:n,isListLoading:t}=W(c);async function c(l){try{return await e.getWorks(l)}catch(_){s.openErrorModal("Произошла ошибка при получении списка работ",_.message)}}async function k(l){s.setLoading(!0);try{await e.copyWork(l),o.value.page=1,o.value.search="$$$",o.value.search=""}catch(_){s.openErrorModal("Произошла ошибка при копировании работы",_.message)}finally{s.setLoading(!1)}}async function m(l){s.setLoading(!0);try{await e.deleteWork(l),o.value.search="$$$",o.value.search=""}catch(_){s.openErrorModal("Произошла ошибка при удалении работы",_.message)}finally{s.setLoading(!1)}}return{pagination:o,results:p,resultsMeta:n,isListLoading:t,fetchWorks:c,copyWork:k,deleteWork:m}}),j={class:"works-table"},J=y({__name:"works-table",props:{works:{},loading:{type:Boolean}},emits:["copy-work","delete-work"],setup(s,{emit:e}){const o=[{title:"#",type:"iterator"},{title:"Название работы",keys:["name"],type:"text",style:"bold"},{title:"Тип",keys:["type"],type:"tag",tagFunction:p},{title:"",value:"Копировать",type:"link",design:"secondary",action:n=>e("copy-work",n.slug)},{title:"",value:"Посмотреть / Редактировать",type:"link",linkTo:n=>`/create-work${n.slug}`},{title:"",value:"Удалить",type:"link",design:"danger",action:n=>e("delete-work",n.id)}];function p(n,t){switch(t){case"trial-work":return{text:"Пробник",type:"danger"};case"phrase":return{text:"Фраза",type:"success"};case"mini-test":return{text:"Мини-тест",type:"primary"};case"test":return{text:"Тест",type:"warning"};case"second-part":return{text:"Вторая часть",type:"info"};default:return{text:"-",type:"info"}}}return(n,t)=>{const c=N;return f(),x("div",j,[d(c,{cols:o,data:n.works,"is-loading":n.loading},null,8,["data","is-loading"])])}}}),w=s=>(U("data-v-fca1e300"),s=s(),D(),s),P={class:"index-works-view"},Q={class:"index-works-view__header"},q={class:"index-works-view__header__search"},z={class:"index-works-view__header__link"},A={class:"index-works-view__table"},G={class:"index-works-view__pagination"},H=w(()=>r("br",null,null,-1)),K=w(()=>r("br",null,null,-1)),O=w(()=>r("br",null,null,-1)),R=y({__name:"index-view",setup(s){S("Работы");const e=T(),o=$({visible:!1,workId:""});function p(n){o.workId=n,o.visible=!0}return(n,t)=>{const c=V,k=C,m=M,l=B,_=E;return f(),x(I,null,[r("div",P,[r("div",Q,[r("div",q,[d(c,{modelValue:i(e).pagination.search,"onUpdate:modelValue":t[0]||(t[0]=a=>i(e).pagination.search=a),"is-loading":i(e).isListLoading},null,8,["modelValue","is-loading"])]),r("div",z,[d(k,{to:"/create-work"},{default:g(()=>[u("Создать работу")]),_:1})])]),r("div",A,[d(J,{works:i(e).results,loading:i(e).isListLoading,onCopyWork:t[1]||(t[1]=a=>i(e).copyWork(a)),onDeleteWork:t[2]||(t[2]=a=>p(a))},null,8,["works","loading"])]),r("div",G,[d(m,{page:i(e).pagination.page,"onUpdate:page":t[3]||(t[3]=a=>i(e).pagination.page=a),total:i(e).resultsMeta.total,limit:i(e).pagination.limit},null,8,["page","total","limit"])])]),d(_,{visible:o.visible,"onUpdate:visible":t[4]||(t[4]=a=>o.visible=a),onConfirm:t[5]||(t[5]=a=>i(e).deleteWork(o.workId))},{title:g(()=>[u(" Удаление работы ")]),text:g(()=>{var a;return[u(" Вы уверены, что хотите удалить работу "),H,r("b",null,L((a=i(e).results.find(h=>h.id===o.workId))==null?void 0:a.name),1),u(" ? "),K,O,d(l,null,{default:g(()=>[u(" Все, кто решал/проверял эту работу, больше не смогут её открыть. Сохранится только дедлайн и общий балл. ")]),_:1})]}),_:1},8,["visible"])],64)}}});const ee=F(R,[["__scopeId","data-v-fca1e300"]]);export{ee as default};
