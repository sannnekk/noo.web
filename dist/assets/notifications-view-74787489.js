import{d as b,C as V,c as w,a as v,b as x,a1 as C,r as g,w as S,q as O,j as f,g as a,k as d,s as D,f as k,e as h,y as U,O as F,a0 as R,ak as T,E as j,p as q,l as G,_ as L,G as z}from"./index-f4dd30be.js";import{S as A}from"./settings-section-0259dab1.js";const H=b({__name:"course-select",props:{label:{},modelValue:{}},emits:["update:modelValue"],setup(s,{emit:_}){const n=s,e=_,o=V.Services.Course,c=V.Services.UI;async function m(i){try{return o.getCourses(i)}catch(p){c.openErrorModal("Произошла ошибка при загрузке курсов",p.message)}}const u=w({get:()=>n.modelValue?[n.modelValue]:[],set:i=>{i.length===0&&e("update:modelValue",null),e("update:modelValue",i[0])}});return(i,p)=>{const r=C;return v(),x(r,{label:i.label,"fetch-function":m,"label-keys":["name"],"max-count":1,modelValue:u.value,"onUpdate:modelValue":p[0]||(p[0]=t=>u.value=t)},null,8,["label","modelValue"])}}}),J=b({__name:"role-select",props:{label:{},modelValue:{}},emits:["update:modelValue"],setup(s,{emit:_}){const n=s,e=_,o=V.Services.User;async function c(u){return{data:o.getRoles(u)}}const m=w({get:()=>n.modelValue?[n.modelValue]:[],set:u=>{u.length===0&&e("update:modelValue",null),e("update:modelValue",u[0])}});return(u,i)=>{const p=C;return v(),x(p,{label:u.label,"fetch-function":c,"label-keys":["label"],"max-count":1,modelValue:m.value,"onUpdate:modelValue":i[0]||(i[0]=r=>m.value=r)},null,8,["label","modelValue"])}}}),K=s=>(q("data-v-7b272700"),s=s(),G(),s),P={class:"create-notification-form"},Q={class:"row"},W={class:"col-lg-6"},X={class:"form-group"},Y={class:"col-lg-6"},Z={class:"row"},ee={class:"col-lg-6"},oe={class:"form-group"},te={class:"col-lg-6"},le={class:"form-group"},ae=K(()=>a("h4",null,"Кому отправить",-1)),se={class:"row"},ne={class:"col-lg-6"},ue={class:"form-group"},ie={class:"col-lg-6"},ce={key:0,class:"form-group"},re={key:1,class:"form-group"},de={class:"form-actions"},_e=b({__name:"create-notification-form",emits:["create"],setup(s,{emit:_}){const n=_,e=g({title:"",message:"",type:"other",link:""}),o=g({selector:"all",value:null}),c=g(null);S(c,()=>{var r;return o.value.value=((r=c.value)==null?void 0:r.value)||null});const m=g(null);S(m,()=>{var r;return o.value.value=((r=m.value)==null?void 0:r.id)||null}),S(()=>o.value.selector,()=>o.value.value=null);function u(){n("create",e.value,o.value)}const i=[{value:"other",label:"Другое"},{value:"announcement",label:"Объявление"},{value:"maintenance",label:"Технические работы"},{value:"new-feature",label:"Новая функция"}],p=[{value:"all",label:"Всем"},{value:"role",label:"По роли"},{value:"course",label:"По курсу"}];return(r,t)=>{const y=F,N=R,M=T,I=J,$=H,B=j,E=O("auto-animate");return v(),f("div",P,[a("div",Q,[a("div",W,[a("div",X,[d(y,{type:"text",modelValue:e.value.title,"onUpdate:modelValue":t[0]||(t[0]=l=>e.value.title=l),label:"Заголовок",validators:[l=>!!l||"Заголовок обязателен"]},null,8,["modelValue","validators"])])]),a("div",Y,[d(N,{label:"Тип",modelValue:e.value.type,"onUpdate:modelValue":t[1]||(t[1]=l=>e.value.type=l),options:i},null,8,["modelValue"])])]),a("div",Z,[a("div",ee,[a("div",oe,[d(M,{modelValue:e.value.message,"onUpdate:modelValue":t[2]||(t[2]=l=>e.value.message=l),label:"Сообщение (необязательно)"},null,8,["modelValue"])])]),a("div",te,[a("div",le,[d(y,{label:"Ссылка (необязательно)",type:"url",modelValue:e.value.link,"onUpdate:modelValue":t[3]||(t[3]=l=>e.value.link=l)},null,8,["modelValue"])])])]),ae,a("div",se,[a("div",ne,[a("div",ue,[d(N,{label:"Селектор",modelValue:o.value.selector,"onUpdate:modelValue":t[4]||(t[4]=l=>o.value.selector=l),options:p},null,8,["modelValue"])])]),D((v(),f("div",ie,[o.value.selector==="role"?(v(),f("div",ce,[d(I,{label:"Выберите роль",modelValue:c.value,"onUpdate:modelValue":t[5]||(t[5]=l=>c.value=l)},null,8,["modelValue"])])):k("",!0),o.value.selector==="course"?(v(),f("div",re,[d($,{label:"Выберите курс",modelValue:m.value,"onUpdate:modelValue":t[6]||(t[6]=l=>m.value=l),expectId:""},null,8,["modelValue"])])):k("",!0)])),[[E]])]),a("div",de,[d(B,{alignment:"right",onClick:t[7]||(t[7]=l=>u())},{default:h(()=>[U(" Создать и отправить ")]),_:1})])])}}});const me=L(_e,[["__scopeId","data-v-7b272700"]]),pe=z("settings-module:notifications",()=>{const s=V.Services.Notification,_=V.Services.UI;async function n(e,o){try{await s.createNotification(e,o,{showLoader:!0})}catch(c){_.openErrorModal("Не удалось создать уведомление",c.message)}}return{createNotification:n}}),ve={class:"notifications-view"},ge=b({__name:"notifications-view",setup(s){const _=pe();function n(e,o){_.createNotification(e,o)}return(e,o)=>(v(),f("div",ve,[d(A,null,{title:h(()=>[U("Отправить уведомление")]),content:h(()=>[d(me,{onCreate:n})]),_:1})]))}});export{ge as default};
