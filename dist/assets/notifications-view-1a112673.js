import{d as w,r as p,w as g,q as j,s as y,a as r,i as _,g as s,j as a,f as V,e as f,y as h,v as F,a2 as O,aC as q,P as G,ao as L,a9 as P,ac as T,ab as z,D as A,E as H,p as J,l as K,_ as Q,G as R,C as N}from"./index-c897db7e.js";import{S as W}from"./settings-section-63aec0e2.js";const X=n=>(J("data-v-e83b61e3"),n=n(),K(),n),Y={class:"create-notification-form"},Z={class:"row"},ee={class:"col-lg-6"},oe={class:"form-group"},te={class:"col-lg-6"},le={class:"row"},se={class:"col-lg-6"},ae={class:"form-group"},ne={class:"col-lg-6"},ie={class:"form-group"},ce={class:"row"},ue={class:"col-12"},re=X(()=>s("h4",null,"Кому отправить",-1)),_e={class:"row"},de={class:"col-lg-6"},ve={class:"form-group"},me={class:"col-lg-6"},pe={key:0,class:"form-group"},fe={key:1,class:"form-group"},ge={key:0,class:"form-errors"},Ve={class:"form-actions"},he=w({__name:"create-notification-form",emits:["create"],setup(n,{emit:d}){const v=d,t=p({title:"",message:"",type:"other",link:"",isBanner:!1}),l=p({selector:"all",value:null}),i=p(null);g(i,()=>{var u;return l.value.value=((u=i.value)==null?void 0:u.value)||null});const m=p(null),c=p([]);g(m,()=>{var u;return l.value.value=((u=m.value)==null?void 0:u.id)||null}),g(()=>l.value.selector,()=>l.value.value=null);function k(){if(c.value=[],!t.value.title){c.value.push("Заголовок обязателен");return}if(l.value.selector==="role"&&!i.value){c.value.push("Выберите роль");return}if(l.value.selector==="course"&&!m.value){c.value.push("Выберите курс");return}v("create",t.value,l.value)}const x=[{value:"all",label:"Всем"},{value:"role",label:"По роли"},{value:"course",label:"По курсу"}];return(u,e)=>{const b=O,C=q,U=G,B=L,I=P,$=T,M=z,D=A,E=H,S=j("auto-animate");return y((r(),_("div",Y,[s("div",Z,[s("div",ee,[s("div",oe,[a(b,{type:"text",modelValue:t.value.title,"onUpdate:modelValue":e[0]||(e[0]=o=>t.value.title=o),label:"Заголовок",validators:[o=>!!o||"Заголовок обязателен"]},null,8,["modelValue","validators"])])]),s("div",te,[a(C,{label:"Тип",modelValue:t.value.type,"onUpdate:modelValue":e[1]||(e[1]=o=>t.value.type=o)},null,8,["modelValue"])])]),s("div",le,[s("div",se,[s("div",ae,[a(U,{modelValue:t.value.message,"onUpdate:modelValue":e[2]||(e[2]=o=>t.value.message=o),label:"Сообщение (необязательно)"},null,8,["modelValue"])])]),s("div",ne,[s("div",ie,[a(b,{label:"Ссылка (необязательно)",type:"url",modelValue:t.value.link,"onUpdate:modelValue":e[3]||(e[3]=o=>t.value.link=o)},null,8,["modelValue"])])])]),s("div",ce,[s("div",ue,[a(B,{label:"Создать как баннер",modelValue:t.value.isBanner,"onUpdate:modelValue":e[4]||(e[4]=o=>t.value.isBanner=o)},null,8,["modelValue"])])]),re,s("div",_e,[s("div",de,[s("div",ve,[a(I,{label:"Селектор",modelValue:l.value.selector,"onUpdate:modelValue":e[5]||(e[5]=o=>l.value.selector=o),options:x},null,8,["modelValue"])])]),y((r(),_("div",me,[l.value.selector==="role"?(r(),_("div",pe,[a($,{label:"Выберите роль",modelValue:i.value,"onUpdate:modelValue":e[6]||(e[6]=o=>i.value=o)},null,8,["modelValue"])])):V("",!0),l.value.selector==="course"?(r(),_("div",fe,[a(M,{label:"Выберите курс",modelValue:m.value,"onUpdate:modelValue":e[7]||(e[7]=o=>m.value=o),expectId:""},null,8,["modelValue"])])):V("",!0)])),[[S]])]),c.value.length?(r(),_("div",ge,[a(D,null,{default:f(()=>[h(F(c.value.join(", ")),1)]),_:1})])):V("",!0),s("div",Ve,[a(E,{alignment:"right",onClick:e[8]||(e[8]=o=>k())},{default:f(()=>[h(" Создать и отправить ")]),_:1})])])),[[S]])}}});const be=Q(he,[["__scopeId","data-v-e83b61e3"]]),Se=R("settings-module:notifications",()=>{const n=N.Services.Notification,d=N.Services.UI;async function v(t,l){try{await n.createNotification(t,l,{showLoader:!0})}catch(i){d.openErrorModal("Не удалось создать уведомление",i.message)}}return{createNotification:v}}),ye={class:"notifications-view"},ke=w({__name:"notifications-view",setup(n){const d=Se();function v(t,l){d.createNotification(t,l)}return(t,l)=>(r(),_("div",ye,[a(W,null,{title:f(()=>[h("Отправить уведомление")]),content:f(()=>[a(be,{onCreate:v})]),_:1})]))}});export{ke as default};
