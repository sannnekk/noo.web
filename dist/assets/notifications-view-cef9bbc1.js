import{d as S,C as b,c as j,a as v,b as x,a2 as F,r as f,w as g,a1 as U,q,s as C,j as V,g as a,k as c,f as y,e as h,y as N,v as G,O as L,al as T,am as z,D as A,E as H,p as J,l as K,_ as P,G as Q}from"./index-9decd0b1.js";import{S as R}from"./settings-section-74a32761.js";const W=S({__name:"course-select",props:{label:{},modelValue:{}},emits:["update:modelValue"],setup(u,{emit:m}){const r=u,o=m,e=b.Services.Course,s=b.Services.UI;async function d(i){try{return e.getCourses(i)}catch(p){s.openErrorModal("Произошла ошибка при загрузке курсов",p.message)}}const n=j({get:()=>r.modelValue?[r.modelValue]:[],set:i=>{i.length===0&&o("update:modelValue",null),o("update:modelValue",i[0])}});return(i,p)=>{const _=F;return v(),x(_,{label:i.label,"fetch-function":d,"label-keys":["subject.name","name"],"max-count":1,modelValue:n.value,"onUpdate:modelValue":p[0]||(p[0]=t=>n.value=t)},null,8,["label","modelValue"])}}}),X=S({__name:"user-role-select",props:{label:{},modelValue:{}},emits:["update:modelValue"],setup(u,{emit:m}){var d;const r=u,o=m,e=[{label:"Администратор",value:"admin"},{label:"Преподаватель",value:"teacher"},{label:"Куратор",value:"mentor"},{label:"Ученик",value:"student"}],s=f(((d=r.modelValue)==null?void 0:d.value)||e[0].value);return g(()=>s.value,()=>o("update:modelValue",e.find(n=>n.value===s.value)||e[0]),{immediate:!0}),(n,i)=>{const p=U;return v(),x(p,{label:n.label,options:e,modelValue:s.value,"onUpdate:modelValue":i[0]||(i[0]=_=>s.value=_)},null,8,["label","modelValue"])}}}),Y=u=>(J("data-v-094e6bcf"),u=u(),K(),u),Z={class:"create-notification-form"},ee={class:"row"},oe={class:"col-lg-6"},te={class:"form-group"},le={class:"col-lg-6"},se={class:"row"},ae={class:"col-lg-6"},ne={class:"form-group"},ue={class:"col-lg-6"},ie={class:"form-group"},ce=Y(()=>a("h4",null,"Кому отправить",-1)),re={class:"row"},de={class:"col-lg-6"},_e={class:"form-group"},me={class:"col-lg-6"},pe={key:0,class:"form-group"},ve={key:1,class:"form-group"},fe={key:0,class:"form-errors"},Ve={class:"form-actions"},ge=S({__name:"create-notification-form",emits:["create"],setup(u,{emit:m}){const r=m,o=f({title:"",message:"",type:"other",link:""}),e=f({selector:"all",value:null}),s=f(null);g(s,()=>{var _;return e.value.value=((_=s.value)==null?void 0:_.value)||null});const d=f(null),n=f([]);g(d,()=>{var _;return e.value.value=((_=d.value)==null?void 0:_.id)||null}),g(()=>e.value.selector,()=>e.value.value=null);function i(){if(n.value=[],!o.value.title){n.value.push("Заголовок обязателен");return}if(e.value.selector==="role"&&!s.value){n.value.push("Выберите роль");return}if(e.value.selector==="course"&&!d.value){n.value.push("Выберите курс");return}r("create",o.value,e.value)}const p=[{value:"all",label:"Всем"},{value:"role",label:"По роли"},{value:"course",label:"По курсу"}];return(_,t)=>{const k=L,M=T,I=z,$=U,B=X,D=W,E=A,O=H,w=q("auto-animate");return C((v(),V("div",Z,[a("div",ee,[a("div",oe,[a("div",te,[c(k,{type:"text",modelValue:o.value.title,"onUpdate:modelValue":t[0]||(t[0]=l=>o.value.title=l),label:"Заголовок",validators:[l=>!!l||"Заголовок обязателен"]},null,8,["modelValue","validators"])])]),a("div",le,[c(M,{label:"Тип",modelValue:o.value.type,"onUpdate:modelValue":t[1]||(t[1]=l=>o.value.type=l)},null,8,["modelValue"])])]),a("div",se,[a("div",ae,[a("div",ne,[c(I,{modelValue:o.value.message,"onUpdate:modelValue":t[2]||(t[2]=l=>o.value.message=l),label:"Сообщение (необязательно)"},null,8,["modelValue"])])]),a("div",ue,[a("div",ie,[c(k,{label:"Ссылка (необязательно)",type:"url",modelValue:o.value.link,"onUpdate:modelValue":t[3]||(t[3]=l=>o.value.link=l)},null,8,["modelValue"])])])]),ce,a("div",re,[a("div",de,[a("div",_e,[c($,{label:"Селектор",modelValue:e.value.selector,"onUpdate:modelValue":t[4]||(t[4]=l=>e.value.selector=l),options:p},null,8,["modelValue"])])]),C((v(),V("div",me,[e.value.selector==="role"?(v(),V("div",pe,[c(B,{label:"Выберите роль",modelValue:s.value,"onUpdate:modelValue":t[5]||(t[5]=l=>s.value=l)},null,8,["modelValue"])])):y("",!0),e.value.selector==="course"?(v(),V("div",ve,[c(D,{label:"Выберите курс",modelValue:d.value,"onUpdate:modelValue":t[6]||(t[6]=l=>d.value=l),expectId:""},null,8,["modelValue"])])):y("",!0)])),[[w]])]),n.value.length?(v(),V("div",fe,[c(E,null,{default:h(()=>[N(G(n.value.join(", ")),1)]),_:1})])):y("",!0),a("div",Ve,[c(O,{alignment:"right",onClick:t[7]||(t[7]=l=>i())},{default:h(()=>[N(" Создать и отправить ")]),_:1})])])),[[w]])}}});const be=P(ge,[["__scopeId","data-v-094e6bcf"]]),he=Q("settings-module:notifications",()=>{const u=b.Services.Notification,m=b.Services.UI;async function r(o,e){try{await u.createNotification(o,e,{showLoader:!0})}catch(s){m.openErrorModal("Не удалось создать уведомление",s.message)}}return{createNotification:r}}),Se={class:"notifications-view"},ke=S({__name:"notifications-view",setup(u){const m=he();function r(o,e){m.createNotification(o,e)}return(o,e)=>(v(),V("div",Se,[c(R,null,{title:h(()=>[N("Отправить уведомление")]),content:h(()=>[c(be,{onCreate:r})]),_:1})]))}});export{ke as default};
